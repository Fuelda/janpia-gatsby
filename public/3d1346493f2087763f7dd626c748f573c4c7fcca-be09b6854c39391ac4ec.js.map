{"version":3,"file":"3d1346493f2087763f7dd626c748f573c4c7fcca-be09b6854c39391ac4ec.js","mappings":"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","sources":["webpack://janpia-disclosure/./node_modules/@algolia/events/events.js","webpack://janpia-disclosure/./node_modules/algoliasearch/dist/algoliasearch-lite.umd.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/IndexContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/InstantSearchContext.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/get-insights-anonymous-user-token.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/safelyRunOnBrowser.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/noop.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/middlewares/createInsightsMiddleware.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/render-args.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/middlewares/createMetadataMiddleware.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/routers/history.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/stateMappings/simple.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/isEqual.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/middlewares/createRouterMiddleware.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/documentation.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/isIndexWidget.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/mergeSearchParameters.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/findIndex.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/uniq.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/widgets/index/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/resolveSearchParameters.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/suit.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/getPropertyByPath.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/escape-highlight.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/highlight.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/concatHighlightedParts.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/escape-html.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/getHighlightFromSiblings.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/reverseHighlightedParts.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/getHighlightedParts.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/reverseHighlight.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/snippet.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/reverseSnippet.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/helpers/insights.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/serializer.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/createHelpers.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/formatNumber.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/defer.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/setIndexHelperState.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/InstantSearch.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/version.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/getAppIdAndApiKey.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/find.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/components/InstantSearchServerContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useInstantSearchServerContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/InstantSearchSSRContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/version.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useForceUpdate.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useInstantSearchApi.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useInstantSearchSSRContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/components/InstantSearch.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/checkRendering.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/lib/utils/getObjectType.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/es/connectors/search-box/connectSearchBox.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/dequal.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/createSearchResults.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/getIndexSearchResults.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/invariant.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useIndexContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useInstantSearchContext.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useStableValue.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useIsomorphicLayoutEffect.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/hooks/useConnector.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useWidget.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/connectors/useSearchBox.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useSearchResults.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/lib/useSearchState.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/react-instantsearch-core/dist/es/hooks/useInstantSearch.js","webpack://janpia-disclosure/./src/features/search/component/main/Freeword/SearchBoxIndex.tsx","webpack://janpia-disclosure/./src/features/search/component/sidebar/Freeword/SearchBoxSidebar.tsx","webpack://janpia-disclosure/./src/features/search/component/main/Freeword/SearchBoxTopicKeyword.tsx","webpack://janpia-disclosure/./src/features/search/api/AlgoliaIndex.tsx","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/DerivedHelper/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/SearchParameters/RefinementList.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/SearchParameters/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/SearchResults/generate-hierarchical-tree.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/SearchResults/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/algoliasearch.helper.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/compact.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/defaultsPure.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/escapeFacetValue.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/find.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/findIndex.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/formatSort.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/inherits.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/intersection.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/merge.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/objectHasKeys.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/omit.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/orderBy.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/functions/valToNumber.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/requestBuilder.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/utils/isValidUserToken.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/algoliasearch-helper/src/version.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/qs/lib/formats.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/qs/lib/index.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/qs/lib/parse.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/qs/lib/stringify.js","webpack://janpia-disclosure/./node_modules/instantsearch.js/node_modules/qs/lib/utils.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/index.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/DerivedHelper/index.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/SearchParameters/RefinementList.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/SearchParameters/index.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/SearchResults/generate-hierarchical-tree.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/SearchResults/index.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/algoliasearch.helper.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/compact.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/defaultsPure.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/escapeFacetValue.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/find.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/findIndex.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/formatSort.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/inherits.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/intersection.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/merge.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/objectHasKeys.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/omit.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/orderBy.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/functions/valToNumber.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/requestBuilder.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/utils/isValidUserToken.js","webpack://janpia-disclosure/./node_modules/react-instantsearch/node_modules/algoliasearch-helper/src/version.js","webpack://janpia-disclosure/./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack://janpia-disclosure/./node_modules/use-sync-external-store/shim/index.js"],"sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\n// EventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","/*! algoliasearch-lite.umd.js | 4.20.0 |  Algolia, inc. | https://github.com/algolia/algoliasearch-client-javascript */\n!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=e||self).algoliasearch=t()}(this,(function(){\"use strict\";function e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){e(r,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}))}return r}function n(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function u(e){var t,r=\"algoliasearch-client-js-\".concat(e.key),n=function(){return void 0===t&&(t=e.localStorage||window.localStorage),t},a=function(){return JSON.parse(n().getItem(r)||\"{}\")},u=function(e){n().setItem(r,JSON.stringify(e))},i=function(){var t=e.timeToLive?1e3*e.timeToLive:null,r=a(),n=Object.fromEntries(Object.entries(r).filter((function(e){return void 0!==o(e,2)[1].timestamp})));if(u(n),t){var i=Object.fromEntries(Object.entries(n).filter((function(e){var r=o(e,2)[1],n=(new Date).getTime();return!(r.timestamp+t<n)})));u(i)}};return{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then((function(){i();var t=JSON.stringify(e);return a()[t]})).then((function(e){return Promise.all([e?e.value:t(),void 0!==e])})).then((function(e){var t=o(e,2),n=t[0],a=t[1];return Promise.all([n,a||r.miss(n)])})).then((function(e){return o(e,1)[0]}))},set:function(e,t){return Promise.resolve().then((function(){var o=a();return o[JSON.stringify(e)]={timestamp:(new Date).getTime(),value:t},n().setItem(r,JSON.stringify(o)),t}))},delete:function(e){return Promise.resolve().then((function(){var t=a();delete t[JSON.stringify(e)],n().setItem(r,JSON.stringify(t))}))},clear:function(){return Promise.resolve().then((function(){n().removeItem(r)}))}}}function i(e){var t=a(e.caches),r=t.shift();return void 0===r?{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},n=t();return n.then((function(e){return Promise.all([e,r.miss(e)])})).then((function(e){return o(e,1)[0]}))},set:function(e,t){return Promise.resolve(t)},delete:function(e){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return r.get(e,n,o).catch((function(){return i({caches:t}).get(e,n,o)}))},set:function(e,n){return r.set(e,n).catch((function(){return i({caches:t}).set(e,n)}))},delete:function(e){return r.delete(e).catch((function(){return i({caches:t}).delete(e)}))},clear:function(){return r.clear().catch((function(){return i({caches:t}).clear()}))}}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{serializable:!0},t={};return{get:function(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},a=JSON.stringify(r);if(a in t)return Promise.resolve(e.serializable?JSON.parse(t[a]):t[a]);var u=n(),i=o&&o.miss||function(){return Promise.resolve()};return u.then((function(e){return i(e)})).then((function(){return u}))},set:function(r,n){return t[JSON.stringify(r)]=e.serializable?JSON.stringify(n):n,Promise.resolve(n)},delete:function(e){return delete t[JSON.stringify(e)],Promise.resolve()},clear:function(){return t={},Promise.resolve()}}}function c(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}return e}function l(e,t){return t?(Object.keys(t).forEach((function(r){e[r]=t[r](e)})),e):e}function f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=0;return e.replace(/%s/g,(function(){return encodeURIComponent(r[o++])}))}var m={WithinQueryParameters:0,WithinHeaders:1};function h(e,t){var r=e||{},n=r.data||{};return Object.keys(r).forEach((function(e){-1===[\"timeout\",\"headers\",\"queryParameters\",\"data\",\"cacheable\"].indexOf(e)&&(n[e]=r[e])})),{data:Object.entries(n).length>0?n:void 0,timeout:r.timeout||t,headers:r.headers||{},queryParameters:r.queryParameters||{},cacheable:r.cacheable}}var d={Read:1,Write:2,Any:3},p=1,v=2,g=3;function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return r(r({},e),{},{status:t,lastUpdate:Date.now()})}function b(e){return\"string\"==typeof e?{protocol:\"https\",url:e,accept:d.Any}:{protocol:e.protocol||\"https\",url:e.url,accept:e.accept||d.Any}}var O=\"GET\",P=\"POST\";function q(e,t){return Promise.all(t.map((function(t){return e.get(t,(function(){return Promise.resolve(y(t))}))}))).then((function(e){var r=e.filter((function(e){return function(e){return e.status===p||Date.now()-e.lastUpdate>12e4}(e)})),n=e.filter((function(e){return function(e){return e.status===g&&Date.now()-e.lastUpdate<=12e4}(e)})),o=[].concat(a(r),a(n));return{getTimeout:function(e,t){return(0===n.length&&0===e?1:n.length+3+e)*t},statelessHosts:o.length>0?o.map((function(e){return b(e)})):t}}))}function j(e,t,n,o){var u=[],i=function(e,t){if(e.method===O||void 0===e.data&&void 0===t.data)return;var n=Array.isArray(e.data)?e.data:r(r({},e.data),t.data);return JSON.stringify(n)}(n,o),s=function(e,t){var n=r(r({},e.headers),t.headers),o={};return Object.keys(n).forEach((function(e){var t=n[e];o[e.toLowerCase()]=t})),o}(e,o),c=n.method,l=n.method!==O?{}:r(r({},n.data),o.data),f=r(r(r({\"x-algolia-agent\":e.userAgent.value},e.queryParameters),l),o.queryParameters),m=0,h=function t(r,a){var l=r.pop();if(void 0===l)throw{name:\"RetryError\",message:\"Unreachable hosts - your application id may be incorrect. If the error persists, contact support@algolia.com.\",transporterStackTrace:A(u)};var h={data:i,headers:s,method:c,url:S(l,n.path,f),connectTimeout:a(m,e.timeouts.connect),responseTimeout:a(m,o.timeout)},d=function(e){var t={request:h,response:e,host:l,triesLeft:r.length};return u.push(t),t},p={onSuccess:function(e){return function(e){try{return JSON.parse(e.content)}catch(t){throw function(e,t){return{name:\"DeserializationError\",message:e,response:t}}(t.message,e)}}(e)},onRetry:function(n){var o=d(n);return n.isTimedOut&&m++,Promise.all([e.logger.info(\"Retryable failure\",N(o)),e.hostsCache.set(l,y(l,n.isTimedOut?g:v))]).then((function(){return t(r,a)}))},onFail:function(e){throw d(e),function(e,t){var r=e.content,n=e.status,o=r;try{o=JSON.parse(r).message}catch(e){}return function(e,t,r){return{name:\"ApiError\",message:e,status:t,transporterStackTrace:r}}(o,n,t)}(e,A(u))}};return e.requester.send(h).then((function(e){return function(e,t){return function(e){var t=e.status;return e.isTimedOut||function(e){var t=e.isTimedOut,r=e.status;return!t&&0==~~r}(e)||2!=~~(t/100)&&4!=~~(t/100)}(e)?t.onRetry(e):2==~~(e.status/100)?t.onSuccess(e):t.onFail(e)}(e,p)}))};return q(e.hostsCache,t).then((function(e){return h(a(e.statelessHosts).reverse(),e.getTimeout)}))}function w(e){var t={value:\"Algolia for JavaScript (\".concat(e,\")\"),add:function(e){var r=\"; \".concat(e.segment).concat(void 0!==e.version?\" (\".concat(e.version,\")\"):\"\");return-1===t.value.indexOf(r)&&(t.value=\"\".concat(t.value).concat(r)),t}};return t}function S(e,t,r){var n=T(r),o=\"\".concat(e.protocol,\"://\").concat(e.url,\"/\").concat(\"/\"===t.charAt(0)?t.substr(1):t);return n.length&&(o+=\"?\".concat(n)),o}function T(e){return Object.keys(e).map((function(t){return f(\"%s=%s\",t,(r=e[t],\"[object Object]\"===Object.prototype.toString.call(r)||\"[object Array]\"===Object.prototype.toString.call(r)?JSON.stringify(e[t]):e[t]));var r})).join(\"&\")}function A(e){return e.map((function(e){return N(e)}))}function N(e){var t=e.request.headers[\"x-algolia-api-key\"]?{\"x-algolia-api-key\":\"*****\"}:{};return r(r({},e),{},{request:r(r({},e.request),{},{headers:r(r({},e.request.headers),t)})})}var x=function(e){var t=e.appId,n=function(e,t,r){var n={\"x-algolia-api-key\":r,\"x-algolia-application-id\":t};return{headers:function(){return e===m.WithinHeaders?n:{}},queryParameters:function(){return e===m.WithinQueryParameters?n:{}}}}(void 0!==e.authMode?e.authMode:m.WithinHeaders,t,e.apiKey),a=function(e){var t=e.hostsCache,r=e.logger,n=e.requester,a=e.requestsCache,u=e.responsesCache,i=e.timeouts,s=e.userAgent,c=e.hosts,l=e.queryParameters,f={hostsCache:t,logger:r,requester:n,requestsCache:a,responsesCache:u,timeouts:i,userAgent:s,headers:e.headers,queryParameters:l,hosts:c.map((function(e){return b(e)})),read:function(e,t){var r=h(t,f.timeouts.read),n=function(){return j(f,f.hosts.filter((function(e){return 0!=(e.accept&d.Read)})),e,r)};if(!0!==(void 0!==r.cacheable?r.cacheable:e.cacheable))return n();var a={request:e,mappedRequestOptions:r,transporter:{queryParameters:f.queryParameters,headers:f.headers}};return f.responsesCache.get(a,(function(){return f.requestsCache.get(a,(function(){return f.requestsCache.set(a,n()).then((function(e){return Promise.all([f.requestsCache.delete(a),e])}),(function(e){return Promise.all([f.requestsCache.delete(a),Promise.reject(e)])})).then((function(e){var t=o(e,2);t[0];return t[1]}))}))}),{miss:function(e){return f.responsesCache.set(a,e)}})},write:function(e,t){return j(f,f.hosts.filter((function(e){return 0!=(e.accept&d.Write)})),e,h(t,f.timeouts.write))}};return f}(r(r({hosts:[{url:\"\".concat(t,\"-dsn.algolia.net\"),accept:d.Read},{url:\"\".concat(t,\".algolia.net\"),accept:d.Write}].concat(c([{url:\"\".concat(t,\"-1.algolianet.com\")},{url:\"\".concat(t,\"-2.algolianet.com\")},{url:\"\".concat(t,\"-3.algolianet.com\")}]))},e),{},{headers:r(r(r({},n.headers()),{\"content-type\":\"application/x-www-form-urlencoded\"}),e.headers),queryParameters:r(r({},n.queryParameters()),e.queryParameters)}));return l({transporter:a,appId:t,addAlgoliaAgent:function(e,t){a.userAgent.add({segment:e,version:t})},clearCache:function(){return Promise.all([a.requestsCache.clear(),a.responsesCache.clear()]).then((function(){}))}},e.methods)},C=function(e){return function(t,r){return t.method===O?e.transporter.read(t,r):e.transporter.write(t,r)}},E=function(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={transporter:e.transporter,appId:e.appId,indexName:t};return l(n,r.methods)}},J=function(e){return function(t,n){var o=t.map((function(e){return r(r({},e),{},{params:T(e.params||{})})}));return e.transporter.read({method:P,path:\"1/indexes/*/queries\",data:{requests:o},cacheable:!0},n)}},k=function(e){return function(t,o){return Promise.all(t.map((function(t){var a=t.params,u=a.facetName,i=a.facetQuery,s=n(a,[\"facetName\",\"facetQuery\"]);return E(e)(t.indexName,{methods:{searchForFacetValues:R}}).searchForFacetValues(u,i,r(r({},o),s))})))}},I=function(e){return function(t,r,n){return e.transporter.read({method:P,path:f(\"1/answers/%s/prediction\",e.indexName),data:{query:t,queryLanguages:r},cacheable:!0},n)}},F=function(e){return function(t,r){return e.transporter.read({method:P,path:f(\"1/indexes/%s/query\",e.indexName),data:{query:t},cacheable:!0},r)}},R=function(e){return function(t,r,n){return e.transporter.read({method:P,path:f(\"1/indexes/%s/facets/%s/query\",e.indexName,t),data:{facetQuery:r},cacheable:!0},n)}},D=1,W=2,H=3;function Q(e,t,n){var o,a={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(e){return new Promise((function(t){var r=new XMLHttpRequest;r.open(e.method,e.url,!0),Object.keys(e.headers).forEach((function(t){return r.setRequestHeader(t,e.headers[t])}));var n,o=function(e,n){return setTimeout((function(){r.abort(),t({status:0,content:n,isTimedOut:!0})}),1e3*e)},a=o(e.connectTimeout,\"Connection timeout\");r.onreadystatechange=function(){r.readyState>r.OPENED&&void 0===n&&(clearTimeout(a),n=o(e.responseTimeout,\"Socket timeout\"))},r.onerror=function(){0===r.status&&(clearTimeout(a),clearTimeout(n),t({content:r.responseText||\"Network request failed\",status:r.status,isTimedOut:!1}))},r.onload=function(){clearTimeout(a),clearTimeout(n),t({content:r.responseText,status:r.status,isTimedOut:!1})},r.send(e.data)}))}},logger:(o=H,{debug:function(e,t){return D>=o&&console.debug(e,t),Promise.resolve()},info:function(e,t){return W>=o&&console.info(e,t),Promise.resolve()},error:function(e,t){return console.error(e,t),Promise.resolve()}}),responsesCache:s(),requestsCache:s({serializable:!1}),hostsCache:i({caches:[u({key:\"\".concat(\"4.20.0\",\"-\").concat(e)}),s()]}),userAgent:w(\"4.20.0\").add({segment:\"Browser\",version:\"lite\"}),authMode:m.WithinQueryParameters};return x(r(r(r({},a),n),{},{methods:{search:J,searchForFacetValues:k,multipleQueries:J,multipleSearchForFacetValues:k,customRequest:C,initIndex:function(e){return function(t){return E(e)(t,{methods:{search:F,searchForFacetValues:R,findAnswers:I}})}}}}))}return Q.version=\"4.20.0\",Q}));\n","import { createContext } from 'react';\nexport var IndexContext = /*#__PURE__*/createContext(null);\nif (process.env.NODE_ENV === 'development') {\n  IndexContext.displayName = 'Index';\n}","import { createContext } from 'react';\nexport var InstantSearchContext = /*#__PURE__*/createContext(null);\nif (process.env.NODE_ENV === 'development') {\n  InstantSearchContext.displayName = 'InstantSearch';\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nimport { warning } from \"../lib/utils/index.js\";\nexport var ANONYMOUS_TOKEN_COOKIE_KEY = '_ALGOLIA';\nfunction getCookie(name) {\n  if ((typeof document === \"undefined\" ? \"undefined\" : _typeof(document)) !== 'object' || typeof document.cookie !== 'string') {\n    return undefined;\n  }\n  var prefix = \"\".concat(name, \"=\");\n  var cookies = document.cookie.split(';');\n  for (var i = 0; i < cookies.length; i++) {\n    var cookie = cookies[i];\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1);\n    }\n    if (cookie.indexOf(prefix) === 0) {\n      return cookie.substring(prefix.length, cookie.length);\n    }\n  }\n  return undefined;\n}\nexport function getInsightsAnonymousUserTokenInternal() {\n  return getCookie(ANONYMOUS_TOKEN_COOKIE_KEY);\n}\n\n/**\n * @deprecated This function will be still supported in 4.x releases, but not further. It is replaced by the `insights` middleware. For more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\n */\nexport default function getInsightsAnonymousUserToken() {\n  process.env.NODE_ENV === 'development' ? warning(false, \"`getInsightsAnonymousUserToken` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `insights` middleware.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\") : void 0;\n  return getInsightsAnonymousUserTokenInternal();\n}","// eslint-disable-next-line no-restricted-globals\n\n/**\n * Runs code on browser environments safely.\n */\nexport function safelyRunOnBrowser(callback) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      fallback: function fallback() {\n        return undefined;\n      }\n    },\n    fallback = _ref.fallback;\n  // eslint-disable-next-line no-restricted-globals\n  if (typeof window === 'undefined') {\n    return fallback();\n  }\n\n  // eslint-disable-next-line no-restricted-globals\n  return callback({\n    window: window\n  });\n}","export function noop() {}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nimport { getInsightsAnonymousUserTokenInternal } from \"../helpers/index.js\";\nimport { warning, noop, getAppIdAndApiKey, find, safelyRunOnBrowser } from \"../lib/utils/index.js\";\nvar ALGOLIA_INSIGHTS_VERSION = '2.6.0';\nvar ALGOLIA_INSIGHTS_SRC = \"https://cdn.jsdelivr.net/npm/search-insights@\".concat(ALGOLIA_INSIGHTS_VERSION, \"/dist/search-insights.min.js\");\nexport function createInsightsMiddleware() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _insightsClient = props.insightsClient,\n    insightsInitParams = props.insightsInitParams,\n    onEvent = props.onEvent,\n    _props$$$internal = props.$$internal,\n    $$internal = _props$$$internal === void 0 ? false : _props$$$internal;\n  var potentialInsightsClient = _insightsClient;\n  if (!_insightsClient && _insightsClient !== null) {\n    safelyRunOnBrowser(function (_ref) {\n      var window = _ref.window;\n      var pointer = window.AlgoliaAnalyticsObject || 'aa';\n      if (typeof pointer === 'string') {\n        potentialInsightsClient = window[pointer];\n      }\n      if (!potentialInsightsClient) {\n        window.AlgoliaAnalyticsObject = pointer;\n        if (!window[pointer]) {\n          window[pointer] = function () {\n            if (!window[pointer].queue) {\n              window[pointer].queue = [];\n            }\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n            window[pointer].queue.push(args);\n          };\n          window[pointer].version = ALGOLIA_INSIGHTS_VERSION;\n          window[pointer].shouldAddScript = true;\n        }\n        potentialInsightsClient = window[pointer];\n      }\n    });\n  }\n  // if still no insightsClient was found, we use a noop\n  var insightsClient = potentialInsightsClient || noop;\n  return function (_ref2) {\n    var instantSearchInstance = _ref2.instantSearchInstance;\n    // remove existing default insights middleware\n    // user-provided insights middleware takes precedence\n    var existingInsightsMiddlewares = instantSearchInstance.middleware.filter(function (m) {\n      return m.instance.$$type === 'ais.insights' && m.instance.$$internal;\n    }).map(function (m) {\n      return m.creator;\n    });\n    instantSearchInstance.unuse.apply(instantSearchInstance, _toConsumableArray(existingInsightsMiddlewares));\n    var _getAppIdAndApiKey = getAppIdAndApiKey(instantSearchInstance.client),\n      _getAppIdAndApiKey2 = _slicedToArray(_getAppIdAndApiKey, 2),\n      appId = _getAppIdAndApiKey2[0],\n      apiKey = _getAppIdAndApiKey2[1];\n\n    // search-insights.js also throws an error so dev-only clarification is sufficient\n    process.env.NODE_ENV === 'development' ? warning(Boolean(appId && apiKey), 'could not extract Algolia credentials from searchClient in insights middleware.') : void 0;\n    var queuedUserToken = undefined;\n    var userTokenBeforeInit = undefined;\n    if (Array.isArray(insightsClient.queue)) {\n      // Context: The umd build of search-insights is asynchronously loaded by the snippet.\n      //\n      // When user calls `aa('setUserToken', 'my-user-token')` before `search-insights` is loaded,\n      // ['setUserToken', 'my-user-token'] gets stored in `aa.queue`.\n      // Whenever `search-insights` is finally loaded, it will process the queue.\n      //\n      // But here's the reason why we handle it here:\n      // At this point, even though `search-insights` is not loaded yet,\n      // we still want to read the token from the queue.\n      // Otherwise, the first search call will be fired without the token.\n      var _ref3 = find(insightsClient.queue.slice().reverse(), function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 1),\n          method = _ref6[0];\n        return method === 'setUserToken';\n      }) || [];\n      var _ref4 = _slicedToArray(_ref3, 2);\n      queuedUserToken = _ref4[1];\n    }\n    insightsClient('getUserToken', null, function (_error, userToken) {\n      // If user has called `aa('setUserToken', 'my-user-token')` before creating\n      // the `insights` middleware, we store them temporarily and\n      // set it later on.\n      //\n      // Otherwise, the `init` call might override it with anonymous user token.\n      userTokenBeforeInit = userToken;\n    });\n\n    // Only `init` if the `insightsInitParams` option is passed or\n    // if the `insightsClient` version doesn't supports optional `init` calling.\n    if (insightsInitParams || !isModernInsightsClient(insightsClient)) {\n      insightsClient('init', _objectSpread({\n        appId: appId,\n        apiKey: apiKey,\n        partial: true\n      }, insightsInitParams));\n    }\n    var initialParameters;\n    var helper;\n    return {\n      $$type: 'ais.insights',\n      $$internal: $$internal,\n      onStateChange: function onStateChange() {},\n      subscribe: function subscribe() {\n        if (!insightsClient.shouldAddScript) return;\n        var errorMessage = '[insights middleware]: could not load search-insights.js. Please load it manually following https://alg.li/insights-init';\n        try {\n          var script = document.createElement('script');\n          script.async = true;\n          script.src = ALGOLIA_INSIGHTS_SRC;\n          script.onerror = function () {\n            instantSearchInstance.emit('error', new Error(errorMessage));\n          };\n          document.body.appendChild(script);\n          insightsClient.shouldAddScript = false;\n        } catch (cause) {\n          insightsClient.shouldAddScript = false;\n          instantSearchInstance.emit('error', new Error(errorMessage));\n        }\n      },\n      started: function started() {\n        insightsClient('addAlgoliaAgent', 'insights-middleware');\n        helper = instantSearchInstance.helper;\n        initialParameters = {\n          userToken: helper.state.userToken,\n          clickAnalytics: helper.state.clickAnalytics\n        };\n        helper.overrideStateWithoutTriggeringChangeEvent(_objectSpread(_objectSpread({}, helper.state), {}, {\n          clickAnalytics: true\n        }));\n        if (!$$internal) {\n          instantSearchInstance.scheduleSearch();\n        }\n        var setUserTokenToSearch = function setUserTokenToSearch(userToken) {\n          var immediate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n          if (!userToken) {\n            return;\n          }\n          var existingToken = helper.state.userToken;\n          function applyToken() {\n            helper.overrideStateWithoutTriggeringChangeEvent(_objectSpread(_objectSpread({}, helper.state), {}, {\n              userToken: userToken\n            }));\n            if (existingToken && existingToken !== userToken) {\n              instantSearchInstance.scheduleSearch();\n            }\n          }\n\n          // Delay the token application to the next render cycle\n          if (!immediate) {\n            setTimeout(applyToken, 0);\n          } else {\n            applyToken();\n          }\n        };\n        var anonymousUserToken = getInsightsAnonymousUserTokenInternal();\n        if (anonymousUserToken) {\n          // When `aa('init', { ... })` is called, it creates an anonymous user token in cookie.\n          // We can set it as userToken.\n          setUserTokenToSearch(anonymousUserToken, true);\n        }\n\n        // We consider the `userToken` coming from a `init` call to have a higher\n        // importance than the one coming from the queue.\n        if (userTokenBeforeInit) {\n          setUserTokenToSearch(userTokenBeforeInit, true);\n          insightsClient('setUserToken', userTokenBeforeInit);\n        } else if (queuedUserToken) {\n          setUserTokenToSearch(queuedUserToken, true);\n          insightsClient('setUserToken', queuedUserToken);\n        }\n\n        // This updates userToken which is set explicitly by `aa('setUserToken', userToken)`\n        insightsClient('onUserTokenChange', setUserTokenToSearch, {\n          immediate: true\n        });\n        var insightsClientWithLocalCredentials = insightsClient;\n        if (isModernInsightsClient(insightsClient)) {\n          insightsClientWithLocalCredentials = function insightsClientWithLocalCredentials(method, payload) {\n            var extraParams = {\n              headers: {\n                'X-Algolia-Application-Id': appId,\n                'X-Algolia-API-Key': apiKey\n              }\n            };\n\n            // @ts-ignore we are calling this only when we know that the client actually is correct\n            return insightsClient(method, payload, extraParams);\n          };\n        }\n        instantSearchInstance.sendEventToInsights = function (event) {\n          if (onEvent) {\n            onEvent(event, insightsClientWithLocalCredentials);\n          } else if (event.insightsMethod) {\n            // Source is used to differentiate events sent by instantsearch from those sent manually.\n            event.payload.algoliaSource = ['instantsearch'];\n            if (event.eventModifier === 'internal') {\n              event.payload.algoliaSource.push('instantsearch-internal');\n            }\n            insightsClientWithLocalCredentials(event.insightsMethod, event.payload);\n            process.env.NODE_ENV === 'development' ? warning(Boolean(helper.state.userToken), \"\\nCannot send event to Algolia Insights because `userToken` is not set.\\n\\nSee documentation: https://www.algolia.com/doc/guides/building-search-ui/going-further/send-insights-events/js/#setting-the-usertoken\\n\") : void 0;\n          } else {\n            process.env.NODE_ENV === 'development' ? warning(false, 'Cannot send event to Algolia Insights because `insightsMethod` option is missing.') : void 0;\n          }\n        };\n      },\n      unsubscribe: function unsubscribe() {\n        insightsClient('onUserTokenChange', undefined);\n        instantSearchInstance.sendEventToInsights = noop;\n        if (helper && initialParameters) {\n          helper.overrideStateWithoutTriggeringChangeEvent(_objectSpread(_objectSpread({}, helper.state), initialParameters));\n          instantSearchInstance.scheduleSearch();\n        }\n      }\n    };\n  };\n}\n\n/**\n * Determines if a given insights `client` supports the optional call to `init`\n * and the ability to set credentials via extra parameters when sending events.\n */\nfunction isModernInsightsClient(client) {\n  var _split$map = (client.version || '').split('.').map(Number),\n    _split$map2 = _slicedToArray(_split$map, 2),\n    major = _split$map2[0],\n    minor = _split$map2[1];\n\n  /* eslint-disable @typescript-eslint/naming-convention */\n  var v3 = major >= 3;\n  var v2_6 = major === 2 && minor >= 6;\n  var v1_10 = major === 1 && minor >= 10;\n  /* eslint-enable @typescript-eslint/naming-convention */\n\n  return v3 || v2_6 || v1_10;\n}","export function createInitArgs(instantSearchInstance, parent, uiState) {\n  var helper = parent.getHelper();\n  return {\n    uiState: uiState,\n    helper: helper,\n    parent: parent,\n    instantSearchInstance: instantSearchInstance,\n    state: helper.state,\n    renderState: instantSearchInstance.renderState,\n    templatesConfig: instantSearchInstance.templatesConfig,\n    createURL: parent.createURL,\n    scopedResults: [],\n    searchMetadata: {\n      isSearchStalled: instantSearchInstance.status === 'stalled'\n    },\n    status: instantSearchInstance.status,\n    error: instantSearchInstance.error\n  };\n}\nexport function createRenderArgs(instantSearchInstance, parent) {\n  var results = parent.getResults();\n  var helper = parent.getHelper();\n  return {\n    helper: helper,\n    parent: parent,\n    instantSearchInstance: instantSearchInstance,\n    results: results,\n    scopedResults: parent.getScopedResults(),\n    state: results ? results._state : helper.state,\n    renderState: instantSearchInstance.renderState,\n    templatesConfig: instantSearchInstance.templatesConfig,\n    createURL: parent.createURL,\n    searchMetadata: {\n      isSearchStalled: instantSearchInstance.status === 'stalled'\n    },\n    status: instantSearchInstance.status,\n    error: instantSearchInstance.error\n  };\n}","import { createInitArgs, safelyRunOnBrowser } from \"../lib/utils/index.js\";\nfunction extractWidgetPayload(widgets, instantSearchInstance, payload) {\n  var initOptions = createInitArgs(instantSearchInstance, instantSearchInstance.mainIndex, instantSearchInstance._initialUiState);\n  widgets.forEach(function (widget) {\n    var widgetParams = {};\n    if (widget.getWidgetRenderState) {\n      var renderState = widget.getWidgetRenderState(initOptions);\n      if (renderState && renderState.widgetParams) {\n        // casting, as we just earlier checked widgetParams exists, and thus an object\n        widgetParams = renderState.widgetParams;\n      }\n    }\n\n    // since we destructure in all widgets, the parameters with defaults are set to \"undefined\"\n    var params = Object.keys(widgetParams).filter(function (key) {\n      return widgetParams[key] !== undefined;\n    });\n    payload.widgets.push({\n      type: widget.$$type,\n      widgetType: widget.$$widgetType,\n      params: params\n    });\n    if (widget.$$type === 'ais.index') {\n      extractWidgetPayload(widget.getWidgets(), instantSearchInstance, payload);\n    }\n  });\n}\nexport function isMetadataEnabled() {\n  return safelyRunOnBrowser(function (_ref) {\n    var _window$navigator, _window$navigator$use;\n    var window = _ref.window;\n    return ((_window$navigator = window.navigator) === null || _window$navigator === void 0 ? void 0 : (_window$navigator$use = _window$navigator.userAgent) === null || _window$navigator$use === void 0 ? void 0 : _window$navigator$use.indexOf('Algolia Crawler')) > -1;\n  }, {\n    fallback: function fallback() {\n      return false;\n    }\n  });\n}\n\n/**\n * Exposes the metadata of mounted widgets in a custom\n * `<meta name=\"instantsearch:widgets\" />` tag. The metadata per widget is:\n * - applied parameters\n * - widget name\n * - connector name\n */\nexport function createMetadataMiddleware() {\n  var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    _ref2$$$internal = _ref2.$$internal,\n    $$internal = _ref2$$$internal === void 0 ? false : _ref2$$$internal;\n  return function (_ref3) {\n    var instantSearchInstance = _ref3.instantSearchInstance;\n    var payload = {\n      widgets: []\n    };\n    var payloadContainer = document.createElement('meta');\n    var refNode = document.querySelector('head');\n    payloadContainer.name = 'instantsearch:widgets';\n    return {\n      $$type: 'ais.metadata',\n      $$internal: $$internal,\n      onStateChange: function onStateChange() {},\n      subscribe: function subscribe() {\n        // using setTimeout here to delay extraction until widgets have been added in a tick (e.g. Vue)\n        setTimeout(function () {\n          var client = instantSearchInstance.client;\n          payload.ua = client.transporter && client.transporter.userAgent ? client.transporter.userAgent.value : client._ua;\n          extractWidgetPayload(instantSearchInstance.mainIndex.getWidgets(), instantSearchInstance, payload);\n          instantSearchInstance.middleware.forEach(function (middleware) {\n            return payload.widgets.push({\n              middleware: true,\n              type: middleware.instance.$$type,\n              internal: middleware.instance.$$internal\n            });\n          });\n          payloadContainer.content = JSON.stringify(payload);\n          refNode.appendChild(payloadContainer);\n        }, 0);\n      },\n      started: function started() {},\n      unsubscribe: function unsubscribe() {\n        payloadContainer.remove();\n      }\n    };\n  };\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport qs from 'qs';\nimport { safelyRunOnBrowser, warning } from \"../utils/index.js\";\nvar setWindowTitle = function setWindowTitle(title) {\n  if (title) {\n    // This function is only executed on browsers so we can disable this check.\n    // eslint-disable-next-line no-restricted-globals\n    window.document.title = title;\n  }\n};\nvar BrowserHistory = /*#__PURE__*/function () {\n  /**\n   * Initializes a new storage provider that syncs the search state to the URL\n   * using web APIs (`window.location.pushState` and `onpopstate` event).\n   */\n  function BrowserHistory(_ref) {\n    var _this = this;\n    var windowTitle = _ref.windowTitle,\n      _ref$writeDelay = _ref.writeDelay,\n      writeDelay = _ref$writeDelay === void 0 ? 400 : _ref$writeDelay,\n      createURL = _ref.createURL,\n      parseURL = _ref.parseURL,\n      getLocation = _ref.getLocation,\n      start = _ref.start,\n      dispose = _ref.dispose,\n      push = _ref.push;\n    _classCallCheck(this, BrowserHistory);\n    _defineProperty(this, \"$$type\", 'ais.browser');\n    /**\n     * Transforms a UI state into a title for the page.\n     */\n    _defineProperty(this, \"windowTitle\", void 0);\n    /**\n     * Time in milliseconds before performing a write in the history.\n     * It prevents from adding too many entries in the history and\n     * makes the back button more usable.\n     *\n     * @default 400\n     */\n    _defineProperty(this, \"writeDelay\", void 0);\n    /**\n     * Creates a full URL based on the route state.\n     * The storage adaptor maps all syncable keys to the query string of the URL.\n     */\n    _defineProperty(this, \"_createURL\", void 0);\n    /**\n     * Parses the URL into a route state.\n     * It should be symmetrical to `createURL`.\n     */\n    _defineProperty(this, \"parseURL\", void 0);\n    /**\n     * Returns the location to store in the history.\n     * @default () => window.location\n     */\n    _defineProperty(this, \"getLocation\", void 0);\n    _defineProperty(this, \"writeTimer\", void 0);\n    _defineProperty(this, \"_onPopState\", void 0);\n    /**\n     * Indicates if last action was back/forward in the browser.\n     */\n    _defineProperty(this, \"inPopState\", false);\n    /**\n     * Indicates whether the history router is disposed or not.\n     */\n    _defineProperty(this, \"isDisposed\", false);\n    /**\n     * Indicates the window.history.length before the last call to\n     * window.history.pushState (called in `write`).\n     * It allows to determine if a `pushState` has been triggered elsewhere,\n     * and thus to prevent the `write` method from calling `pushState`.\n     */\n    _defineProperty(this, \"latestAcknowledgedHistory\", 0);\n    _defineProperty(this, \"_start\", void 0);\n    _defineProperty(this, \"_dispose\", void 0);\n    _defineProperty(this, \"_push\", void 0);\n    this.windowTitle = windowTitle;\n    this.writeTimer = undefined;\n    this.writeDelay = writeDelay;\n    this._createURL = createURL;\n    this.parseURL = parseURL;\n    this.getLocation = getLocation;\n    this._start = start;\n    this._dispose = dispose;\n    this._push = push;\n    safelyRunOnBrowser(function (_ref2) {\n      var window = _ref2.window;\n      var title = _this.windowTitle && _this.windowTitle(_this.read());\n      setWindowTitle(title);\n      _this.latestAcknowledgedHistory = window.history.length;\n    });\n  }\n\n  /**\n   * Reads the URL and returns a syncable UI search state.\n   */\n  _createClass(BrowserHistory, [{\n    key: \"read\",\n    value: function read() {\n      return this.parseURL({\n        qsModule: qs,\n        location: this.getLocation()\n      });\n    }\n\n    /**\n     * Pushes a search state into the URL.\n     */\n  }, {\n    key: \"write\",\n    value: function write(routeState) {\n      var _this2 = this;\n      safelyRunOnBrowser(function (_ref3) {\n        var window = _ref3.window;\n        var url = _this2.createURL(routeState);\n        var title = _this2.windowTitle && _this2.windowTitle(routeState);\n        if (_this2.writeTimer) {\n          clearTimeout(_this2.writeTimer);\n        }\n        _this2.writeTimer = setTimeout(function () {\n          setWindowTitle(title);\n          if (_this2.shouldWrite(url)) {\n            if (_this2._push) {\n              _this2._push(url);\n            } else {\n              window.history.pushState(routeState, title || '', url);\n            }\n            _this2.latestAcknowledgedHistory = window.history.length;\n          }\n          _this2.inPopState = false;\n          _this2.writeTimer = undefined;\n        }, _this2.writeDelay);\n      });\n    }\n\n    /**\n     * Sets a callback on the `onpopstate` event of the history API of the current page.\n     * It enables the URL sync to keep track of the changes.\n     */\n  }, {\n    key: \"onUpdate\",\n    value: function onUpdate(callback) {\n      var _this3 = this;\n      if (this._start) {\n        this._start(function () {\n          callback(_this3.read());\n        });\n      }\n      this._onPopState = function () {\n        if (_this3.writeTimer) {\n          clearTimeout(_this3.writeTimer);\n          _this3.writeTimer = undefined;\n        }\n        _this3.inPopState = true;\n\n        // We always read the state from the URL because the state of the history\n        // can be incorect in some cases (e.g. using React Router).\n        callback(_this3.read());\n      };\n      safelyRunOnBrowser(function (_ref4) {\n        var window = _ref4.window;\n        window.addEventListener('popstate', _this3._onPopState);\n      });\n    }\n\n    /**\n     * Creates a complete URL from a given syncable UI state.\n     *\n     * It always generates the full URL, not a relative one.\n     * This allows to handle cases like using a <base href>.\n     * See: https://github.com/algolia/instantsearch/issues/790\n     */\n  }, {\n    key: \"createURL\",\n    value: function createURL(routeState) {\n      var url = this._createURL({\n        qsModule: qs,\n        routeState: routeState,\n        location: this.getLocation()\n      });\n      if (process.env.NODE_ENV === 'development') {\n        try {\n          // We just want to check if the URL is valid.\n          // eslint-disable-next-line no-new\n          new URL(url);\n        } catch (e) {\n          process.env.NODE_ENV === 'development' ? warning(false, \"The URL returned by the `createURL` function is invalid.\\nPlease make sure it returns an absolute URL to avoid issues, e.g: `https://algolia.com/search?query=iphone`.\") : void 0;\n        }\n      }\n      return url;\n    }\n\n    /**\n     * Removes the event listener and cleans up the URL.\n     */\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      var _this4 = this;\n      if (this._dispose) {\n        this._dispose();\n      }\n      this.isDisposed = true;\n      safelyRunOnBrowser(function (_ref5) {\n        var window = _ref5.window;\n        if (_this4._onPopState) {\n          window.removeEventListener('popstate', _this4._onPopState);\n        }\n      });\n      if (this.writeTimer) {\n        clearTimeout(this.writeTimer);\n      }\n      this.write({});\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      this.isDisposed = false;\n    }\n  }, {\n    key: \"shouldWrite\",\n    value: function shouldWrite(url) {\n      var _this5 = this;\n      return safelyRunOnBrowser(function (_ref6) {\n        var window = _ref6.window;\n        // We do want to `pushState` if:\n        // - the router is not disposed, IS.js needs to update the URL\n        // OR\n        // - the last write was from InstantSearch.js\n        // (unlike a SPA, where it would have last written)\n        var lastPushWasByISAfterDispose = !(_this5.isDisposed && _this5.latestAcknowledgedHistory !== window.history.length);\n        return (\n          // When the last state change was through popstate, the IS.js state changes,\n          // but that should not write the URL.\n          !_this5.inPopState &&\n          // When the previous pushState after dispose was by IS.js, we want to write the URL.\n          lastPushWasByISAfterDispose &&\n          // When the URL is the same as the current one, we do not want to write it.\n          url !== window.location.href\n        );\n      });\n    }\n  }]);\n  return BrowserHistory;\n}();\nexport default function historyRouter() {\n  var _ref7 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    _ref7$createURL = _ref7.createURL,\n    createURL = _ref7$createURL === void 0 ? function (_ref8) {\n      var qsModule = _ref8.qsModule,\n        routeState = _ref8.routeState,\n        location = _ref8.location;\n      var protocol = location.protocol,\n        hostname = location.hostname,\n        _location$port = location.port,\n        port = _location$port === void 0 ? '' : _location$port,\n        pathname = location.pathname,\n        hash = location.hash;\n      var queryString = qsModule.stringify(routeState);\n      var portWithPrefix = port === '' ? '' : \":\".concat(port);\n\n      // IE <= 11 has no proper `location.origin` so we cannot rely on it.\n      if (!queryString) {\n        return \"\".concat(protocol, \"//\").concat(hostname).concat(portWithPrefix).concat(pathname).concat(hash);\n      }\n      return \"\".concat(protocol, \"//\").concat(hostname).concat(portWithPrefix).concat(pathname, \"?\").concat(queryString).concat(hash);\n    } : _ref7$createURL,\n    _ref7$parseURL = _ref7.parseURL,\n    parseURL = _ref7$parseURL === void 0 ? function (_ref9) {\n      var qsModule = _ref9.qsModule,\n        location = _ref9.location;\n      // `qs` by default converts arrays with more than 20 items to an object.\n      // We want to avoid this because the data structure manipulated can therefore vary.\n      // Setting the limit to `100` seems a good number because the engine's default is 100\n      // (it can go up to 1000 but it is very unlikely to select more than 100 items in the UI).\n      //\n      // Using an `arrayLimit` of `n` allows `n + 1` items.\n      //\n      // See:\n      //   - https://github.com/ljharb/qs#parsing-arrays\n      //   - https://www.algolia.com/doc/api-reference/api-parameters/maxValuesPerFacet/\n      return qsModule.parse(location.search.slice(1), {\n        arrayLimit: 99\n      });\n    } : _ref7$parseURL,\n    _ref7$writeDelay = _ref7.writeDelay,\n    writeDelay = _ref7$writeDelay === void 0 ? 400 : _ref7$writeDelay,\n    windowTitle = _ref7.windowTitle,\n    _ref7$getLocation = _ref7.getLocation,\n    getLocation = _ref7$getLocation === void 0 ? function () {\n      return safelyRunOnBrowser(function (_ref10) {\n        var window = _ref10.window;\n        return window.location;\n      }, {\n        fallback: function fallback() {\n          throw new Error('You need to provide `getLocation` to the `history` router in environments where `window` does not exist.');\n        }\n      });\n    } : _ref7$getLocation,\n    start = _ref7.start,\n    dispose = _ref7.dispose,\n    push = _ref7.push;\n  return new BrowserHistory({\n    createURL: createURL,\n    parseURL: parseURL,\n    writeDelay: writeDelay,\n    windowTitle: windowTitle,\n    getLocation: getLocation,\n    start: start,\n    dispose: dispose,\n    push: push\n  });\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar _excluded = [\"configure\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nfunction getIndexStateWithoutConfigure(uiState) {\n  var configure = uiState.configure,\n    trackedUiState = _objectWithoutProperties(uiState, _excluded);\n  return trackedUiState;\n}\n\n// technically a URL could contain any key, since users provide it,\n// which is why the input to this function is UiState, not something\n// which excludes \"configure\" as this function does.\nexport default function simpleStateMapping() {\n  return {\n    $$type: 'ais.simple',\n    stateToRoute: function stateToRoute(uiState) {\n      return Object.keys(uiState).reduce(function (state, indexId) {\n        return _objectSpread(_objectSpread({}, state), {}, _defineProperty({}, indexId, getIndexStateWithoutConfigure(uiState[indexId])));\n      }, {});\n    },\n    routeToState: function routeToState() {\n      var routeState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return Object.keys(routeState).reduce(function (state, indexId) {\n        return _objectSpread(_objectSpread({}, state), {}, _defineProperty({}, indexId, getIndexStateWithoutConfigure(routeState[indexId])));\n      }, {});\n    }\n  };\n}","function isPrimitive(obj) {\n  return obj !== Object(obj);\n}\nexport function isEqual(first, second) {\n  if (first === second) {\n    return true;\n  }\n  if (isPrimitive(first) || isPrimitive(second) || typeof first === 'function' || typeof second === 'function') {\n    return first === second;\n  }\n  if (Object.keys(first).length !== Object.keys(second).length) {\n    return false;\n  }\n\n  // @TODO avoid for..of because of the large polyfill\n  // eslint-disable-next-line no-restricted-syntax\n  for (var _i = 0, _Object$keys = Object.keys(first); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    if (!(key in second)) {\n      return false;\n    }\n    if (!isEqual(first[key], second[key])) {\n      return false;\n    }\n  }\n  return true;\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport historyRouter from \"../lib/routers/history.js\";\nimport simpleStateMapping from \"../lib/stateMappings/simple.js\";\nimport { isEqual } from \"../lib/utils/index.js\";\nexport var createRouterMiddleware = function createRouterMiddleware() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _props$router = props.router,\n    router = _props$router === void 0 ? historyRouter() : _props$router,\n    _props$stateMapping = props.stateMapping,\n    stateMapping = _props$stateMapping === void 0 ? simpleStateMapping() : _props$stateMapping,\n    _props$$$internal = props.$$internal,\n    $$internal = _props$$$internal === void 0 ? false : _props$$$internal;\n  return function (_ref) {\n    var instantSearchInstance = _ref.instantSearchInstance;\n    function topLevelCreateURL(nextState) {\n      var previousUiState =\n      // If only the mainIndex is initialized, we don't yet know what other\n      // index widgets are used. Therefore we fall back to the initialUiState.\n      // We can't indiscriminately use the initialUiState because then we\n      // reintroduce state that was changed by the user.\n      // When there are no widgets, we are sure the user can't yet have made\n      // any changes.\n      instantSearchInstance.mainIndex.getWidgets().length === 0 ? instantSearchInstance._initialUiState : instantSearchInstance.mainIndex.getWidgetUiState({});\n      var uiState = Object.keys(nextState).reduce(function (acc, indexId) {\n        return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, indexId, nextState[indexId]));\n      }, previousUiState);\n      var route = stateMapping.stateToRoute(uiState);\n      return router.createURL(route);\n    }\n\n    // casting to UiState here to keep createURL unaware of custom UiState\n    // (as long as it's an object, it's ok)\n    instantSearchInstance._createURL = topLevelCreateURL;\n    var lastRouteState = undefined;\n    var initialUiState = instantSearchInstance._initialUiState;\n    return {\n      $$type: \"ais.router({router:\".concat(router.$$type || '__unknown__', \", stateMapping:\").concat(stateMapping.$$type || '__unknown__', \"})\"),\n      $$internal: $$internal,\n      onStateChange: function onStateChange(_ref2) {\n        var uiState = _ref2.uiState;\n        var routeState = stateMapping.stateToRoute(uiState);\n        if (lastRouteState === undefined || !isEqual(lastRouteState, routeState)) {\n          router.write(routeState);\n          lastRouteState = routeState;\n        }\n      },\n      subscribe: function subscribe() {\n        instantSearchInstance._initialUiState = _objectSpread(_objectSpread({}, initialUiState), stateMapping.routeToState(router.read()));\n        router.onUpdate(function (route) {\n          if (instantSearchInstance.mainIndex.getWidgets().length > 0) {\n            instantSearchInstance.setUiState(stateMapping.routeToState(route));\n          }\n        });\n      },\n      started: function started() {\n        var _router$start;\n        (_router$start = router.start) === null || _router$start === void 0 ? void 0 : _router$start.call(router);\n      },\n      unsubscribe: function unsubscribe() {\n        router.dispose();\n      }\n    };\n  };\n};","export function createDocumentationLink(_ref) {\n  var name = _ref.name,\n    _ref$connector = _ref.connector,\n    connector = _ref$connector === void 0 ? false : _ref$connector;\n  return ['https://www.algolia.com/doc/api-reference/widgets/', name, '/js/', connector ? '#connector' : ''].join('');\n}\nexport function createDocumentationMessageGenerator() {\n  for (var _len = arguments.length, widgets = new Array(_len), _key = 0; _key < _len; _key++) {\n    widgets[_key] = arguments[_key];\n  }\n  var links = widgets.map(function (widget) {\n    return createDocumentationLink(widget);\n  }).join(', ');\n  return function (message) {\n    return [message, \"See documentation: \".concat(links)].filter(Boolean).join('\\n\\n');\n  };\n}","export function isIndexWidget(widget) {\n  return widget.$$type === 'ais.index';\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar _excluded = [\"facets\", \"disjunctiveFacets\", \"facetsRefinements\", \"facetsExcludes\", \"disjunctiveFacetsRefinements\", \"numericRefinements\", \"tagRefinements\", \"hierarchicalFacets\", \"hierarchicalFacetsRefinements\", \"ruleContexts\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport { findIndex } from \"./findIndex.js\";\nimport { uniq } from \"./uniq.js\";\nvar mergeWithRest = function mergeWithRest(left, right) {\n  var facets = right.facets,\n    disjunctiveFacets = right.disjunctiveFacets,\n    facetsRefinements = right.facetsRefinements,\n    facetsExcludes = right.facetsExcludes,\n    disjunctiveFacetsRefinements = right.disjunctiveFacetsRefinements,\n    numericRefinements = right.numericRefinements,\n    tagRefinements = right.tagRefinements,\n    hierarchicalFacets = right.hierarchicalFacets,\n    hierarchicalFacetsRefinements = right.hierarchicalFacetsRefinements,\n    ruleContexts = right.ruleContexts,\n    rest = _objectWithoutProperties(right, _excluded);\n  return left.setQueryParameters(rest);\n};\n\n// Merge facets\nvar mergeFacets = function mergeFacets(left, right) {\n  return right.facets.reduce(function (_, name) {\n    return _.addFacet(name);\n  }, left);\n};\nvar mergeDisjunctiveFacets = function mergeDisjunctiveFacets(left, right) {\n  return right.disjunctiveFacets.reduce(function (_, name) {\n    return _.addDisjunctiveFacet(name);\n  }, left);\n};\nvar mergeHierarchicalFacets = function mergeHierarchicalFacets(left, right) {\n  return left.setQueryParameters({\n    hierarchicalFacets: right.hierarchicalFacets.reduce(function (facets, facet) {\n      var index = findIndex(facets, function (_) {\n        return _.name === facet.name;\n      });\n      if (index === -1) {\n        return facets.concat(facet);\n      }\n      var nextFacets = facets.slice();\n      nextFacets.splice(index, 1, facet);\n      return nextFacets;\n    }, left.hierarchicalFacets)\n  });\n};\n\n// Merge facet refinements\nvar mergeTagRefinements = function mergeTagRefinements(left, right) {\n  return right.tagRefinements.reduce(function (_, value) {\n    return _.addTagRefinement(value);\n  }, left);\n};\nvar mergeFacetRefinements = function mergeFacetRefinements(left, right) {\n  return left.setQueryParameters({\n    facetsRefinements: _objectSpread(_objectSpread({}, left.facetsRefinements), right.facetsRefinements)\n  });\n};\nvar mergeFacetsExcludes = function mergeFacetsExcludes(left, right) {\n  return left.setQueryParameters({\n    facetsExcludes: _objectSpread(_objectSpread({}, left.facetsExcludes), right.facetsExcludes)\n  });\n};\nvar mergeDisjunctiveFacetsRefinements = function mergeDisjunctiveFacetsRefinements(left, right) {\n  return left.setQueryParameters({\n    disjunctiveFacetsRefinements: _objectSpread(_objectSpread({}, left.disjunctiveFacetsRefinements), right.disjunctiveFacetsRefinements)\n  });\n};\nvar mergeNumericRefinements = function mergeNumericRefinements(left, right) {\n  return left.setQueryParameters({\n    numericRefinements: _objectSpread(_objectSpread({}, left.numericRefinements), right.numericRefinements)\n  });\n};\nvar mergeHierarchicalFacetsRefinements = function mergeHierarchicalFacetsRefinements(left, right) {\n  return left.setQueryParameters({\n    hierarchicalFacetsRefinements: _objectSpread(_objectSpread({}, left.hierarchicalFacetsRefinements), right.hierarchicalFacetsRefinements)\n  });\n};\nvar mergeRuleContexts = function mergeRuleContexts(left, right) {\n  var ruleContexts = uniq([].concat(left.ruleContexts).concat(right.ruleContexts).filter(Boolean));\n  if (ruleContexts.length > 0) {\n    return left.setQueryParameters({\n      ruleContexts: ruleContexts\n    });\n  }\n  return left;\n};\nexport var mergeSearchParameters = function mergeSearchParameters() {\n  for (var _len = arguments.length, parameters = new Array(_len), _key = 0; _key < _len; _key++) {\n    parameters[_key] = arguments[_key];\n  }\n  return parameters.reduce(function (left, right) {\n    var hierarchicalFacetsRefinementsMerged = mergeHierarchicalFacetsRefinements(left, right);\n    var hierarchicalFacetsMerged = mergeHierarchicalFacets(hierarchicalFacetsRefinementsMerged, right);\n    var tagRefinementsMerged = mergeTagRefinements(hierarchicalFacetsMerged, right);\n    var numericRefinementsMerged = mergeNumericRefinements(tagRefinementsMerged, right);\n    var disjunctiveFacetsRefinementsMerged = mergeDisjunctiveFacetsRefinements(numericRefinementsMerged, right);\n    var facetsExcludesMerged = mergeFacetsExcludes(disjunctiveFacetsRefinementsMerged, right);\n    var facetRefinementsMerged = mergeFacetRefinements(facetsExcludesMerged, right);\n    var disjunctiveFacetsMerged = mergeDisjunctiveFacets(facetRefinementsMerged, right);\n    var ruleContextsMerged = mergeRuleContexts(disjunctiveFacetsMerged, right);\n    var facetsMerged = mergeFacets(ruleContextsMerged, right);\n    return mergeWithRest(facetsMerged, right);\n  });\n};","// We aren't using the native `Array.prototype.findIndex` because the refactor away from Lodash is not\n// published as a major version.\n// Relying on the `findIndex` polyfill on user-land, which before was only required for niche use-cases,\n// was decided as too risky.\n// @MAJOR Replace with the native `Array.prototype.findIndex` method\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex\nexport function findIndex(array, comparator) {\n  if (!Array.isArray(array)) {\n    return -1;\n  }\n  for (var i = 0; i < array.length; i++) {\n    if (comparator(array[i])) {\n      return i;\n    }\n  }\n  return -1;\n}","export function uniq(array) {\n  return array.filter(function (value, index, self) {\n    return self.indexOf(value) === index;\n  });\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar _excluded = [\"initialSearchParameters\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { checkIndexUiState, createDocumentationMessageGenerator, resolveSearchParameters, mergeSearchParameters, warning, isIndexWidget, createInitArgs, createRenderArgs } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'index-widget'\n});\n/**\n * This is the same content as helper._change / setState, but allowing for extra\n * UiState to be synchronized.\n * see: https://github.com/algolia/algoliasearch-helper-js/blob/6b835ffd07742f2d6b314022cce6848f5cfecd4a/src/algoliasearch.helper.js#L1311-L1324\n */\nfunction privateHelperSetState(helper, _ref) {\n  var state = _ref.state,\n    isPageReset = _ref.isPageReset,\n    _uiState = _ref._uiState;\n  if (state !== helper.state) {\n    helper.state = state;\n    helper.emit('change', {\n      state: helper.state,\n      results: helper.lastResults,\n      isPageReset: isPageReset,\n      _uiState: _uiState\n    });\n  }\n}\nfunction getLocalWidgetsUiState(widgets, widgetStateOptions) {\n  var initialUiState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return widgets.reduce(function (uiState, widget) {\n    if (isIndexWidget(widget)) {\n      return uiState;\n    }\n    if (!widget.getWidgetUiState && !widget.getWidgetState) {\n      return uiState;\n    }\n    if (widget.getWidgetUiState) {\n      return widget.getWidgetUiState(uiState, widgetStateOptions);\n    }\n    return widget.getWidgetState(uiState, widgetStateOptions);\n  }, initialUiState);\n}\nfunction getLocalWidgetsSearchParameters(widgets, widgetSearchParametersOptions) {\n  var initialSearchParameters = widgetSearchParametersOptions.initialSearchParameters,\n    rest = _objectWithoutProperties(widgetSearchParametersOptions, _excluded);\n  return widgets.filter(function (widget) {\n    return !isIndexWidget(widget);\n  }).reduce(function (state, widget) {\n    if (!widget.getWidgetSearchParameters) {\n      return state;\n    }\n    return widget.getWidgetSearchParameters(state, rest);\n  }, initialSearchParameters);\n}\nfunction resetPageFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  if (indexWidgets.length === 0) {\n    return;\n  }\n  indexWidgets.forEach(function (widget) {\n    var widgetHelper = widget.getHelper();\n    privateHelperSetState(widgetHelper, {\n      state: widgetHelper.state.resetPage(),\n      isPageReset: true\n    });\n    resetPageFromWidgets(widget.getWidgets());\n  });\n}\nfunction resolveScopedResultsFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  return indexWidgets.reduce(function (scopedResults, current) {\n    return scopedResults.concat.apply(scopedResults, [{\n      indexId: current.getIndexId(),\n      results: current.getResults(),\n      helper: current.getHelper()\n    }].concat(_toConsumableArray(resolveScopedResultsFromWidgets(current.getWidgets()))));\n  }, []);\n}\nvar index = function index(widgetParams) {\n  if (widgetParams === undefined || widgetParams.indexName === undefined) {\n    throw new Error(withUsage('The `indexName` option is required.'));\n  }\n  var indexName = widgetParams.indexName,\n    _widgetParams$indexId = widgetParams.indexId,\n    indexId = _widgetParams$indexId === void 0 ? indexName : _widgetParams$indexId;\n  var localWidgets = [];\n  var localUiState = {};\n  var localInstantSearchInstance = null;\n  var localParent = null;\n  var helper = null;\n  var derivedHelper = null;\n  var lastValidSearchParameters = null;\n  return {\n    $$type: 'ais.index',\n    $$widgetType: 'ais.index',\n    getIndexName: function getIndexName() {\n      return indexName;\n    },\n    getIndexId: function getIndexId() {\n      return indexId;\n    },\n    getHelper: function getHelper() {\n      return helper;\n    },\n    getResults: function getResults() {\n      var _derivedHelper;\n      if (!((_derivedHelper = derivedHelper) !== null && _derivedHelper !== void 0 && _derivedHelper.lastResults)) return null;\n\n      // To make the UI optimistic, we patch the state to display to the current\n      // one instead of the one associated with the latest results.\n      // This means user-driven UI changes (e.g., checked checkbox) are reflected\n      // immediately instead of waiting for Algolia to respond, regardless of\n      // the status of the network request.\n      derivedHelper.lastResults._state = helper.state;\n      return derivedHelper.lastResults;\n    },\n    getPreviousState: function getPreviousState() {\n      return lastValidSearchParameters;\n    },\n    getScopedResults: function getScopedResults() {\n      var widgetParent = this.getParent();\n\n      // If the widget is the root, we consider itself as the only sibling.\n      var widgetSiblings = widgetParent ? widgetParent.getWidgets() : [this];\n      return resolveScopedResultsFromWidgets(widgetSiblings);\n    },\n    getParent: function getParent() {\n      return localParent;\n    },\n    createURL: function createURL(nextState) {\n      if (typeof nextState === 'function') {\n        return localInstantSearchInstance._createURL(_defineProperty({}, indexId, nextState(localUiState)));\n      }\n      return localInstantSearchInstance._createURL(_defineProperty({}, indexId, getLocalWidgetsUiState(localWidgets, {\n        searchParameters: nextState,\n        helper: helper\n      })));\n    },\n    getWidgets: function getWidgets() {\n      return localWidgets;\n    },\n    addWidgets: function addWidgets(widgets) {\n      var _this = this;\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets.'));\n      }\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n      localWidgets = localWidgets.concat(widgets);\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        privateHelperSetState(helper, {\n          state: getLocalWidgetsSearchParameters(localWidgets, {\n            uiState: localUiState,\n            initialSearchParameters: helper.state\n          }),\n          _uiState: localUiState\n        });\n\n        // We compute the render state before calling `init` in a separate loop\n        // to construct the whole render state object that is then passed to\n        // `init`.\n        widgets.forEach(function (widget) {\n          if (widget.getRenderState) {\n            var renderState = widget.getRenderState(localInstantSearchInstance.renderState[_this.getIndexId()] || {}, createInitArgs(localInstantSearchInstance, _this, localInstantSearchInstance._initialUiState));\n            storeRenderState({\n              renderState: renderState,\n              instantSearchInstance: localInstantSearchInstance,\n              parent: _this\n            });\n          }\n        });\n        widgets.forEach(function (widget) {\n          if (widget.init) {\n            widget.init(createInitArgs(localInstantSearchInstance, _this, localInstantSearchInstance._initialUiState));\n          }\n        });\n        localInstantSearchInstance.scheduleSearch();\n      }\n      return this;\n    },\n    removeWidgets: function removeWidgets(widgets) {\n      var _this2 = this;\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets.'));\n      }\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n      localWidgets = localWidgets.filter(function (widget) {\n        return widgets.indexOf(widget) === -1;\n      });\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        var _nextState = widgets.reduce(function (state, widget) {\n          // the `dispose` method exists at this point we already assert it\n          var next = widget.dispose({\n            helper: helper,\n            state: state,\n            parent: _this2\n          });\n          return next || state;\n        }, helper.state);\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: _nextState,\n          helper: helper\n        });\n        helper.setState(getLocalWidgetsSearchParameters(localWidgets, {\n          uiState: localUiState,\n          initialSearchParameters: _nextState\n        }));\n        if (localWidgets.length) {\n          localInstantSearchInstance.scheduleSearch();\n        }\n      }\n      return this;\n    },\n    init: function init(_ref2) {\n      var _this3 = this,\n        _instantSearchInstanc;\n      var instantSearchInstance = _ref2.instantSearchInstance,\n        parent = _ref2.parent,\n        uiState = _ref2.uiState;\n      if (helper !== null) {\n        // helper is already initialized, therefore we do not need to set up\n        // any listeners\n        return;\n      }\n      localInstantSearchInstance = instantSearchInstance;\n      localParent = parent;\n      localUiState = uiState[indexId] || {};\n\n      // The `mainHelper` is already defined at this point. The instance is created\n      // inside InstantSearch at the `start` method, which occurs before the `init`\n      // step.\n      var mainHelper = instantSearchInstance.mainHelper;\n      var parameters = getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: localUiState,\n        initialSearchParameters: new algoliasearchHelper.SearchParameters({\n          index: indexName\n        })\n      });\n\n      // This Helper is only used for state management we do not care about the\n      // `searchClient`. Only the \"main\" Helper created at the `InstantSearch`\n      // level is aware of the client.\n      helper = algoliasearchHelper({}, parameters.index, parameters);\n\n      // We forward the call to `search` to the \"main\" instance of the Helper\n      // which is responsible for managing the queries (it's the only one that is\n      // aware of the `searchClient`).\n      helper.search = function () {\n        if (instantSearchInstance.onStateChange) {\n          instantSearchInstance.onStateChange({\n            uiState: instantSearchInstance.mainIndex.getWidgetUiState({}),\n            setUiState: function setUiState(nextState) {\n              return instantSearchInstance.setUiState(nextState, false);\n            }\n          });\n\n          // We don't trigger a search when controlled because it becomes the\n          // responsibility of `setUiState`.\n          return mainHelper;\n        }\n        return mainHelper.search();\n      };\n      helper.searchWithoutTriggeringOnStateChange = function () {\n        return mainHelper.search();\n      };\n\n      // We use the same pattern for the `searchForFacetValues`.\n      helper.searchForFacetValues = function (facetName, facetValue, maxFacetHits, userState) {\n        var state = helper.state.setQueryParameters(userState);\n        return mainHelper.searchForFacetValues(facetName, facetValue, maxFacetHits, state);\n      };\n      derivedHelper = mainHelper.derive(function () {\n        return mergeSearchParameters.apply(void 0, _toConsumableArray(resolveSearchParameters(_this3)));\n      });\n      var indexInitialResults = (_instantSearchInstanc = instantSearchInstance._initialResults) === null || _instantSearchInstanc === void 0 ? void 0 : _instantSearchInstanc[this.getIndexId()];\n      if (indexInitialResults) {\n        // We restore the shape of the results provided to the instance to respect\n        // the helper's structure.\n        var results = new algoliasearchHelper.SearchResults(new algoliasearchHelper.SearchParameters(indexInitialResults.state), indexInitialResults.results);\n        derivedHelper.lastResults = results;\n        helper.lastResults = results;\n      }\n\n      // Subscribe to the Helper state changes for the page before widgets\n      // are initialized. This behavior mimics the original one of the Helper.\n      // It makes sense to replicate it at the `init` step. We have another\n      // listener on `change` below, once `init` is done.\n      helper.on('change', function (_ref3) {\n        var isPageReset = _ref3.isPageReset;\n        if (isPageReset) {\n          resetPageFromWidgets(localWidgets);\n        }\n      });\n      derivedHelper.on('search', function () {\n        // The index does not manage the \"staleness\" of the search. This is the\n        // responsibility of the main instance. It does not make sense to manage\n        // it at the index level because it's either: all of them or none of them\n        // that are stalled. The queries are performed into a single network request.\n        instantSearchInstance.scheduleStalledRender();\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: _this3,\n            indexUiState: localUiState\n          });\n        }\n      });\n      derivedHelper.on('result', function (_ref4) {\n        var results = _ref4.results;\n        // The index does not render the results it schedules a new render\n        // to let all the other indices emit their own results. It allows us to\n        // run the render process in one pass.\n        instantSearchInstance.scheduleRender();\n\n        // the derived helper is the one which actually searches, but the helper\n        // which is exposed e.g. via instance.helper, doesn't search, and thus\n        // does not have access to lastResults, which it used to in pre-federated\n        // search behavior.\n        helper.lastResults = results;\n        lastValidSearchParameters = results === null || results === void 0 ? void 0 : results._state;\n      });\n\n      // We compute the render state before calling `init` in a separate loop\n      // to construct the whole render state object that is then passed to\n      // `init`.\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this3.getIndexId()] || {}, createInitArgs(instantSearchInstance, _this3, uiState));\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this3\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        process.env.NODE_ENV === 'development' ? warning(\n        // if it has NO getWidgetState or if it has getWidgetUiState, we don't warn\n        // aka we warn if there's _only_ getWidgetState\n        !widget.getWidgetState || Boolean(widget.getWidgetUiState), 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n        if (widget.init) {\n          widget.init(createInitArgs(instantSearchInstance, _this3, uiState));\n        }\n      });\n\n      // Subscribe to the Helper state changes for the `uiState` once widgets\n      // are initialized. Until the first render, state changes are part of the\n      // configuration step. This is mainly for backward compatibility with custom\n      // widgets. When the subscription happens before the `init` step, the (static)\n      // configuration of the widget is pushed in the URL. That's what we want to avoid.\n      // https://github.com/algolia/instantsearch/pull/994/commits/4a672ae3fd78809e213de0368549ef12e9dc9454\n      helper.on('change', function (event) {\n        var state = event.state;\n        var _uiState = event._uiState;\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: state,\n          helper: helper\n        }, _uiState || {});\n\n        // We don't trigger an internal change when controlled because it\n        // becomes the responsibility of `setUiState`.\n        if (!instantSearchInstance.onStateChange) {\n          instantSearchInstance.onInternalStateChange();\n        }\n      });\n      if (indexInitialResults) {\n        // If there are initial results, we're not notified of the next results\n        // because we don't trigger an initial search. We therefore need to directly\n        // schedule a render that will render the results injected on the helper.\n        instantSearchInstance.scheduleRender();\n      }\n    },\n    render: function render(_ref5) {\n      var _this4 = this;\n      var instantSearchInstance = _ref5.instantSearchInstance;\n      // we can't attach a listener to the error event of search, as the error\n      // then would no longer be thrown for global handlers.\n      if (instantSearchInstance.status === 'error' && !instantSearchInstance.mainHelper.hasPendingRequests() && lastValidSearchParameters) {\n        helper.setState(lastValidSearchParameters);\n      }\n\n      // We only render index widgets if there are no results.\n      // This makes sure `render` is never called with `results` being `null`.\n      var widgetsToRender = this.getResults() ? localWidgets : localWidgets.filter(isIndexWidget);\n      widgetsToRender.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this4.getIndexId()] || {}, createRenderArgs(instantSearchInstance, _this4));\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this4\n          });\n        }\n      });\n      widgetsToRender.forEach(function (widget) {\n        // At this point, all the variables used below are set. Both `helper`\n        // and `derivedHelper` have been created at the `init` step. The attribute\n        // `lastResults` might be `null` though. It's possible that a stalled render\n        // happens before the result e.g with a dynamically added index the request might\n        // be delayed. The render is triggered for the complete tree but some parts do\n        // not have results yet.\n\n        if (widget.render) {\n          widget.render(createRenderArgs(instantSearchInstance, _this4));\n        }\n      });\n    },\n    dispose: function dispose() {\n      var _this5 = this,\n        _helper,\n        _derivedHelper2;\n      localWidgets.forEach(function (widget) {\n        if (widget.dispose) {\n          // The dispose function is always called once the instance is started\n          // (it's an effect of `removeWidgets`). The index is initialized and\n          // the Helper is available. We don't care about the return value of\n          // `dispose` because the index is removed. We can't call `removeWidgets`\n          // because we want to keep the widgets on the instance, to allow idempotent\n          // operations on `add` & `remove`.\n          widget.dispose({\n            helper: helper,\n            state: helper.state,\n            parent: _this5\n          });\n        }\n      });\n      localInstantSearchInstance = null;\n      localParent = null;\n      (_helper = helper) === null || _helper === void 0 ? void 0 : _helper.removeAllListeners();\n      helper = null;\n      (_derivedHelper2 = derivedHelper) === null || _derivedHelper2 === void 0 ? void 0 : _derivedHelper2.detach();\n      derivedHelper = null;\n    },\n    getWidgetUiState: function getWidgetUiState(uiState) {\n      return localWidgets.filter(isIndexWidget).reduce(function (previousUiState, innerIndex) {\n        return innerIndex.getWidgetUiState(previousUiState);\n      }, _objectSpread(_objectSpread({}, uiState), {}, _defineProperty({}, indexId, _objectSpread(_objectSpread({}, uiState[indexId]), localUiState))));\n    },\n    getWidgetState: function getWidgetState(uiState) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n      return this.getWidgetUiState(uiState);\n    },\n    getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n      var uiState = _ref6.uiState;\n      return getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: uiState,\n        initialSearchParameters: searchParameters\n      });\n    },\n    refreshUiState: function refreshUiState() {\n      localUiState = getLocalWidgetsUiState(localWidgets, {\n        searchParameters: this.getHelper().state,\n        helper: this.getHelper()\n      }, localUiState);\n    },\n    setIndexUiState: function setIndexUiState(indexUiState) {\n      var nextIndexUiState = typeof indexUiState === 'function' ? indexUiState(localUiState) : indexUiState;\n      localInstantSearchInstance.setUiState(function (state) {\n        return _objectSpread(_objectSpread({}, state), {}, _defineProperty({}, indexId, nextIndexUiState));\n      });\n    }\n  };\n};\nexport default index;\nfunction storeRenderState(_ref7) {\n  var renderState = _ref7.renderState,\n    instantSearchInstance = _ref7.instantSearchInstance,\n    parent = _ref7.parent;\n  var parentIndexName = parent ? parent.getIndexId() : instantSearchInstance.mainIndex.getIndexId();\n  instantSearchInstance.renderState = _objectSpread(_objectSpread({}, instantSearchInstance.renderState), {}, _defineProperty({}, parentIndexName, _objectSpread(_objectSpread({}, instantSearchInstance.renderState[parentIndexName]), renderState)));\n}","export function resolveSearchParameters(current) {\n  var parent = current.getParent();\n  var states = [current.getHelper().state];\n  while (parent !== null) {\n    states = [parent.getHelper().state].concat(states);\n    parent = parent.getParent();\n  }\n  return states;\n}","var NAMESPACE = 'ais';\nexport var component = function component(componentName) {\n  return function () {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      descendantName = _ref.descendantName,\n      modifierName = _ref.modifierName;\n    var descendent = descendantName ? \"-\".concat(descendantName) : '';\n    var modifier = modifierName ? \"--\".concat(modifierName) : '';\n    return \"\".concat(NAMESPACE, \"-\").concat(componentName).concat(descendent).concat(modifier);\n  };\n};","export function getPropertyByPath(object, path) {\n  var parts = Array.isArray(path) ? path : path.split('.');\n  return parts.reduce(function (current, key) {\n    return current && current[key];\n  }, object);\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _objectDestructuringEmpty(obj) { if (obj == null) throw new TypeError(\"Cannot destructure \" + obj); }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { escape } from \"./escape-html.js\";\nimport { isPlainObject } from \"./isPlainObject.js\";\nexport var TAG_PLACEHOLDER = {\n  highlightPreTag: '__ais-highlight__',\n  highlightPostTag: '__/ais-highlight__'\n};\nexport var TAG_REPLACEMENT = {\n  highlightPreTag: '<mark>',\n  highlightPostTag: '</mark>'\n};\n\n// @MAJOR: in the future, this should only escape, not replace\nfunction replaceTagsAndEscape(value) {\n  return escape(value).replace(new RegExp(TAG_PLACEHOLDER.highlightPreTag, 'g'), TAG_REPLACEMENT.highlightPreTag).replace(new RegExp(TAG_PLACEHOLDER.highlightPostTag, 'g'), TAG_REPLACEMENT.highlightPostTag);\n}\nfunction recursiveEscape(input) {\n  if (isPlainObject(input) && typeof input.value !== 'string') {\n    return Object.keys(input).reduce(function (acc, key) {\n      return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, key, recursiveEscape(input[key])));\n    }, {});\n  }\n  if (Array.isArray(input)) {\n    return input.map(recursiveEscape);\n  }\n  return _objectSpread(_objectSpread({}, input), {}, {\n    value: replaceTagsAndEscape(input.value)\n  });\n}\nexport function escapeHits(hits) {\n  if (hits.__escaped === undefined) {\n    // We don't override the value on hit because it will mutate the raw results\n    // instead we make a shallow copy and we assign the escaped values on it.\n    hits = hits.map(function (_ref) {\n      var hit = _extends({}, (_objectDestructuringEmpty(_ref), _ref));\n      if (hit._highlightResult) {\n        hit._highlightResult = recursiveEscape(hit._highlightResult);\n      }\n      if (hit._snippetResult) {\n        hit._snippetResult = recursiveEscape(hit._snippetResult);\n      }\n      return hit;\n    });\n    hits.__escaped = true;\n  }\n  return hits;\n}\nexport function escapeFacets(facetHits) {\n  return facetHits.map(function (h) {\n    return _objectSpread(_objectSpread({}, h), {}, {\n      highlighted: replaceTagsAndEscape(h.highlighted)\n    });\n  });\n}","import { component } from \"../lib/suit.js\";\nimport { getPropertyByPath, TAG_REPLACEMENT, warning } from \"../lib/utils/index.js\";\nvar suit = component('Highlight');\n\n/**\n * @deprecated use html tagged templates and the Highlight component instead\n */\nexport default function highlight(_ref) {\n  var attribute = _ref.attribute,\n    _ref$highlightedTagNa = _ref.highlightedTagName,\n    highlightedTagName = _ref$highlightedTagNa === void 0 ? 'mark' : _ref$highlightedTagNa,\n    hit = _ref.hit,\n    _ref$cssClasses = _ref.cssClasses,\n    cssClasses = _ref$cssClasses === void 0 ? {} : _ref$cssClasses;\n  process.env.NODE_ENV === 'development' ? warning(false, \"`instantsearch.highlight` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `Highlight` component.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/building-search-ui/upgrade-guides/js/?client=html+tagged+templates#upgrade-templates\") : void 0;\n  var highlightAttributeResult = getPropertyByPath(hit._highlightResult, attribute);\n\n  // @MAJOR fallback to attribute value if highlight is not found\n  process.env.NODE_ENV === 'development' ? warning(highlightAttributeResult, \"Could not enable highlight for \\\"\".concat(attribute, \"\\\", will display an empty string.\\nPlease check whether this attribute exists and is either searchable or specified in `attributesToHighlight`.\\n\\nSee: https://alg.li/highlighting\\n\")) : void 0;\n  var _ref2 = highlightAttributeResult || {},\n    _ref2$value = _ref2.value,\n    attributeValue = _ref2$value === void 0 ? '' : _ref2$value;\n\n  // cx is not used, since it would be bundled as a dependency for Vue & Angular\n  var className = suit({\n    descendantName: 'highlighted'\n  }) + (cssClasses.highlighted ? \" \".concat(cssClasses.highlighted) : '');\n  return attributeValue.replace(new RegExp(TAG_REPLACEMENT.highlightPreTag, 'g'), \"<\".concat(highlightedTagName, \" class=\\\"\").concat(className, \"\\\">\")).replace(new RegExp(TAG_REPLACEMENT.highlightPostTag, 'g'), \"</\".concat(highlightedTagName, \">\"));\n}","import { TAG_REPLACEMENT } from \"./escape-highlight.js\";\nexport function concatHighlightedParts(parts) {\n  var highlightPreTag = TAG_REPLACEMENT.highlightPreTag,\n    highlightPostTag = TAG_REPLACEMENT.highlightPostTag;\n  return parts.map(function (part) {\n    return part.isHighlighted ? highlightPreTag + part.value + highlightPostTag : part.value;\n  }).join('');\n}","/**\n * This implementation is taken from Lodash implementation.\n * See: https://github.com/lodash/lodash/blob/4.17.11-npm/escape.js\n */\n\n// Used to map characters to HTML entities.\nvar htmlEntities = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\n\n// Used to match HTML entities and HTML characters.\nvar regexUnescapedHtml = /[&<>\"']/g;\nvar regexHasUnescapedHtml = RegExp(regexUnescapedHtml.source);\n\n/**\n * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n * corresponding HTML entities.\n */\nexport function escape(value) {\n  return value && regexHasUnescapedHtml.test(value) ? value.replace(regexUnescapedHtml, function (character) {\n    return htmlEntities[character];\n  }) : value;\n}\n\n/**\n * This implementation is taken from Lodash implementation.\n * See: https://github.com/lodash/lodash/blob/4.17.11-npm/unescape.js\n */\n\n// Used to map HTML entities to characters.\nvar htmlCharacters = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\n\n// Used to match HTML entities and HTML characters.\nvar regexEscapedHtml = /&(amp|quot|lt|gt|#39);/g;\nvar regexHasEscapedHtml = RegExp(regexEscapedHtml.source);\n\n/**\n * Converts the HTML entities \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n * characters.\n */\nexport function unescape(value) {\n  return value && regexHasEscapedHtml.test(value) ? value.replace(regexEscapedHtml, function (character) {\n    return htmlCharacters[character];\n  }) : value;\n}","import { unescape } from \"./escape-html.js\";\nvar hasAlphanumeric = new RegExp(/\\w/i);\nexport function getHighlightFromSiblings(parts, i) {\n  var _parts, _parts2;\n  var current = parts[i];\n  var isNextHighlighted = ((_parts = parts[i + 1]) === null || _parts === void 0 ? void 0 : _parts.isHighlighted) || true;\n  var isPreviousHighlighted = ((_parts2 = parts[i - 1]) === null || _parts2 === void 0 ? void 0 : _parts2.isHighlighted) || true;\n  if (!hasAlphanumeric.test(unescape(current.value)) && isPreviousHighlighted === isNextHighlighted) {\n    return isPreviousHighlighted;\n  }\n  return current.isHighlighted;\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { getHighlightFromSiblings } from \"./getHighlightFromSiblings.js\";\nexport function reverseHighlightedParts(parts) {\n  if (!parts.some(function (part) {\n    return part.isHighlighted;\n  })) {\n    return parts.map(function (part) {\n      return _objectSpread(_objectSpread({}, part), {}, {\n        isHighlighted: false\n      });\n    });\n  }\n  return parts.map(function (part, i) {\n    return _objectSpread(_objectSpread({}, part), {}, {\n      isHighlighted: !getHighlightFromSiblings(parts, i)\n    });\n  });\n}","import { TAG_REPLACEMENT } from \"./escape-highlight.js\";\nexport function getHighlightedParts(highlightedValue) {\n  // @MAJOR: this should use TAG_PLACEHOLDER\n  var highlightPostTag = TAG_REPLACEMENT.highlightPostTag,\n    highlightPreTag = TAG_REPLACEMENT.highlightPreTag;\n  var splitByPreTag = highlightedValue.split(highlightPreTag);\n  var firstValue = splitByPreTag.shift();\n  var elements = !firstValue ? [] : [{\n    value: firstValue,\n    isHighlighted: false\n  }];\n  splitByPreTag.forEach(function (split) {\n    var splitByPostTag = split.split(highlightPostTag);\n    elements.push({\n      value: splitByPostTag[0],\n      isHighlighted: true\n    });\n    if (splitByPostTag[1] !== '') {\n      elements.push({\n        value: splitByPostTag[1],\n        isHighlighted: false\n      });\n    }\n  });\n  return elements;\n}","import { component } from \"../lib/suit.js\";\nimport { TAG_REPLACEMENT, getPropertyByPath, getHighlightedParts, reverseHighlightedParts, concatHighlightedParts, warning } from \"../lib/utils/index.js\";\nvar suit = component('ReverseHighlight');\n\n/**\n * @deprecated use html tagged templates and the ReverseHighlight component instead\n */\nexport default function reverseHighlight(_ref) {\n  var attribute = _ref.attribute,\n    _ref$highlightedTagNa = _ref.highlightedTagName,\n    highlightedTagName = _ref$highlightedTagNa === void 0 ? 'mark' : _ref$highlightedTagNa,\n    hit = _ref.hit,\n    _ref$cssClasses = _ref.cssClasses,\n    cssClasses = _ref$cssClasses === void 0 ? {} : _ref$cssClasses;\n  process.env.NODE_ENV === 'development' ? warning(false, \"`instantsearch.reverseHighlight` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `ReverseHighlight` component.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/building-search-ui/upgrade-guides/js/?client=html+tagged+templates#upgrade-templates\") : void 0;\n  var highlightAttributeResult = getPropertyByPath(hit._highlightResult, attribute);\n\n  // @MAJOR fallback to attribute value if highlight is not found\n  process.env.NODE_ENV === 'development' ? warning(highlightAttributeResult, \"Could not enable reverse highlight for \\\"\".concat(attribute, \"\\\", will display an empty string.\\nPlease check whether this attribute exists and is either searchable or specified in `attributesToHighlight`.\\n\\nSee: https://alg.li/highlighting\\n\")) : void 0;\n  var _ref2 = highlightAttributeResult || {},\n    _ref2$value = _ref2.value,\n    attributeValue = _ref2$value === void 0 ? '' : _ref2$value;\n\n  // cx is not used, since it would be bundled as a dependency for Vue & Angular\n  var className = suit({\n    descendantName: 'highlighted'\n  }) + (cssClasses.highlighted ? \" \".concat(cssClasses.highlighted) : '');\n  var reverseHighlightedValue = concatHighlightedParts(reverseHighlightedParts(getHighlightedParts(attributeValue)));\n  return reverseHighlightedValue.replace(new RegExp(TAG_REPLACEMENT.highlightPreTag, 'g'), \"<\".concat(highlightedTagName, \" class=\\\"\").concat(className, \"\\\">\")).replace(new RegExp(TAG_REPLACEMENT.highlightPostTag, 'g'), \"</\".concat(highlightedTagName, \">\"));\n}","import { component } from \"../lib/suit.js\";\nimport { TAG_REPLACEMENT, getPropertyByPath, warning } from \"../lib/utils/index.js\";\nvar suit = component('Snippet');\n\n/**\n * @deprecated use html tagged templates and the Snippet component instead\n */\nexport default function snippet(_ref) {\n  var attribute = _ref.attribute,\n    _ref$highlightedTagNa = _ref.highlightedTagName,\n    highlightedTagName = _ref$highlightedTagNa === void 0 ? 'mark' : _ref$highlightedTagNa,\n    hit = _ref.hit,\n    _ref$cssClasses = _ref.cssClasses,\n    cssClasses = _ref$cssClasses === void 0 ? {} : _ref$cssClasses;\n  process.env.NODE_ENV === 'development' ? warning(false, \"`instantsearch.snippet` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `Snippet` component.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/building-search-ui/upgrade-guides/js/?client=html+tagged+templates#upgrade-templates\") : void 0;\n  var snippetAttributeResult = getPropertyByPath(hit._snippetResult, attribute);\n\n  // @MAJOR fallback to attribute value if snippet is not found\n  process.env.NODE_ENV === 'development' ? warning(snippetAttributeResult, \"Could not enable snippet for \\\"\".concat(attribute, \"\\\", will display an empty string.\\nPlease check whether this attribute exists and is specified in `attributesToSnippet`.\\n\\nSee: https://alg.li/highlighting\\n\")) : void 0;\n  var _ref2 = snippetAttributeResult || {},\n    _ref2$value = _ref2.value,\n    attributeValue = _ref2$value === void 0 ? '' : _ref2$value;\n\n  // cx is not used, since it would be bundled as a dependency for Vue & Angular\n  var className = suit({\n    descendantName: 'highlighted'\n  }) + (cssClasses.highlighted ? \" \".concat(cssClasses.highlighted) : '');\n  return attributeValue.replace(new RegExp(TAG_REPLACEMENT.highlightPreTag, 'g'), \"<\".concat(highlightedTagName, \" class=\\\"\").concat(className, \"\\\">\")).replace(new RegExp(TAG_REPLACEMENT.highlightPostTag, 'g'), \"</\".concat(highlightedTagName, \">\"));\n}","import { component } from \"../lib/suit.js\";\nimport { TAG_REPLACEMENT, getPropertyByPath, getHighlightedParts, reverseHighlightedParts, concatHighlightedParts, warning } from \"../lib/utils/index.js\";\nvar suit = component('ReverseSnippet');\n\n/**\n * @deprecated use html tagged templates and the ReverseSnippet component instead\n */\nexport default function reverseSnippet(_ref) {\n  var attribute = _ref.attribute,\n    _ref$highlightedTagNa = _ref.highlightedTagName,\n    highlightedTagName = _ref$highlightedTagNa === void 0 ? 'mark' : _ref$highlightedTagNa,\n    hit = _ref.hit,\n    _ref$cssClasses = _ref.cssClasses,\n    cssClasses = _ref$cssClasses === void 0 ? {} : _ref$cssClasses;\n  process.env.NODE_ENV === 'development' ? warning(false, \"`instantsearch.reverseSnippet` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `ReverseSnippet` component.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/building-search-ui/upgrade-guides/js/?client=html+tagged+templates#upgrade-templates\") : void 0;\n  var snippetAttributeResult = getPropertyByPath(hit._snippetResult, attribute);\n\n  // @MAJOR fallback to attribute value if snippet is not found\n  process.env.NODE_ENV === 'development' ? warning(snippetAttributeResult, \"Could not enable reverse snippet for \\\"\".concat(attribute, \"\\\", will display an empty string.\\nPlease check whether this attribute exists and is specified in `attributesToSnippet`.\\n\\nSee: https://alg.li/highlighting\\n\")) : void 0;\n  var _ref2 = snippetAttributeResult || {},\n    _ref2$value = _ref2.value,\n    attributeValue = _ref2$value === void 0 ? '' : _ref2$value;\n\n  // cx is not used, since it would be bundled as a dependency for Vue & Angular\n  var className = suit({\n    descendantName: 'highlighted'\n  }) + (cssClasses.highlighted ? \" \".concat(cssClasses.highlighted) : '');\n  var reverseHighlightedValue = concatHighlightedParts(reverseHighlightedParts(getHighlightedParts(attributeValue)));\n  return reverseHighlightedValue.replace(new RegExp(TAG_REPLACEMENT.highlightPreTag, 'g'), \"<\".concat(highlightedTagName, \" class=\\\"\").concat(className, \"\\\">\")).replace(new RegExp(TAG_REPLACEMENT.highlightPostTag, 'g'), \"</\".concat(highlightedTagName, \">\"));\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nimport { warning, serializePayload, deserializePayload } from \"../lib/utils/index.js\";\n/** @deprecated use bindEvent instead */\nexport function readDataAttributes(domElement) {\n  var method = domElement.getAttribute('data-insights-method');\n  var serializedPayload = domElement.getAttribute('data-insights-payload');\n  if (typeof serializedPayload !== 'string') {\n    throw new Error('The insights helper expects `data-insights-payload` to be a base64-encoded JSON string.');\n  }\n  try {\n    var payload = deserializePayload(serializedPayload);\n    return {\n      method: method,\n      payload: payload\n    };\n  } catch (error) {\n    throw new Error('The insights helper was unable to parse `data-insights-payload`.');\n  }\n}\n\n/** @deprecated use bindEvent instead */\nexport function writeDataAttributes(_ref) {\n  var method = _ref.method,\n    payload = _ref.payload;\n  if (_typeof(payload) !== 'object') {\n    throw new Error(\"The insights helper expects the payload to be an object.\");\n  }\n  var serializedPayload;\n  try {\n    serializedPayload = serializePayload(payload);\n  } catch (error) {\n    throw new Error(\"Could not JSON serialize the payload object.\");\n  }\n  return \"data-insights-method=\\\"\".concat(method, \"\\\" data-insights-payload=\\\"\").concat(serializedPayload, \"\\\"\");\n}\n\n/**\n * @deprecated This function will be still supported in 4.x releases, but not further. It is replaced by the `insights` middleware. For more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\n */\nexport default function insights(method, payload) {\n  process.env.NODE_ENV === 'development' ? warning(false, \"`insights` function has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `insights` middleware.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\") : void 0;\n  return writeDataAttributes({\n    method: method,\n    payload: payload\n  });\n}","export function serializePayload(payload) {\n  return btoa(encodeURIComponent(JSON.stringify(payload)));\n}\nexport function deserializePayload(serialized) {\n  return JSON.parse(decodeURIComponent(atob(serialized)));\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { highlight as _highlight, reverseHighlight as _reverseHighlight, snippet as _snippet, reverseSnippet as _reverseSnippet, insights as _insights } from \"../helpers/index.js\";\nimport { formatNumber as _formatNumber } from \"./formatNumber.js\";\nexport default function hoganHelpers(_ref) {\n  var numberLocale = _ref.numberLocale;\n  return {\n    formatNumber: function formatNumber(value, render) {\n      return _formatNumber(Number(render(value)), numberLocale);\n    },\n    highlight: function highlight(options, render) {\n      try {\n        var highlightOptions = JSON.parse(options);\n        return render(_highlight(_objectSpread(_objectSpread({}, highlightOptions), {}, {\n          hit: this\n        })));\n      } catch (error) {\n        throw new Error(\"\\nThe highlight helper expects a JSON object of the format:\\n{ \\\"attribute\\\": \\\"name\\\", \\\"highlightedTagName\\\": \\\"mark\\\" }\");\n      }\n    },\n    reverseHighlight: function reverseHighlight(options, render) {\n      try {\n        var reverseHighlightOptions = JSON.parse(options);\n        return render(_reverseHighlight(_objectSpread(_objectSpread({}, reverseHighlightOptions), {}, {\n          hit: this\n        })));\n      } catch (error) {\n        throw new Error(\"\\n  The reverseHighlight helper expects a JSON object of the format:\\n  { \\\"attribute\\\": \\\"name\\\", \\\"highlightedTagName\\\": \\\"mark\\\" }\");\n      }\n    },\n    snippet: function snippet(options, render) {\n      try {\n        var snippetOptions = JSON.parse(options);\n        return render(_snippet(_objectSpread(_objectSpread({}, snippetOptions), {}, {\n          hit: this\n        })));\n      } catch (error) {\n        throw new Error(\"\\nThe snippet helper expects a JSON object of the format:\\n{ \\\"attribute\\\": \\\"name\\\", \\\"highlightedTagName\\\": \\\"mark\\\" }\");\n      }\n    },\n    reverseSnippet: function reverseSnippet(options, render) {\n      try {\n        var reverseSnippetOptions = JSON.parse(options);\n        return render(_reverseSnippet(_objectSpread(_objectSpread({}, reverseSnippetOptions), {}, {\n          hit: this\n        })));\n      } catch (error) {\n        throw new Error(\"\\n  The reverseSnippet helper expects a JSON object of the format:\\n  { \\\"attribute\\\": \\\"name\\\", \\\"highlightedTagName\\\": \\\"mark\\\" }\");\n      }\n    },\n    insights: function insights(options, render) {\n      try {\n        var _JSON$parse = JSON.parse(options),\n          method = _JSON$parse.method,\n          payload = _JSON$parse.payload;\n        return render(_insights(method, _objectSpread({\n          objectIDs: [this.objectID]\n        }, payload)));\n      } catch (error) {\n        throw new Error(\"\\nThe insights helper expects a JSON object of the format:\\n{ \\\"method\\\": \\\"method-name\\\", \\\"payload\\\": { \\\"eventName\\\": \\\"name of the event\\\" } }\");\n      }\n    }\n  };\n}","export function formatNumber(value, numberLocale) {\n  return value.toLocaleString(numberLocale);\n}","var nextMicroTask = Promise.resolve();\nexport function defer(callback) {\n  var progress = null;\n  var cancelled = false;\n  var fn = function fn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    if (progress !== null) {\n      return;\n    }\n    progress = nextMicroTask.then(function () {\n      progress = null;\n      if (cancelled) {\n        cancelled = false;\n        return;\n      }\n      callback.apply(void 0, args);\n    });\n  };\n  fn.wait = function () {\n    if (progress === null) {\n      throw new Error('The deferred function should be called before calling `wait()`');\n    }\n    return progress;\n  };\n  fn.cancel = function () {\n    if (progress === null) {\n      return;\n    }\n    cancelled = true;\n  };\n  return fn;\n}","import { checkIndexUiState } from \"./checkIndexUiState.js\";\nimport { isIndexWidget } from \"./isIndexWidget.js\";\nexport function setIndexHelperState(finalUiState, indexWidget) {\n  var nextIndexUiState = finalUiState[indexWidget.getIndexId()] || {};\n  if (process.env.NODE_ENV === 'development') {\n    checkIndexUiState({\n      index: indexWidget,\n      indexUiState: nextIndexUiState\n    });\n  }\n  indexWidget.getHelper().setState(indexWidget.getWidgetSearchParameters(indexWidget.getHelper().state, {\n    uiState: nextIndexUiState\n  }));\n  indexWidget.getWidgets().filter(isIndexWidget).forEach(function (widget) {\n    return setIndexHelperState(finalUiState, widget);\n  });\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport EventEmitter from '@algolia/events';\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { createInsightsMiddleware } from \"../middlewares/createInsightsMiddleware.js\";\nimport { createMetadataMiddleware, isMetadataEnabled } from \"../middlewares/createMetadataMiddleware.js\";\nimport { createRouterMiddleware } from \"../middlewares/createRouterMiddleware.js\";\nimport index from \"../widgets/index/index.js\";\nimport createHelpers from \"./createHelpers.js\";\nimport { createDocumentationMessageGenerator, createDocumentationLink, defer, noop, warning, setIndexHelperState, isIndexWidget } from \"./utils/index.js\";\nimport version from \"./version.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'instantsearch'\n});\nfunction defaultCreateURL() {\n  return '#';\n}\n\n// this purposely breaks typescript's type inference to ensure it's not used\n// as it's used for a default parameter for example\n// source: https://github.com/Microsoft/TypeScript/issues/14829#issuecomment-504042546\n/**\n * Global options for an InstantSearch instance.\n */\n/**\n * The actual implementation of the InstantSearch. This is\n * created using the `instantsearch` factory function.\n * It emits the 'render' event every time a search is done\n */\nvar InstantSearch = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(InstantSearch, _EventEmitter);\n  var _super = _createSuper(InstantSearch);\n  function InstantSearch(options) {\n    var _this;\n    _classCallCheck(this, InstantSearch);\n    _this = _super.call(this);\n\n    // prevent `render` event listening from causing a warning\n    _defineProperty(_assertThisInitialized(_this), \"client\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"indexName\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"insightsClient\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"onStateChange\", null);\n    _defineProperty(_assertThisInitialized(_this), \"helper\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"mainHelper\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"mainIndex\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"started\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"templatesConfig\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"renderState\", {});\n    _defineProperty(_assertThisInitialized(_this), \"_stalledSearchDelay\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_searchStalledTimer\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_initialUiState\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_initialResults\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_createURL\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_searchFunction\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_mainHelperSearch\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"middleware\", []);\n    _defineProperty(_assertThisInitialized(_this), \"sendEventToInsights\", void 0);\n    /**\n     * The status of the search. Can be \"idle\", \"loading\", \"stalled\", or \"error\".\n     */\n    _defineProperty(_assertThisInitialized(_this), \"status\", 'idle');\n    /**\n     * The last returned error from the Search API.\n     * The error gets cleared when the next valid search response is rendered.\n     */\n    _defineProperty(_assertThisInitialized(_this), \"error\", undefined);\n    _defineProperty(_assertThisInitialized(_this), \"scheduleSearch\", defer(function () {\n      if (_this.started) {\n        _this.mainHelper.search();\n      }\n    }));\n    _defineProperty(_assertThisInitialized(_this), \"scheduleRender\", defer(function () {\n      var _this$mainHelper;\n      var shouldResetStatus = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      if (!((_this$mainHelper = _this.mainHelper) !== null && _this$mainHelper !== void 0 && _this$mainHelper.hasPendingRequests())) {\n        clearTimeout(_this._searchStalledTimer);\n        _this._searchStalledTimer = null;\n        if (shouldResetStatus) {\n          _this.status = 'idle';\n          _this.error = undefined;\n        }\n      }\n      _this.mainIndex.render({\n        instantSearchInstance: _assertThisInitialized(_this)\n      });\n      _this.emit('render');\n    }));\n    _defineProperty(_assertThisInitialized(_this), \"onInternalStateChange\", defer(function () {\n      var nextUiState = _this.mainIndex.getWidgetUiState({});\n      _this.middleware.forEach(function (_ref) {\n        var instance = _ref.instance;\n        instance.onStateChange({\n          uiState: nextUiState\n        });\n      });\n    }));\n    _this.setMaxListeners(100);\n    var _options$indexName = options.indexName,\n      indexName = _options$indexName === void 0 ? '' : _options$indexName,\n      numberLocale = options.numberLocale,\n      _options$initialUiSta = options.initialUiState,\n      initialUiState = _options$initialUiSta === void 0 ? {} : _options$initialUiSta,\n      _options$routing = options.routing,\n      routing = _options$routing === void 0 ? null : _options$routing,\n      _options$insights = options.insights,\n      insights = _options$insights === void 0 ? false : _options$insights,\n      searchFunction = options.searchFunction,\n      _options$stalledSearc = options.stalledSearchDelay,\n      stalledSearchDelay = _options$stalledSearc === void 0 ? 200 : _options$stalledSearc,\n      _options$searchClient = options.searchClient,\n      searchClient = _options$searchClient === void 0 ? null : _options$searchClient,\n      _options$insightsClie = options.insightsClient,\n      insightsClient = _options$insightsClie === void 0 ? null : _options$insightsClie,\n      _options$onStateChang = options.onStateChange,\n      onStateChange = _options$onStateChang === void 0 ? null : _options$onStateChang;\n    if (searchClient === null) {\n      throw new Error(withUsage('The `searchClient` option is required.'));\n    }\n    if (typeof searchClient.search !== 'function') {\n      throw new Error(\"The `searchClient` must implement a `search` method.\\n\\nSee: https://www.algolia.com/doc/guides/building-search-ui/going-further/backend-search/in-depth/backend-instantsearch/js/\");\n    }\n    if (typeof searchClient.addAlgoliaAgent === 'function') {\n      searchClient.addAlgoliaAgent(\"instantsearch.js (\".concat(version, \")\"));\n    }\n    process.env.NODE_ENV === 'development' ? warning(insightsClient === null, \"`insightsClient` property has been deprecated. It is still supported in 4.x releases, but not further. It is replaced by the `insights` middleware.\\n\\nFor more information, visit https://www.algolia.com/doc/guides/getting-insights-and-analytics/search-analytics/click-through-and-conversions/how-to/send-click-and-conversion-events-with-instantsearch/js/\") : void 0;\n    if (insightsClient && typeof insightsClient !== 'function') {\n      throw new Error(withUsage('The `insightsClient` option should be a function.'));\n    }\n    process.env.NODE_ENV === 'development' ? warning(!options.searchParameters, \"The `searchParameters` option is deprecated and will not be supported in InstantSearch.js 4.x.\\n\\nYou can replace it with the `configure` widget:\\n\\n```\\nsearch.addWidgets([\\n  configure(\".concat(JSON.stringify(options.searchParameters, null, 2), \")\\n]);\\n```\\n\\nSee \").concat(createDocumentationLink({\n      name: 'configure'\n    }))) : void 0;\n    _this.client = searchClient;\n    _this.insightsClient = insightsClient;\n    _this.indexName = indexName;\n    _this.helper = null;\n    _this.mainHelper = null;\n    _this.mainIndex = index({\n      indexName: indexName\n    });\n    _this.onStateChange = onStateChange;\n    _this.started = false;\n    _this.templatesConfig = {\n      helpers: createHelpers({\n        numberLocale: numberLocale\n      }),\n      compileOptions: {}\n    };\n    _this._stalledSearchDelay = stalledSearchDelay;\n    _this._searchStalledTimer = null;\n    _this._createURL = defaultCreateURL;\n    _this._initialUiState = initialUiState;\n    _this._initialResults = null;\n    if (searchFunction) {\n      process.env.NODE_ENV === 'development' ? warning(false, \"The `searchFunction` option is deprecated. Use `onStateChange` instead.\") : void 0;\n      _this._searchFunction = searchFunction;\n    }\n    _this.sendEventToInsights = noop;\n    if (routing) {\n      var routerOptions = typeof routing === 'boolean' ? {} : routing;\n      routerOptions.$$internal = true;\n      _this.use(createRouterMiddleware(routerOptions));\n    }\n\n    // This is the default middleware,\n    // any user-provided middleware will be added later and override this one.\n    if (insights) {\n      var insightsOptions = typeof insights === 'boolean' ? {} : insights;\n      insightsOptions.$$internal = true;\n      _this.use(createInsightsMiddleware(insightsOptions));\n    }\n    if (isMetadataEnabled()) {\n      _this.use(createMetadataMiddleware({\n        $$internal: true\n      }));\n    }\n    return _this;\n  }\n\n  /**\n   * Hooks a middleware into the InstantSearch lifecycle.\n   */\n  _createClass(InstantSearch, [{\n    key: \"_isSearchStalled\",\n    get:\n    /**\n     * @deprecated use `status === 'stalled'` instead\n     */\n    function get() {\n      process.env.NODE_ENV === 'development' ? warning(false, \"`InstantSearch._isSearchStalled` is deprecated and will be removed in InstantSearch.js 5.0.\\n\\nUse `InstantSearch.status === \\\"stalled\\\"` instead.\") : void 0;\n      return this.status === 'stalled';\n    }\n  }, {\n    key: \"use\",\n    value: function use() {\n      var _this2 = this;\n      for (var _len = arguments.length, middleware = new Array(_len), _key = 0; _key < _len; _key++) {\n        middleware[_key] = arguments[_key];\n      }\n      var newMiddlewareList = middleware.map(function (fn) {\n        var newMiddleware = _objectSpread({\n          $$type: '__unknown__',\n          $$internal: false,\n          subscribe: noop,\n          started: noop,\n          unsubscribe: noop,\n          onStateChange: noop\n        }, fn({\n          instantSearchInstance: _this2\n        }));\n        _this2.middleware.push({\n          creator: fn,\n          instance: newMiddleware\n        });\n        return newMiddleware;\n      });\n\n      // If the instance has already started, we directly subscribe the\n      // middleware so they're notified of changes.\n      if (this.started) {\n        newMiddlewareList.forEach(function (m) {\n          m.subscribe();\n          m.started();\n        });\n      }\n      return this;\n    }\n\n    /**\n     * Removes a middleware from the InstantSearch lifecycle.\n     */\n  }, {\n    key: \"unuse\",\n    value: function unuse() {\n      for (var _len2 = arguments.length, middlewareToUnuse = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        middlewareToUnuse[_key2] = arguments[_key2];\n      }\n      this.middleware.filter(function (m) {\n        return middlewareToUnuse.includes(m.creator);\n      }).forEach(function (m) {\n        return m.instance.unsubscribe();\n      });\n      this.middleware = this.middleware.filter(function (m) {\n        return !middlewareToUnuse.includes(m.creator);\n      });\n      return this;\n    }\n\n    // @major we shipped with EXPERIMENTAL_use, but have changed that to just `use` now\n  }, {\n    key: \"EXPERIMENTAL_use\",\n    value: function EXPERIMENTAL_use() {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The middleware API is now considered stable, so we recommend replacing `EXPERIMENTAL_use` with `use` before upgrading to the next major version.') : void 0;\n      return this.use.apply(this, arguments);\n    }\n\n    /**\n     * Adds a widget to the search instance.\n     * A widget can be added either before or after InstantSearch has started.\n     * @param widget The widget to add to InstantSearch.\n     *\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`.\n     */\n  }, {\n    key: \"addWidget\",\n    value: function addWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'addWidget will still be supported in 4.x releases, but not further. It is replaced by `addWidgets([widget])`') : void 0;\n      return this.addWidgets([widget]);\n    }\n\n    /**\n     * Adds multiple widgets to the search instance.\n     * Widgets can be added either before or after InstantSearch has started.\n     * @param widgets The array of widgets to add to InstantSearch.\n     */\n  }, {\n    key: \"addWidgets\",\n    value: function addWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets. Please use `addWidget`.'));\n      }\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n      this.mainIndex.addWidgets(widgets);\n      return this;\n    }\n\n    /**\n     * Removes a widget from the search instance.\n     * @deprecated This method will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`\n     * @param widget The widget instance to remove from InstantSearch.\n     *\n     * The widget must implement a `dispose()` method to clear its state.\n     */\n  }, {\n    key: \"removeWidget\",\n    value: function removeWidget(widget) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'removeWidget will still be supported in 4.x releases, but not further. It is replaced by `removeWidgets([widget])`') : void 0;\n      return this.removeWidgets([widget]);\n    }\n\n    /**\n     * Removes multiple widgets from the search instance.\n     * @param widgets Array of widgets instances to remove from InstantSearch.\n     *\n     * The widgets must implement a `dispose()` method to clear their states.\n     */\n  }, {\n    key: \"removeWidgets\",\n    value: function removeWidgets(widgets) {\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets. Please use `removeWidget`.'));\n      }\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n      this.mainIndex.removeWidgets(widgets);\n      return this;\n    }\n\n    /**\n     * Ends the initialization of InstantSearch.js and triggers the\n     * first search. This method should be called after all widgets have been added\n     * to the instance of InstantSearch.js. InstantSearch.js also supports adding and removing\n     * widgets after the start as an **EXPERIMENTAL** feature.\n     */\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this3 = this;\n      if (this.started) {\n        throw new Error(withUsage('The `start` method has already been called once.'));\n      }\n\n      // This Helper is used for the queries, we don't care about its state. The\n      // states are managed at the `index` level. We use this Helper to create\n      // DerivedHelper scoped into the `index` widgets.\n      // In Vue InstantSearch' hydrate, a main helper gets set before start, so\n      // we need to respect this helper as a way to keep all listeners correct.\n      var mainHelper = this.mainHelper || algoliasearchHelper(this.client, this.indexName);\n      mainHelper.search = function () {\n        _this3.status = 'loading';\n        _this3.scheduleRender(false);\n        process.env.NODE_ENV === 'development' ? warning(Boolean(_this3.indexName) || _this3.mainIndex.getWidgets().some(isIndexWidget), 'No indexName provided, nor an explicit index widget in the widgets tree. This is required to be able to display results.') : void 0;\n\n        // This solution allows us to keep the exact same API for the users but\n        // under the hood, we have a different implementation. It should be\n        // completely transparent for the rest of the codebase. Only this module\n        // is impacted.\n        return mainHelper.searchOnlyWithDerivedHelpers();\n      };\n      if (this._searchFunction) {\n        // this client isn't used to actually search, but required for the helper\n        // to not throw errors\n        var fakeClient = {\n          search: function search() {\n            return new Promise(noop);\n          }\n        };\n        this._mainHelperSearch = mainHelper.search.bind(mainHelper);\n        mainHelper.search = function () {\n          var mainIndexHelper = _this3.mainIndex.getHelper();\n          var searchFunctionHelper = algoliasearchHelper(fakeClient, mainIndexHelper.state.index, mainIndexHelper.state);\n          searchFunctionHelper.once('search', function (_ref2) {\n            var state = _ref2.state;\n            mainIndexHelper.overrideStateWithoutTriggeringChangeEvent(state);\n            _this3._mainHelperSearch();\n          });\n          // Forward state changes from `searchFunctionHelper` to `mainIndexHelper`\n          searchFunctionHelper.on('change', function (_ref3) {\n            var state = _ref3.state;\n            mainIndexHelper.setState(state);\n          });\n          _this3._searchFunction(searchFunctionHelper);\n          return mainHelper;\n        };\n      }\n\n      // Only the \"main\" Helper emits the `error` event vs the one for `search`\n      // and `results` that are also emitted on the derived one.\n      mainHelper.on('error', function (_ref4) {\n        var error = _ref4.error;\n        if (!(error instanceof Error)) {\n          // typescript lies here, error is in some cases { name: string, message: string }\n          var err = error;\n          error = Object.keys(err).reduce(function (acc, key) {\n            acc[key] = err[key];\n            return acc;\n          }, new Error(err.message));\n        }\n        // If an error is emitted, it is re-thrown by events. In previous versions\n        // we emitted {error}, which is thrown as:\n        // \"Uncaught, unspecified \\\"error\\\" event. ([object Object])\"\n        // To avoid breaking changes, we make the error available in both\n        // `error` and `error.error`\n        // @MAJOR emit only error\n        error.error = error;\n        _this3.error = error;\n        _this3.status = 'error';\n        _this3.scheduleRender(false);\n\n        // This needs to execute last because it throws the error.\n        _this3.emit('error', error);\n      });\n      this.mainHelper = mainHelper;\n      this.middleware.forEach(function (_ref5) {\n        var instance = _ref5.instance;\n        instance.subscribe();\n      });\n      this.mainIndex.init({\n        instantSearchInstance: this,\n        parent: null,\n        uiState: this._initialUiState\n      });\n      if (this._initialResults) {\n        var originalScheduleSearch = this.scheduleSearch;\n        // We don't schedule a first search when initial results are provided\n        // because we already have the results to render. This skips the initial\n        // network request on the browser on `start`.\n        this.scheduleSearch = defer(noop);\n        // We also skip the initial network request when widgets are dynamically\n        // added in the first tick (that's the case in all the framework-based flavors).\n        // When we add a widget to `index`, it calls `scheduleSearch`. We can rely\n        // on our `defer` util to restore the original `scheduleSearch` value once\n        // widgets are added to hook back to the regular lifecycle.\n        defer(function () {\n          _this3.scheduleSearch = originalScheduleSearch;\n        })();\n      }\n      // We only schedule a search when widgets have been added before `start()`\n      // because there are listeners that can use these results.\n      // This is especially useful in framework-based flavors that wait for\n      // dynamically-added widgets to trigger a network request. It avoids\n      // having to batch this initial network request with the one coming from\n      // `addWidgets()`.\n      // Later, we could also skip `index()` widgets and widgets that don't read\n      // the results, but this is an optimization that has a very low impact for now.\n      else if (this.mainIndex.getWidgets().length > 0) {\n        this.scheduleSearch();\n      }\n\n      // Keep the previous reference for legacy purpose, some pattern use\n      // the direct Helper access `search.helper` (e.g multi-index).\n      this.helper = this.mainIndex.getHelper();\n\n      // track we started the search if we add more widgets,\n      // to init them directly after add\n      this.started = true;\n      this.middleware.forEach(function (_ref6) {\n        var instance = _ref6.instance;\n        instance.started();\n      });\n    }\n\n    /**\n     * Removes all widgets without triggering a search afterwards. This is an **EXPERIMENTAL** feature,\n     * if you find an issue with it, please\n     * [open an issue](https://github.com/algolia/instantsearch/issues/new?title=Problem%20with%20dispose).\n     * @return {undefined} This method does not return anything\n     */\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      var _this$mainHelper2;\n      this.scheduleSearch.cancel();\n      this.scheduleRender.cancel();\n      clearTimeout(this._searchStalledTimer);\n      this.removeWidgets(this.mainIndex.getWidgets());\n      this.mainIndex.dispose();\n\n      // You can not start an instance two times, therefore a disposed instance\n      // needs to set started as false otherwise this can not be restarted at a\n      // later point.\n      this.started = false;\n\n      // The helper needs to be reset to perform the next search from a fresh state.\n      // If not reset, it would use the state stored before calling `dispose()`.\n      this.removeAllListeners();\n      (_this$mainHelper2 = this.mainHelper) === null || _this$mainHelper2 === void 0 ? void 0 : _this$mainHelper2.removeAllListeners();\n      this.mainHelper = null;\n      this.helper = null;\n      this.middleware.forEach(function (_ref7) {\n        var instance = _ref7.instance;\n        instance.unsubscribe();\n      });\n    }\n  }, {\n    key: \"scheduleStalledRender\",\n    value: function scheduleStalledRender() {\n      var _this4 = this;\n      if (!this._searchStalledTimer) {\n        this._searchStalledTimer = setTimeout(function () {\n          _this4.status = 'stalled';\n          _this4.scheduleRender();\n        }, this._stalledSearchDelay);\n      }\n    }\n\n    /**\n     * Set the UI state and trigger a search.\n     * @param uiState The next UI state or a function computing it from the current state\n     * @param callOnStateChange private parameter used to know if the method is called from a state change\n     */\n  }, {\n    key: \"setUiState\",\n    value: function setUiState(uiState) {\n      var _this5 = this;\n      var callOnStateChange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `setUiState`.'));\n      }\n\n      // We refresh the index UI state to update the local UI state that the\n      // main index passes to the function form of `setUiState`.\n      this.mainIndex.refreshUiState();\n      var nextUiState = typeof uiState === 'function' ? uiState(this.mainIndex.getWidgetUiState({})) : uiState;\n      if (this.onStateChange && callOnStateChange) {\n        this.onStateChange({\n          uiState: nextUiState,\n          setUiState: function setUiState(finalUiState) {\n            setIndexHelperState(typeof finalUiState === 'function' ? finalUiState(nextUiState) : finalUiState, _this5.mainIndex);\n            _this5.scheduleSearch();\n            _this5.onInternalStateChange();\n          }\n        });\n      } else {\n        setIndexHelperState(nextUiState, this.mainIndex);\n        this.scheduleSearch();\n        this.onInternalStateChange();\n      }\n    }\n  }, {\n    key: \"getUiState\",\n    value: function getUiState() {\n      if (this.started) {\n        // We refresh the index UI state to make sure changes from `refine` are taken in account\n        this.mainIndex.refreshUiState();\n      }\n      return this.mainIndex.getWidgetUiState({});\n    }\n  }, {\n    key: \"createURL\",\n    value: function createURL() {\n      var nextState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!this.started) {\n        throw new Error(withUsage('The `start` method needs to be called before `createURL`.'));\n      }\n      return this._createURL(nextState);\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      if (!this.mainHelper) {\n        throw new Error(withUsage('The `start` method needs to be called before `refresh`.'));\n      }\n      this.mainHelper.clearCache().search();\n    }\n  }]);\n  return InstantSearch;\n}(EventEmitter);\nexport default InstantSearch;","export default '4.56.11';","// typed as any, since it accepts the _real_ js clients, not the interface we otherwise expect\nexport function getAppIdAndApiKey(searchClient) {\n  if (searchClient.transporter) {\n    // searchClient v4\n    var _searchClient$transpo = searchClient.transporter,\n      headers = _searchClient$transpo.headers,\n      queryParameters = _searchClient$transpo.queryParameters;\n    var APP_ID = 'x-algolia-application-id';\n    var API_KEY = 'x-algolia-api-key';\n    var appId = headers[APP_ID] || queryParameters[APP_ID];\n    var apiKey = headers[API_KEY] || queryParameters[API_KEY];\n    return [appId, apiKey];\n  } else {\n    // searchClient v3\n    return [searchClient.applicationID, searchClient.apiKey];\n  }\n}","// We aren't using the native `Array.prototype.find` because the refactor away from Lodash is not\n// published as a major version.\n// Relying on the `find` polyfill on user-land, which before was only required for niche use-cases,\n// was decided as too risky.\n// @MAJOR Replace with the native `Array.prototype.find` method\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\nexport function find(items, predicate) {\n  var value;\n  for (var i = 0; i < items.length; i++) {\n    value = items[i];\n    // inlined for performance: if (Call(predicate, thisArg, [value, i, list])) {\n    if (predicate(value, i, items)) {\n      return value;\n    }\n  }\n  return undefined;\n}","import { createContext } from 'react';\nexport var InstantSearchServerContext = /*#__PURE__*/createContext(null);\nif (process.env.NODE_ENV === 'development') {\n  InstantSearchServerContext.displayName = 'InstantSearchServer';\n}","import { useContext } from 'react';\nimport { InstantSearchServerContext } from \"../components/InstantSearchServerContext.js\";\nexport function useInstantSearchServerContext() {\n  return useContext(InstantSearchServerContext);\n}","import { createContext } from 'react';\nexport var InstantSearchSSRContext = /*#__PURE__*/createContext(null);\nif (process.env.NODE_ENV === 'development') {\n  InstantSearchSSRContext.displayName = 'InstantSearchSSR';\n}","export default '7.0.3';","function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { useReducer } from 'react';\n\n/**\n * Forces a React update that triggers a rerender.\n * @link https://reactjs.org/docs/hooks-faq.html#is-there-something-like-forceupdate\n */\nexport function useForceUpdate() {\n  var _useReducer = useReducer(function (x) {\n      return x + 1;\n    }, 0),\n    _useReducer2 = _slicedToArray(_useReducer, 2),\n    forceUpdate = _useReducer2[1];\n  return forceUpdate;\n}","import InstantSearch from \"instantsearch.js/es/lib/InstantSearch.js\";\nimport { useCallback, useRef, version as ReactVersion } from 'react';\nimport { useSyncExternalStore } from \"use-sync-external-store/shim/index.js\";\nimport { useInstantSearchServerContext } from \"./useInstantSearchServerContext.js\";\nimport { useInstantSearchSSRContext } from \"./useInstantSearchSSRContext.js\";\nimport version from \"../version.js\";\nimport { useForceUpdate } from \"./useForceUpdate.js\";\nimport { warn } from \"./warn.js\";\nvar defaultUserAgents = [\"react (\".concat(ReactVersion, \")\"), \"react-instantsearch (\".concat(version, \")\"), \"react-instantsearch-core (\".concat(version, \")\")];\nvar serverUserAgent = \"react-instantsearch-server (\".concat(version, \")\");\nvar nextUserAgent = function nextUserAgent(nextVersion) {\n  return nextVersion ? \"next.js (\".concat(nextVersion, \")\") : null;\n};\nexport function useInstantSearchApi(props) {\n  var forceUpdate = useForceUpdate();\n  var serverContext = useInstantSearchServerContext();\n  var serverState = useInstantSearchSSRContext();\n  var initialResults = serverState === null || serverState === void 0 ? void 0 : serverState.initialResults;\n  var prevPropsRef = useRef(props);\n  var searchRef = useRef(null);\n  // As we need to render on mount with SSR, using the local ref above in `StrictMode` will\n  // create and start two instances of InstantSearch. To avoid this, we instead discard it and use\n  // an upward ref from `InstantSearchSSRContext` as it has already been mounted a second time at this point.\n  if (serverState) {\n    searchRef = serverState.ssrSearchRef;\n  }\n  if (searchRef.current === null) {\n    // We don't use the `instantsearch()` function because it comes with other\n    // top-level APIs that we don't need.\n    // See https://github.com/algolia/instantsearch/blob/5b529f43d8acc680f85837eaaa41f7fd03a3f833/src/index.es.ts#L63-L86\n    var search = new InstantSearch(props);\n    search._schedule = function _schedule(cb) {\n      search._schedule.queue.push(cb);\n      clearTimeout(search._schedule.timer);\n      search._schedule.timer = setTimeout(function () {\n        search._schedule.queue.forEach(function (callback) {\n          callback();\n        });\n        search._schedule.queue = [];\n      }, 0);\n    };\n    search._schedule.queue = [];\n    if (serverContext || initialResults) {\n      // InstantSearch.js has a private Initial Results API that lets us inject\n      // results on the search instance.\n      // On the server, we default the initial results to an empty object so that\n      // InstantSearch.js doesn't schedule a search that isn't used, leading to\n      // an additional network request. (This is equivalent to monkey-patching\n      // `scheduleSearch` to a noop.)\n      search._initialResults = initialResults || {};\n    }\n    addAlgoliaAgents(props.searchClient, [].concat(defaultUserAgents, [serverContext && serverUserAgent, nextUserAgent(getNextVersion())]));\n\n    // On the server, we start the search early to compute the search parameters.\n    // On SSR, we start the search early to directly catch up with the lifecycle\n    // and render.\n    if (serverContext || initialResults) {\n      search.start();\n    }\n    if (serverContext) {\n      // We notify `getServerState()` of the InstantSearch internals to retrieve\n      // the server state and pass it to the render on SSR.\n      serverContext.notifyServer({\n        search: search\n      });\n    }\n    warnNextRouter(props.routing);\n    searchRef.current = search;\n  }\n  {\n    var _search = searchRef.current;\n    var prevProps = prevPropsRef.current;\n    if (prevProps.indexName !== props.indexName) {\n      _search.helper.setIndex(props.indexName || '').search();\n      prevPropsRef.current = props;\n    }\n    if (prevProps.searchClient !== props.searchClient) {\n      process.env.NODE_ENV === 'development' ? warn(false, 'The `searchClient` prop of `<InstantSearch>` changed between renders, which may cause more search requests than necessary. If this is an unwanted behavior, please provide a stable reference: https://www.algolia.com/doc/api-reference/widgets/instantsearch/react/#widget-param-searchclient') : void 0;\n      addAlgoliaAgents(props.searchClient, [].concat(defaultUserAgents, [serverContext && serverUserAgent]));\n      _search.mainHelper.setClient(props.searchClient).search();\n      prevPropsRef.current = props;\n    }\n    if (prevProps.onStateChange !== props.onStateChange) {\n      _search.onStateChange = props.onStateChange;\n      prevPropsRef.current = props;\n    }\n    if (prevProps.searchFunction !== props.searchFunction) {\n      // Updating the `searchFunction` to `undefined` is not supported by\n      // InstantSearch.js, so it will throw an error.\n      // This is a fair behavior until we add an update API in InstantSearch.js.\n      _search._searchFunction = props.searchFunction;\n      prevPropsRef.current = props;\n    }\n    if (prevProps.stalledSearchDelay !== props.stalledSearchDelay) {\n      var _props$stalledSearchD;\n      // The default `stalledSearchDelay` in InstantSearch.js is 200ms.\n      // We need to reset it when it's undefined to get back to the original value.\n      _search._stalledSearchDelay = (_props$stalledSearchD = props.stalledSearchDelay) !== null && _props$stalledSearchD !== void 0 ? _props$stalledSearchD : 200;\n      prevPropsRef.current = props;\n    }\n\n    // Updating the `routing` prop is not supported because InstantSearch.js\n    // doesn't let us change it. This might not be a problem though, because `routing`\n    // shouldn't need to be dynamic.\n    // If we find scenarios where `routing` needs to change, we can always expose\n    // it privately on the InstantSearch instance. Another way would be to\n    // manually inject the routing middleware in this library, and not rely\n    // on the provided `routing` prop.\n  }\n\n  var cleanupTimerRef = useRef(null);\n  var store = useSyncExternalStore(useCallback(function () {\n    var search = searchRef.current;\n\n    // Scenario 1: the component mounts.\n    if (cleanupTimerRef.current === null) {\n      // On SSR, the instance is already started so we don't start it again.\n      if (!search.started) {\n        search.start();\n        forceUpdate();\n      }\n    }\n    // Scenario 2: the component updates.\n    else {\n      // We cancel the previous cleanup function because we don't want to\n      // dispose the search during an update.\n      clearTimeout(cleanupTimerRef.current);\n      search._preventWidgetCleanup = false;\n    }\n    return function () {\n      function cleanup() {\n        search.dispose();\n      }\n      clearTimeout(search._schedule.timer);\n      // We clean up only when the component that uses this subscription unmounts,\n      // but not when it updates, because it would dispose the instance, which\n      // would remove all the widgets and break routing.\n      // Executing the cleanup function in a `setTimeout()` lets us cancel it\n      // in the next effect.\n      // (There might be better ways to do this.)\n      cleanupTimerRef.current = setTimeout(cleanup);\n\n      // We need to prevent the `useWidget` cleanup function so that widgets\n      // are not removed before the instance is disposed, triggering\n      // an unwanted search request.\n      search._preventWidgetCleanup = true;\n    };\n  }, [forceUpdate]), function () {\n    return searchRef.current;\n  }, function () {\n    return searchRef.current;\n  });\n  return store;\n}\nfunction addAlgoliaAgents(searchClient, userAgents) {\n  if (typeof searchClient.addAlgoliaAgent !== 'function') {\n    return;\n  }\n  userAgents.filter(Boolean).forEach(function (userAgent) {\n    searchClient.addAlgoliaAgent(userAgent);\n  });\n}\nfunction warnNextRouter(routing) {\n  if (process.env.NODE_ENV === 'development') {\n    var _routing$router;\n    if (!routing || typeof window === 'undefined' || !('__NEXT_DATA__' in window)) {\n      return;\n    }\n    var isUsingNextRouter =\n    // @ts-expect-error: _isNextRouter is only set on the Next.js router\n    routing !== true && (routing === null || routing === void 0 ? void 0 : (_routing$router = routing.router) === null || _routing$router === void 0 ? void 0 : _routing$router._isNextRouter);\n    process.env.NODE_ENV === 'development' ? warn(isUsingNextRouter, \"\\nYou are using Next.js with InstantSearch without the \\\"react-instantsearch-router-nextjs\\\" package.\\nThis package is recommended to make the routing work correctly with Next.js.\\nPlease check its usage instructions: https://github.com/algolia/instantsearch/tree/master/packages/react-instantsearch-router-nextjs\\n\\nYou can ignore this warning if you are using a custom router that suits your needs, it won't be outputted in production builds.\") : void 0;\n  }\n}\n\n/**\n * Gets the version of Next.js if it is available in the `window` object,\n * otherwise it returns the NEXT_RUNTIME environment variable (in SSR),\n * which is either `nodejs` or `edge`.\n */\nfunction getNextVersion() {\n  var _next, _process$env;\n  return typeof window !== 'undefined' && ((_next = window.next) === null || _next === void 0 ? void 0 : _next.version) || (typeof process !== 'undefined' ? (_process$env = process.env) === null || _process$env === void 0 ? void 0 : _process$env.NEXT_RUNTIME : undefined);\n}","import { useContext } from 'react';\nimport { InstantSearchSSRContext } from \"./InstantSearchSSRContext.js\";\nexport function useInstantSearchSSRContext() {\n  return useContext(InstantSearchSSRContext);\n}","var _excluded = [\"children\"];\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport React from 'react';\nimport { IndexContext } from \"../lib/IndexContext.js\";\nimport { InstantSearchContext } from \"../lib/InstantSearchContext.js\";\nimport { useInstantSearchApi } from \"../lib/useInstantSearchApi.js\";\nexport function InstantSearch(_ref) {\n  var children = _ref.children,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var search = useInstantSearchApi(props);\n  if (!search.started) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(InstantSearchContext.Provider, {\n    value: search\n  }, /*#__PURE__*/React.createElement(IndexContext.Provider, {\n    value: search.mainIndex\n  }, children));\n}","import { getObjectType } from \"./getObjectType.js\";\nexport function checkRendering(rendering, usage) {\n  if (rendering === undefined || typeof rendering !== 'function') {\n    throw new Error(\"The render function is not valid (received type \".concat(getObjectType(rendering), \").\\n\\n\").concat(usage));\n  }\n}","export function getObjectType(object) {\n  return Object.prototype.toString.call(object).slice(8, -1);\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { checkRendering, createDocumentationMessageGenerator, noop } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'search-box',\n  connector: true\n});\n\n/**\n * @typedef {Object} CustomSearchBoxWidgetParams\n * @property {function(string, function(string))} [queryHook = undefined] A function that will be called every time\n * a new value for the query is set. The first parameter is the query and the second is a\n * function to actually trigger the search. The function takes the query as the parameter.\n *\n * This queryHook can be used to debounce the number of searches done from the searchBox.\n */\n\nvar defaultQueryHook = function defaultQueryHook(query, hook) {\n  return hook(query);\n};\n\n/**\n * **SearchBox** connector provides the logic to build a widget that will let the user search for a query.\n *\n * The connector provides to the rendering: `refine()` to set the query. The behaviour of this function\n * may be impacted by the `queryHook` widget parameter.\n */\nvar connectSearchBox = function connectSearchBox(renderFn) {\n  var unmountFn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n  checkRendering(renderFn, withUsage());\n  return function (widgetParams) {\n    var _ref = widgetParams || {},\n      _ref$queryHook = _ref.queryHook,\n      queryHook = _ref$queryHook === void 0 ? defaultQueryHook : _ref$queryHook;\n    var _refine;\n    var _clear;\n    return {\n      $$type: 'ais.searchBox',\n      init: function init(initOptions) {\n        var instantSearchInstance = initOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(initOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), true);\n      },\n      render: function render(renderOptions) {\n        var instantSearchInstance = renderOptions.instantSearchInstance;\n        renderFn(_objectSpread(_objectSpread({}, this.getWidgetRenderState(renderOptions)), {}, {\n          instantSearchInstance: instantSearchInstance\n        }), false);\n      },\n      dispose: function dispose(_ref2) {\n        var state = _ref2.state;\n        unmountFn();\n        return state.setQueryParameter('query', undefined);\n      },\n      getRenderState: function getRenderState(renderState, renderOptions) {\n        return _objectSpread(_objectSpread({}, renderState), {}, {\n          searchBox: this.getWidgetRenderState(renderOptions)\n        });\n      },\n      getWidgetRenderState: function getWidgetRenderState(_ref3) {\n        var helper = _ref3.helper,\n          searchMetadata = _ref3.searchMetadata,\n          state = _ref3.state;\n        if (!_refine) {\n          _refine = function _refine(query) {\n            queryHook(query, function (q) {\n              return helper.setQuery(q).search();\n            });\n          };\n          _clear = function _clear() {\n            helper.setQuery('').search();\n          };\n        }\n        return {\n          query: state.query || '',\n          refine: _refine,\n          clear: _clear,\n          widgetParams: widgetParams,\n          isSearchStalled: searchMetadata.isSearchStalled\n        };\n      },\n      getWidgetUiState: function getWidgetUiState(uiState, _ref4) {\n        var searchParameters = _ref4.searchParameters;\n        var query = searchParameters.query || '';\n        if (query === '' || uiState && uiState.query === query) {\n          return uiState;\n        }\n        return _objectSpread(_objectSpread({}, uiState), {}, {\n          query: query\n        });\n      },\n      getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref5) {\n        var uiState = _ref5.uiState;\n        return searchParameters.setQueryParameter('query', uiState.query || '');\n      }\n    };\n  };\n};\nexport default connectSearchBox;","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n/* eslint-disable complexity */\n\n/*\n * Code taken from dequal/lite v2.0.0\n * https://github.com/lukeed/dequal/blob/9aa73181ac7e081cd330cac67d313632ac04bb02/src/lite.js\n *\n * It adds a 3rd argument `compare(a, b)` that lets execute custom logic to\n * compare values.\n * We use it to skip comparing function references.\n */\n\n// eslint-disable-next-line @typescript-eslint/unbound-method\nvar has = Object.prototype.hasOwnProperty;\nexport function dequal(foo, bar, compare) {\n  // start of custom implementation\n  if (compare !== null && compare !== void 0 && compare(foo, bar)) {\n    return true;\n  }\n  // end of custom implementation\n\n  var ctor;\n  var len;\n  if (foo === bar) return true;\n  if (foo && bar && (ctor = foo.constructor) === bar.constructor) {\n    if (ctor === Date) return foo.getTime() === bar.getTime();\n    if (ctor === RegExp) return foo.toString() === bar.toString();\n    if (ctor === Array) {\n      if ((len = foo.length) === bar.length) {\n        while (len-- && dequal(foo[len], bar[len], compare));\n      }\n      return len === -1;\n    }\n    if (!ctor || _typeof(foo) === 'object') {\n      len = 0;\n      // eslint-disable-next-line guard-for-in, no-restricted-syntax\n      for (ctor in foo) {\n        if (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n        if (!(ctor in bar) || !dequal(foo[ctor], bar[ctor], compare)) return false;\n      }\n      return Object.keys(bar).length === len;\n    }\n  }\n\n  // eslint-disable-next-line no-self-compare\n  return foo !== foo && bar !== bar;\n}","import algoliasearchHelper from 'algoliasearch-helper';\nexport function createSearchResults(state) {\n  var _state$query, _state$page, _state$hitsPerPage;\n  return new algoliasearchHelper.SearchResults(state, [{\n    query: (_state$query = state.query) !== null && _state$query !== void 0 ? _state$query : '',\n    page: (_state$page = state.page) !== null && _state$page !== void 0 ? _state$page : 0,\n    hitsPerPage: (_state$hitsPerPage = state.hitsPerPage) !== null && _state$hitsPerPage !== void 0 ? _state$hitsPerPage : 20,\n    hits: [],\n    nbHits: 0,\n    nbPages: 0,\n    params: '',\n    exhaustiveNbHits: true,\n    exhaustiveFacetsCount: true,\n    processingTimeMS: 0,\n    index: state.index\n  }], {\n    /** used by connectors to prevent persisting these results */\n    __isArtificial: true\n  });\n}","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nimport { createSearchResults } from \"./createSearchResults.js\";\nexport function getIndexSearchResults(indexWidget) {\n  var helper = indexWidget.getHelper();\n  var results =\n  // On SSR, we get the results injected on the Index.\n  indexWidget.getResults() ||\n  // On the browser, we create fallback results based on the helper state.\n  createSearchResults(helper.state);\n  var scopedResults = indexWidget.getScopedResults().map(function (scopedResult) {\n    var fallbackResults = scopedResult.indexId === indexWidget.getIndexId() ? results : createSearchResults(scopedResult.helper.state);\n    return _objectSpread(_objectSpread({}, scopedResult), {}, {\n      // We keep `results` from being `null`.\n      results: scopedResult.results || fallbackResults\n    });\n  });\n  return {\n    results: results,\n    scopedResults: scopedResults\n  };\n}","/**\n * Throws an error if the condition is not met.\n *\n * The error is exhaustive in development, and becomes generic in production.\n *\n * This is used to make development a better experience to provide guidance as\n * to where the error comes from.\n */\nexport function invariant(condition, message) {\n  if (condition) {\n    return;\n  }\n  if (!(process.env.NODE_ENV === 'development')) {\n    throw new Error('Invariant failed');\n  }\n  if (process.env.NODE_ENV === 'development') {\n    throw new Error(\"[InstantSearch] \".concat(typeof message === 'function' ? message() : message));\n  }\n}","import { useContext } from 'react';\nimport { invariant } from \"./invariant.js\";\nimport { IndexContext } from \"./IndexContext.js\";\nexport function useIndexContext() {\n  var context = useContext(IndexContext);\n  invariant(context !== null, 'The <Index> component must be used within <InstantSearch>.');\n  return context;\n}","import { useContext } from 'react';\nimport { invariant } from \"./invariant.js\";\nimport { InstantSearchContext } from \"./InstantSearchContext.js\";\nexport function useInstantSearchContext() {\n  var search = useContext(InstantSearchContext);\n  invariant(search !== null, 'Hooks must be used inside the <InstantSearch> component.\\n\\n' + 'They are not compatible with the `react-instantsearch-core@6.x` and `react-instantsearch-dom` packages, so make sure to use the <InstantSearch> component from `react-instantsearch-core@7.x`.');\n  return search;\n}","function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { useState } from 'react';\nimport { dequal } from \"./dequal.js\";\nexport function useStableValue(value) {\n  var _useState = useState(function () {\n      return value;\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    stableValue = _useState2[0],\n    setStableValue = _useState2[1];\n  if (!dequal(stableValue, value)) {\n    setStableValue(value);\n  }\n  return stableValue;\n}","import { useEffect, useLayoutEffect } from 'react';\n\n/**\n * `useLayoutEffect` that doesn't show a warning when server-side rendering.\n *\n * It uses `useEffect` on the server (no-op), and `useLayoutEffect` on the browser.\n */\nexport var useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;","function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar _excluded = [\"instantSearchInstance\", \"widgetParams\"],\n  _excluded2 = [\"widgetParams\"];\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport { useMemo, useRef, useState } from 'react';\nimport { dequal } from \"../lib/dequal.js\";\nimport { getIndexSearchResults } from \"../lib/getIndexSearchResults.js\";\nimport { useIndexContext } from \"../lib/useIndexContext.js\";\nimport { useInstantSearchContext } from \"../lib/useInstantSearchContext.js\";\nimport { useInstantSearchServerContext } from \"../lib/useInstantSearchServerContext.js\";\nimport { useStableValue } from \"../lib/useStableValue.js\";\nimport { useWidget } from \"../lib/useWidget.js\";\nexport function useConnector(connector) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var additionalWidgetProperties = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var serverContext = useInstantSearchServerContext();\n  var search = useInstantSearchContext();\n  var parentIndex = useIndexContext();\n  var stableProps = useStableValue(props);\n  var stableAdditionalWidgetProperties = useStableValue(additionalWidgetProperties);\n  var shouldSetStateRef = useRef(true);\n  var previousRenderStateRef = useRef(null);\n  var previousStatusRef = useRef(search.status);\n  var widget = useMemo(function () {\n    var createWidget = connector(function (connectorState, isFirstRender) {\n      // We skip the `init` widget render because:\n      // - We rely on `getWidgetRenderState` to compute the initial state before\n      //   the InstantSearch.js lifecycle starts.\n      // - It prevents UI flashes when updating the widget props.\n      if (isFirstRender) {\n        shouldSetStateRef.current = true;\n        return;\n      }\n\n      // There are situations where InstantSearch.js may render widgets slightly\n      // after they're removed by React, and thus try to update the React state\n      // on unmounted components. React 16 and 17 consider them as memory leaks\n      // and display a warning.\n      // This happens in <DynamicWidgets> when `attributesToRender` contains a\n      // value without an attribute previously mounted. React will unmount the\n      // component controlled by that attribute, but InstantSearch.js will stay\n      // unaware of this change until the render pass finishes, and therefore\n      // notifies of a state change.\n      // This ref lets us track this situation and ignore these state updates.\n      if (shouldSetStateRef.current) {\n        var instantSearchInstance = connectorState.instantSearchInstance,\n          widgetParams = connectorState.widgetParams,\n          renderState = _objectWithoutProperties(connectorState, _excluded);\n\n        // We only update the state when a widget render state param changes,\n        // except for functions. We ignore function reference changes to avoid\n        // infinite loops. It's safe to omit them because they get updated\n        // every time another render param changes.\n        if (!dequal(renderState, previousRenderStateRef.current, function (a, b) {\n          return (a === null || a === void 0 ? void 0 : a.constructor) === Function && (b === null || b === void 0 ? void 0 : b.constructor) === Function;\n        }) || instantSearchInstance.status !== previousStatusRef.current) {\n          // eslint-disable-next-line @typescript-eslint/no-use-before-define\n          setState(renderState);\n          previousRenderStateRef.current = renderState;\n          previousStatusRef.current = instantSearchInstance.status;\n        }\n      }\n    }, function () {\n      // We'll ignore the next state update until we know for sure that\n      // InstantSearch.js re-inits the component.\n      shouldSetStateRef.current = false;\n    });\n    return _objectSpread(_objectSpread({}, createWidget(stableProps)), stableAdditionalWidgetProperties);\n  }, [connector, stableProps, stableAdditionalWidgetProperties]);\n  var _useState = useState(function () {\n      if (widget.getWidgetRenderState) {\n        var _widget$getWidgetSear;\n        // The helper exists because we've started InstantSearch.\n        var helper = parentIndex.getHelper();\n        var uiState = parentIndex.getWidgetUiState({})[parentIndex.getIndexId()];\n        helper.state = ((_widget$getWidgetSear = widget.getWidgetSearchParameters) === null || _widget$getWidgetSear === void 0 ? void 0 : _widget$getWidgetSear.call(widget, helper.state, {\n          uiState: uiState\n        })) || helper.state;\n        var _getIndexSearchResult = getIndexSearchResults(parentIndex),\n          results = _getIndexSearchResult.results,\n          scopedResults = _getIndexSearchResult.scopedResults;\n\n        // We get the widget render state by providing the same parameters as\n        // InstantSearch provides to the widget's `render` method.\n        // See https://github.com/algolia/instantsearch/blob/019cd18d0de6dd320284aa4890541b7fe2198c65/src/widgets/index/index.ts#L604-L617\n        var _widget$getWidgetRend = widget.getWidgetRenderState({\n            helper: helper,\n            parent: parentIndex,\n            instantSearchInstance: search,\n            results: results,\n            scopedResults: scopedResults,\n            state: helper.state,\n            renderState: search.renderState,\n            templatesConfig: search.templatesConfig,\n            createURL: parentIndex.createURL,\n            searchMetadata: {\n              isSearchStalled: search.status === 'stalled'\n            },\n            status: search.status,\n            error: search.error\n          }),\n          widgetParams = _widget$getWidgetRend.widgetParams,\n          renderState = _objectWithoutProperties(_widget$getWidgetRend, _excluded2);\n        return renderState;\n      }\n      return {};\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    state = _useState2[0],\n    setState = _useState2[1];\n  useWidget({\n    widget: widget,\n    parentIndex: parentIndex,\n    props: stableProps,\n    shouldSsr: Boolean(serverContext)\n  });\n  return state;\n}","import { useEffect, useRef } from 'react';\nimport { dequal } from \"./dequal.js\";\nimport { useInstantSearchContext } from \"./useInstantSearchContext.js\";\nimport { useIsomorphicLayoutEffect } from \"./useIsomorphicLayoutEffect.js\";\nexport function useWidget(_ref) {\n  var widget = _ref.widget,\n    parentIndex = _ref.parentIndex,\n    props = _ref.props,\n    shouldSsr = _ref.shouldSsr;\n  var prevPropsRef = useRef(props);\n  useEffect(function () {\n    prevPropsRef.current = props;\n  }, [props]);\n  var prevWidgetRef = useRef(widget);\n  useEffect(function () {\n    prevWidgetRef.current = widget;\n  }, [widget]);\n  var cleanupTimerRef = useRef(null);\n  var shouldAddWidgetEarly = shouldSsr && !parentIndex.getWidgets().includes(widget);\n  var search = useInstantSearchContext();\n\n  // This effect is responsible for adding, removing, and updating the widget.\n  // We need to support scenarios where the widget is remounted quickly, like in\n  // Strict Mode, so that we don't lose its state, and therefore that we don't\n  // break routing.\n  useIsomorphicLayoutEffect(function () {\n    var previousWidget = prevWidgetRef.current;\n\n    // Scenario 1: the widget is added for the first time.\n    if (!cleanupTimerRef.current) {\n      if (!shouldAddWidgetEarly) {\n        parentIndex.addWidgets([widget]);\n      }\n    }\n    // Scenario 2: the widget is rerendered or updated.\n    else {\n      // We cancel the original effect cleanup because it may not be necessary if\n      // props haven't changed. (We manually call it if it is below.)\n      clearTimeout(cleanupTimerRef.current);\n\n      // Warning: if an unstable function prop is provided, `dequal` is not able\n      // to keep its reference and therefore will consider that props did change.\n      // This could unsollicitely remove/add the widget, therefore forget its state,\n      // and could be a source of confusion.\n      // If users face this issue, we should advise them to provide stable function\n      // references.\n      var arePropsEqual = dequal(props, prevPropsRef.current);\n\n      // If props did change, then we execute the cleanup function instantly\n      // and then add the widget back. This lets us add the widget without\n      // waiting for the scheduled cleanup function to finish (that we canceled\n      // above).\n      if (!arePropsEqual) {\n        parentIndex.removeWidgets([previousWidget]);\n        parentIndex.addWidgets([widget]);\n      }\n    }\n    return function () {\n      // We don't remove the widget right away, but rather schedule it so that\n      // we're able to cancel it in the next effect.\n      cleanupTimerRef.current = setTimeout(function () {\n        search._schedule(function () {\n          if (search._preventWidgetCleanup) return;\n          parentIndex.removeWidgets([previousWidget]);\n        });\n      });\n    };\n  }, [parentIndex, widget, shouldAddWidgetEarly, search, props]);\n  if (shouldAddWidgetEarly) {\n    parentIndex.addWidgets([widget]);\n  }\n}","import connectSearchBox from \"instantsearch.js/es/connectors/search-box/connectSearchBox.js\";\nimport { useConnector } from \"../hooks/useConnector.js\";\nexport function useSearchBox(props, additionalWidgetProperties) {\n  return useConnector(connectSearchBox, props, additionalWidgetProperties);\n}","function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { useEffect, useState } from 'react';\nimport { getIndexSearchResults } from \"./getIndexSearchResults.js\";\nimport { useIndexContext } from \"./useIndexContext.js\";\nimport { useInstantSearchContext } from \"./useInstantSearchContext.js\";\nexport function useSearchResults() {\n  var search = useInstantSearchContext();\n  var searchIndex = useIndexContext();\n  var _useState = useState(function () {\n      return getIndexSearchResults(searchIndex);\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    searchResults = _useState2[0],\n    setSearchResults = _useState2[1];\n  useEffect(function () {\n    function handleRender() {\n      var results = searchIndex.getResults();\n\n      // Results can be `null` when the first search is stalled.\n      // In this case, we skip the update.\n      // See: https://github.com/algolia/instantsearch/blob/20996c7a159988c58e00ff24d2d2dc98af8b980f/src/widgets/index/index.ts#L652-L657\n      if (results !== null) {\n        setSearchResults({\n          results: results,\n          scopedResults: searchIndex.getScopedResults()\n        });\n      }\n    }\n    search.addListener('render', handleRender);\n    return function () {\n      search.removeListener('render', handleRender);\n    };\n  }, [search, searchIndex]);\n  return searchResults;\n}","function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport { useCallback, useEffect, useState } from 'react';\nimport { useIndexContext } from \"./useIndexContext.js\";\nimport { useInstantSearchContext } from \"./useInstantSearchContext.js\";\nexport function useSearchState() {\n  var search = useInstantSearchContext();\n  var searchIndex = useIndexContext();\n  var indexId = searchIndex.getIndexId();\n  var _useState = useState(function () {\n      return search.getUiState();\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    uiState = _useState2[0],\n    setLocalUiState = _useState2[1];\n  var indexUiState = uiState[indexId];\n  var setUiState = useCallback(function (nextUiState) {\n    search.setUiState(nextUiState);\n  }, [search]);\n  var setIndexUiState = useCallback(function (nextIndexUiState) {\n    searchIndex.setIndexUiState(nextIndexUiState);\n  }, [searchIndex]);\n  useEffect(function () {\n    function handleRender() {\n      setLocalUiState(search.getUiState());\n    }\n    search.addListener('render', handleRender);\n    return function () {\n      search.removeListener('render', handleRender);\n    };\n  }, [search]);\n  return {\n    uiState: uiState,\n    setUiState: setUiState,\n    indexUiState: indexUiState,\n    setIndexUiState: setIndexUiState\n  };\n}","import { useCallback } from 'react';\nimport { useInstantSearchContext } from \"../lib/useInstantSearchContext.js\";\nimport { useIsomorphicLayoutEffect } from \"../lib/useIsomorphicLayoutEffect.js\";\nimport { useSearchResults } from \"../lib/useSearchResults.js\";\nimport { useSearchState } from \"../lib/useSearchState.js\";\nexport function useInstantSearch() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    catchError = _ref.catchError;\n  var search = useInstantSearchContext();\n  var _useSearchState = useSearchState(),\n    uiState = _useSearchState.uiState,\n    setUiState = _useSearchState.setUiState,\n    indexUiState = _useSearchState.indexUiState,\n    setIndexUiState = _useSearchState.setIndexUiState;\n  var _useSearchResults = useSearchResults(),\n    results = _useSearchResults.results,\n    scopedResults = _useSearchResults.scopedResults;\n  var addMiddlewares = useCallback(function () {\n    for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n      middlewares[_key] = arguments[_key];\n    }\n    search.use.apply(search, middlewares);\n    return function () {\n      search.unuse.apply(search, middlewares);\n    };\n  }, [search]);\n  var refresh = useCallback(function () {\n    search.refresh();\n  }, [search]);\n  useIsomorphicLayoutEffect(function () {\n    if (catchError) {\n      var onError = function onError() {};\n      search.addListener('error', onError);\n      return function () {\n        return search.removeListener('error', onError);\n      };\n    }\n    return function () {};\n  }, [search, catchError]);\n  return {\n    results: results,\n    scopedResults: scopedResults,\n    uiState: uiState,\n    setUiState: setUiState,\n    indexUiState: indexUiState,\n    setIndexUiState: setIndexUiState,\n    addMiddlewares: addMiddlewares,\n    refresh: refresh,\n    status: search.status,\n    error: search.error\n  };\n}","import { faMagnifyingGlass } from \"@fortawesome/free-solid-svg-icons\";\nimport { faCircleXmark } from \"@fortawesome/free-regular-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useRef, useState } from \"react\";\nimport {\n  UseSearchBoxProps,\n  useInstantSearch,\n  useSearchBox,\n} from \"react-instantsearch\";\nimport \"twin.macro\";\nimport { hCenter } from \"../../../../../styles/base\";\nimport { textField } from \"../../../../../styles/form\";\nimport { Link } from \"gatsby\";\n\nconst SearchBoxIndex = (props: UseSearchBoxProps) => {\n  const { query, refine } = useSearchBox(props);\n  const { status } = useInstantSearch();\n  const [inputValue, setInputValue] = useState(query);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const isSearchStalled = status === \"stalled\";\n\n  const setQuery = (newQuery: string) => {\n    setInputValue(newQuery);\n    refine(newQuery);\n  };\n\n  return (\n    <div tw=\"w-full \">\n      <form\n        tw=\"w-full relative\"\n        action=\"\"\n        role=\"search\"\n        noValidate\n        onSubmit={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          if (inputRef.current) {\n            inputRef.current.blur();\n          }\n        }}\n        onReset={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          setQuery(\"\");\n          // if (inputRef.current) {\n          //   inputRef.current.focus();\n          // }\n        }}\n      >\n        <input\n          css={textField}\n          ref={inputRef}\n          autoComplete=\"off\"\n          autoCorrect=\"off\"\n          autoCapitalize=\"off\"\n          placeholder=\"\"\n          spellCheck={false}\n          maxLength={512}\n          type=\"search\"\n          value={inputValue}\n          onChange={(event) => {\n            setQuery(event.currentTarget.value);\n          }}\n          // autoFocus\n        />\n        <div\n          css={hCenter}\n          tw=\"absolute right-1 top-1/2 transform -translate-y-1/2 gap-4\"\n        >\n          <button\n            type=\"reset\"\n            tw=\"\"\n            hidden={inputValue.length === 0 || isSearchStalled}\n          >\n            <FontAwesomeIcon icon={faCircleXmark} />\n          </button>\n          <Link\n            to=\"/result\"\n            tw=\" text-lg  p-2.5 bg-blue-button rounded text-white tracking-widest\"\n          >\n            <FontAwesomeIcon icon={faMagnifyingGlass} tw=\"mr-1.5\" /> \n          </Link>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default SearchBoxIndex;\n","import { faMagnifyingGlass } from \"@fortawesome/free-solid-svg-icons\";\nimport { faCircleXmark } from \"@fortawesome/free-regular-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n  UseSearchBoxProps,\n  useInstantSearch,\n  useSearchBox,\n} from \"react-instantsearch\";\nimport \"twin.macro\";\nimport { hCenter } from \"../../../../../styles/base\";\nimport { textField } from \"../../../../../styles/form\";\nimport { Link } from \"gatsby\";\nimport { useAlgoliaStrapiContext } from \"../../../../../context/algoliaStrapiContext\";\n\nconst SearchBoxSidebar = (props: UseSearchBoxProps) => {\n  const { query, refine } = useSearchBox(props);\n  const { status } = useInstantSearch();\n  const [inputValue, setInputValue] = useState(query);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const isSearchStalled = status === \"stalled\";\n\n  const setQuery = (newQuery: string) => {\n    setInputValue(newQuery);\n    refine(newQuery);\n  };\n\n  return (\n    <div tw=\"w-full\">\n      <form\n        tw=\"w-full\"\n        action=\"\"\n        role=\"search\"\n        noValidate\n        onSubmit={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          if (inputRef.current) {\n            inputRef.current.blur();\n          }\n        }}\n        onReset={(event) => {\n          event.preventDefault();\n          event.stopPropagation();\n          setQuery(\"\");\n          if (inputRef.current) {\n            inputRef.current.focus();\n          }\n        }}\n      >\n        <div tw=\"relative\">\n          <input\n            css={textField}\n            ref={inputRef}\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            autoCapitalize=\"off\"\n            placeholder=\"\"\n            spellCheck={false}\n            maxLength={512}\n            type=\"search\"\n            value={inputValue}\n            onChange={(event) => {\n              setQuery(event.currentTarget.value);\n            }}\n            autoFocus\n            tw=\"py-3\"\n          />\n          {/* <button\n            type=\"reset\"\n            hidden={inputValue.length === 0 || isSearchStalled}\n            tw=\"absolute right-2.5 top-3\"\n          >\n            <FontAwesomeIcon icon={faCircleXmark} />\n          </button> */}\n        </div>\n\n        <Link\n          to=\"/result\"\n          tw=\"block text-lg p-2.5 bg-blue-button rounded text-white mt-2.5 text-center\"\n        >\n          <FontAwesomeIcon icon={faMagnifyingGlass} tw=\"mr-1.5\" /> \n        </Link>\n      </form>\n    </div>\n  );\n};\n\nexport default SearchBoxSidebar;\n","import { faMagnifyingGlass } from \"@fortawesome/free-solid-svg-icons\";\nimport { faCircleXmark } from \"@fortawesome/free-regular-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useRef, useState } from \"react\";\nimport {\n  UseSearchBoxProps,\n  useInstantSearch,\n  useSearchBox,\n} from \"react-instantsearch\";\nimport \"twin.macro\";\nimport { h3, hCenter } from \"../../../../../styles/base\";\nimport {\n  checkBox,\n  checkBoxSet,\n  checkMark,\n  textField,\n} from \"../../../../../styles/form\";\nimport { Link } from \"gatsby\";\nimport { topicKeywordArray } from \"../../../store/filterContents\";\nimport * as Checkbox from \"@radix-ui/react-checkbox\";\nimport { useSearchContext } from \"../../../../../context/searchContext\";\n\nconst SearchBoxTopicKeyword = (props: UseSearchBoxProps) => {\n  const { query, refine } = useSearchBox(props);\n  const { status } = useInstantSearch();\n  const [inputValue, setInputValue] = useState(query);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const { searchState, searchSetState } = useSearchContext();\n  const { topic_keywords } = searchState;\n  const { setTopicKeywords } = searchSetState;\n  const checkboxArray = topicKeywordArray;\n\n  const isSearchStalled = status === \"stalled\";\n\n  const setQuery = (newQuery: string) => {\n    setInputValue(newQuery);\n    refine(newQuery);\n  };\n\n  const handleCheckbox = (label: string) => {\n    if (topic_keywords.includes(label)) {\n      setTopicKeywords(topic_keywords.filter((tk) => tk !== label));\n    } else {\n      setTopicKeywords([...topic_keywords, label]);\n    }\n    setQuery(label);\n  };\n\n  return (\n    <div tw=\"w-full \">\n      <h3 css={h3}></h3>\n      <div tw=\"flex gap-x-14 gap-y-2.5 flex-wrap px-3.5 py-2.5\">\n        {checkboxArray.map((checkbox) => (\n          <div key={checkbox} css={[hCenter, checkBoxSet]}>\n            <Checkbox.Root\n              id={checkbox}\n              onCheckedChange={() => handleCheckbox(checkbox)}\n              css={checkBox}\n              checked={topic_keywords.includes(checkbox)}\n            >\n              <Checkbox.Indicator tw=\"flex justify-center\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"15.003\"\n                  height=\"11.252\"\n                  viewBox=\"0 0 15.003 11.252\"\n                  css={checkMark}\n                >\n                  <path\n                    id=\"check\"\n                    d=\"M300.625,135.16l-1.876-1.876h0L295,129.533l1.875-1.875,3.751,3.751,7.5-7.5L310,125.783Z\"\n                    transform=\"translate(-294.999 -123.908)\"\n                  />\n                </svg>\n              </Checkbox.Indicator>\n            </Checkbox.Root>\n            <label htmlFor={checkbox}>{checkbox}</label>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default SearchBoxTopicKeyword;\n","import React, { useMemo } from \"react\";\nimport algoliasearch from \"algoliasearch/lite\";\nimport { InstantSearch, SearchBox, Hits } from \"react-instantsearch\";\nimport type { SearchBoxProps } from \"react-instantsearch\";\nimport { useAlgoliaStrapiContext } from \"../../../context/algoliaStrapiContext\";\nimport SearchBoxIndex from \"../component/main/Freeword/SearchBoxIndex\";\nimport \"twin.macro\";\nimport SearchBoxSidebar from \"../component/sidebar/Freeword/SearchBoxSidebar\";\nimport { useSearchContext } from \"../../../context/searchContext\";\nimport SearchBoxTopicKeyword from \"../component/main/Freeword/SearchBoxTopicKeyword\";\n\nconst searchClient = algoliasearch(\n  process.env.GATSBY_ALGOLIA_APP_ID || \"\",\n  process.env.GATSBY_ALGOLIA_SEARCH_KEY || \"\"\n);\n\nconst AlgoliaIndex = (props: { path: string }) => {\n  const { setAlgoliaHits } = useAlgoliaStrapiContext();\n  const { searchSetState } = useSearchContext();\n  const { setWithAlgoliaQuery } = searchSetState;\n\n  const index = searchClient.initIndex(\"janpia-johokokai\");\n  const searchOption = { hitsPerPage: 1000 };\n\n  const queryHook: SearchBoxProps[\"queryHook\"] = (query, search) => {\n    setWithAlgoliaQuery(query ? true : false);\n\n    index.search(query, searchOption).then(({ hits }) => {\n      const hitCd = hits.map((hit: any) => {\n        if (hit.business_cd) {\n          return { code: hit.business_cd, type: \"business\" };\n        } else if (hit.organization_cd) {\n          return { code: hit.organization_cd, type: \"organization\" };\n        } else if (hit.insert_id) {\n          return { code: hit.insert_id, type: \"attachedFile\" };\n        } else if (hit.biz_cd_executive || hit.biz_cd_fund_distr) {\n          return {\n            code: hit.biz_cd_executive || hit.biz_cd_fund_distr,\n            type: \"business\",\n          };\n        } else {\n          return { code: \"\", type: \"\" };\n        }\n      });\n\n      setAlgoliaHits(hitCd);\n    });\n  };\n\n  return (\n    <InstantSearch indexName=\"janpia-johokokai\" searchClient={searchClient}>\n      {props.path === \"/\" && (\n        <div>\n          <div tw=\"lg:(hidden)\">\n            <SearchBoxIndex queryHook={queryHook} />\n          </div>\n          <div tw=\"hidden lg:(block)\">\n            <SearchBoxSidebar queryHook={queryHook} />\n          </div>\n        </div>\n      )}\n      {props.path === \"result\" && <SearchBoxSidebar queryHook={queryHook} />}\n      {props.path === \"search\" && (\n        <SearchBoxTopicKeyword queryHook={queryHook} />\n      )}\n    </InstantSearch>\n  );\n};\n\nexport default AlgoliaIndex;\n","'use strict';\n\nvar AlgoliaSearchHelper = require('./src/algoliasearch.helper');\nvar SearchParameters = require('./src/SearchParameters');\nvar SearchResults = require('./src/SearchResults');\n\n/**\n * The algoliasearchHelper module is the function that will let its\n * contains everything needed to use the Algoliasearch\n * Helper. It is a also a function that instanciate the helper.\n * To use the helper, you also need the Algolia JS client v3.\n * @example\n * //using the UMD build\n * var client = algoliasearch('latency', '6be0576ff61c053d5f9a3225e2a90f76');\n * var helper = algoliasearchHelper(client, 'bestbuy', {\n *   facets: ['shipping'],\n *   disjunctiveFacets: ['category']\n * });\n * helper.on('result', function(event) {\n *   console.log(event.results);\n * });\n * helper\n *   .toggleFacetRefinement('category', 'Movies & TV Shows')\n *   .toggleFacetRefinement('shipping', 'Free shipping')\n *   .search();\n * @example\n * // The helper is an event emitter using the node API\n * helper.on('result', updateTheResults);\n * helper.once('result', updateTheResults);\n * helper.removeListener('result', updateTheResults);\n * helper.removeAllListeners('result');\n * @module algoliasearchHelper\n * @param  {AlgoliaSearch} client an AlgoliaSearch client\n * @param  {string} index the name of the index to query\n * @param  {SearchParameters|object} opts an object defining the initial config of the search. It doesn't have to be a {SearchParameters}, just an object containing the properties you need from it.\n * @return {AlgoliaSearchHelper} The helper instance\n */\nfunction algoliasearchHelper(client, index, opts) {\n  return new AlgoliaSearchHelper(client, index, opts);\n}\n\n/**\n * The version currently used\n * @member module:algoliasearchHelper.version\n * @type {number}\n */\nalgoliasearchHelper.version = require('./src/version');\n\n/**\n * Constructor for the Helper.\n * @member module:algoliasearchHelper.AlgoliaSearchHelper\n * @type {AlgoliaSearchHelper}\n */\nalgoliasearchHelper.AlgoliaSearchHelper = AlgoliaSearchHelper;\n\n/**\n * Constructor for the object containing all the parameters of the search.\n * @member module:algoliasearchHelper.SearchParameters\n * @type {SearchParameters}\n */\nalgoliasearchHelper.SearchParameters = SearchParameters;\n\n/**\n * Constructor for the object containing the results of the search.\n * @member module:algoliasearchHelper.SearchResults\n * @type {SearchResults}\n */\nalgoliasearchHelper.SearchResults = SearchResults;\n\nmodule.exports = algoliasearchHelper;\n","'use strict';\n\nvar EventEmitter = require('@algolia/events');\n\nvar inherits = require('../functions/inherits');\n\n/**\n * A DerivedHelper is a way to create sub requests to\n * Algolia from a main helper.\n * @class\n * @classdesc The DerivedHelper provides an event based interface for search callbacks:\n *  - search: when a search is triggered using the `search()` method.\n *  - result: when the response is retrieved from Algolia and is processed.\n *    This event contains a {@link SearchResults} object and the\n *    {@link SearchParameters} corresponding to this answer.\n * @param {AlgoliaSearchHelper} mainHelper the main helper\n * @param {function} fn the function to create the derived state\n */\nfunction DerivedHelper(mainHelper, fn) {\n  this.main = mainHelper;\n  this.fn = fn;\n  this.lastResults = null;\n}\n\ninherits(DerivedHelper, EventEmitter);\n\n/**\n * Detach this helper from the main helper\n * @return {undefined}\n * @throws Error if the derived helper is already detached\n */\nDerivedHelper.prototype.detach = function () {\n  this.removeAllListeners();\n  this.main.detachDerivedHelper(this);\n};\n\nDerivedHelper.prototype.getModifiedState = function (parameters) {\n  return this.fn(parameters);\n};\n\nmodule.exports = DerivedHelper;\n","'use strict';\n\n/**\n * Functions to manipulate refinement lists\n *\n * The RefinementList is not formally defined through a prototype but is based\n * on a specific structure.\n *\n * @module SearchParameters.refinementList\n *\n * @typedef {string[]} SearchParameters.refinementList.Refinements\n * @typedef {Object.<string, SearchParameters.refinementList.Refinements>} SearchParameters.refinementList.RefinementList\n */\n\nvar defaultsPure = require('../functions/defaultsPure');\nvar objectHasKeys = require('../functions/objectHasKeys');\nvar omit = require('../functions/omit');\n\nvar lib = {\n  /**\n   * Adds a refinement to a RefinementList\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} value the value of the refinement, if the value is not a string it will be converted\n   * @return {RefinementList} a new and updated refinement list\n   */\n  addRefinement: function addRefinement(refinementList, attribute, value) {\n    if (lib.isRefined(refinementList, attribute, value)) {\n      return refinementList;\n    }\n\n    var valueAsString = '' + value;\n\n    var facetRefinement = !refinementList[attribute]\n      ? [valueAsString]\n      : refinementList[attribute].concat(valueAsString);\n\n    var mod = {};\n\n    mod[attribute] = facetRefinement;\n\n    return defaultsPure({}, mod, refinementList);\n  },\n  /**\n   * Removes refinement(s) for an attribute:\n   *  - if the value is specified removes the refinement for the value on the attribute\n   *  - if no value is specified removes all the refinements for this attribute\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} [value] the value of the refinement\n   * @return {RefinementList} a new and updated refinement lst\n   */\n  removeRefinement: function removeRefinement(\n    refinementList,\n    attribute,\n    value\n  ) {\n    if (value === undefined) {\n      // we use the \"filter\" form of clearRefinement, since it leaves empty values as-is\n      // the form with a string will remove the attribute completely\n      return lib.clearRefinement(refinementList, function (v, f) {\n        return attribute === f;\n      });\n    }\n\n    var valueAsString = '' + value;\n\n    return lib.clearRefinement(refinementList, function (v, f) {\n      return attribute === f && valueAsString === v;\n    });\n  },\n  /**\n   * Toggles the refinement value for an attribute.\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} value the value of the refinement\n   * @return {RefinementList} a new and updated list\n   */\n  toggleRefinement: function toggleRefinement(\n    refinementList,\n    attribute,\n    value\n  ) {\n    if (value === undefined)\n      throw new Error('toggleRefinement should be used with a value');\n\n    if (lib.isRefined(refinementList, attribute, value)) {\n      return lib.removeRefinement(refinementList, attribute, value);\n    }\n\n    return lib.addRefinement(refinementList, attribute, value);\n  },\n  /**\n   * Clear all or parts of a RefinementList. Depending on the arguments, three\n   * kinds of behavior can happen:\n   *  - if no attribute is provided: clears the whole list\n   *  - if an attribute is provided as a string: clears the list for the specific attribute\n   *  - if an attribute is provided as a function: discards the elements for which the function returns true\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} [attribute] the attribute or function to discard\n   * @param {string} [refinementType] optional parameter to give more context to the attribute function\n   * @return {RefinementList} a new and updated refinement list\n   */\n  clearRefinement: function clearRefinement(\n    refinementList,\n    attribute,\n    refinementType\n  ) {\n    if (attribute === undefined) {\n      // return the same object if the list is already empty\n      // this is mainly for tests, as it doesn't have much impact on performance\n      if (!objectHasKeys(refinementList)) {\n        return refinementList;\n      }\n      return {};\n    } else if (typeof attribute === 'string') {\n      return omit(refinementList, [attribute]);\n    } else if (typeof attribute === 'function') {\n      var hasChanged = false;\n\n      var newRefinementList = Object.keys(refinementList).reduce(function (\n        memo,\n        key\n      ) {\n        var values = refinementList[key] || [];\n        var facetList = values.filter(function (value) {\n          return !attribute(value, key, refinementType);\n        });\n\n        if (facetList.length !== values.length) {\n          hasChanged = true;\n        }\n\n        memo[key] = facetList;\n\n        return memo;\n      },\n      {});\n\n      if (hasChanged) return newRefinementList;\n      return refinementList;\n    }\n\n    // We return nothing if the attribute is not undefined, a string or a function,\n    // as it is not a valid value for a refinement\n    return undefined;\n  },\n  /**\n   * Test if the refinement value is used for the attribute. If no refinement value\n   * is provided, test if the refinementList contains any refinement for the\n   * given attribute.\n   * @param {RefinementList} refinementList the list of refinement\n   * @param {string} attribute name of the attribute\n   * @param {string} [refinementValue] value of the filter/refinement\n   * @return {boolean} true if the attribute is refined, false otherwise\n   */\n  isRefined: function isRefined(refinementList, attribute, refinementValue) {\n    var containsRefinements =\n      Boolean(refinementList[attribute]) &&\n      refinementList[attribute].length > 0;\n\n    if (refinementValue === undefined || !containsRefinements) {\n      return containsRefinements;\n    }\n\n    var refinementValueAsString = '' + refinementValue;\n\n    return refinementList[attribute].indexOf(refinementValueAsString) !== -1;\n  },\n};\n\nmodule.exports = lib;\n","'use strict';\n\nvar defaultsPure = require('../functions/defaultsPure');\nvar find = require('../functions/find');\nvar intersection = require('../functions/intersection');\nvar merge = require('../functions/merge');\nvar objectHasKeys = require('../functions/objectHasKeys');\nvar omit = require('../functions/omit');\nvar valToNumber = require('../functions/valToNumber');\nvar isValidUserToken = require('../utils/isValidUserToken');\n\nvar RefinementList = require('./RefinementList');\n\n/**\n * isEqual, but only for numeric refinement values, possible values:\n * - 5\n * - [5]\n * - [[5]]\n * - [[5,5],[4]]\n * @param {any} a numeric refinement value\n * @param {any} b numeric refinement value\n * @return {boolean} true if the values are equal\n */\nfunction isEqualNumericRefinement(a, b) {\n  if (Array.isArray(a) && Array.isArray(b)) {\n    return (\n      a.length === b.length &&\n      a.every(function (el, i) {\n        return isEqualNumericRefinement(b[i], el);\n      })\n    );\n  }\n  return a === b;\n}\n\n/**\n * like _.find but using deep equality to be able to use it\n * to find arrays.\n * @private\n * @param {any[]} array array to search into (elements are base or array of base)\n * @param {any} searchedValue the value we're looking for (base or array of base)\n * @return {any} the searched value or undefined\n */\nfunction findArray(array, searchedValue) {\n  return find(array, function (currentValue) {\n    return isEqualNumericRefinement(currentValue, searchedValue);\n  });\n}\n\n/**\n * The facet list is the structure used to store the list of values used to\n * filter a single attribute.\n * @typedef {string[]} SearchParameters.FacetList\n */\n\n/**\n * Structure to store numeric filters with the operator as the key. The supported operators\n * are `=`, `>`, `<`, `>=`, `<=` and `!=`.\n * @typedef {Object.<string, Array.<number|number[]>>} SearchParameters.OperatorList\n */\n\n/**\n * SearchParameters is the data structure that contains all the information\n * usable for making a search to Algolia API. It doesn't do the search itself,\n * nor does it contains logic about the parameters.\n * It is an immutable object, therefore it has been created in a way that each\n * changes does not change the object itself but returns a copy with the\n * modification.\n * This object should probably not be instantiated outside of the helper. It will\n * be provided when needed. This object is documented for reference as you'll\n * get it from events generated by the {@link AlgoliaSearchHelper}.\n * If need be, instantiate the Helper from the factory function {@link SearchParameters.make}\n * @constructor\n * @classdesc contains all the parameters of a search\n * @param {object|SearchParameters} newParameters existing parameters or partial object\n * for the properties of a new SearchParameters\n * @see SearchParameters.make\n * @example <caption>SearchParameters of the first query in\n *   <a href=\"http://demos.algolia.com/instant-search-demo/\">the instant search demo</a></caption>\n{\n   \"query\": \"\",\n   \"disjunctiveFacets\": [\n      \"customerReviewCount\",\n      \"category\",\n      \"salePrice_range\",\n      \"manufacturer\"\n  ],\n   \"maxValuesPerFacet\": 30,\n   \"page\": 0,\n   \"hitsPerPage\": 10,\n   \"facets\": [\n      \"type\",\n      \"shipping\"\n  ]\n}\n */\nfunction SearchParameters(newParameters) {\n  var params = newParameters\n    ? SearchParameters._parseNumbers(newParameters)\n    : {};\n\n  if (params.userToken !== undefined && !isValidUserToken(params.userToken)) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      '[algoliasearch-helper] The `userToken` parameter is invalid. This can lead to wrong analytics.\\n  - Format: [a-zA-Z0-9_-]{1,64}'\n    );\n  }\n  /**\n   * This attribute contains the list of all the conjunctive facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * @member {string[]}\n   */\n  this.facets = params.facets || [];\n  /**\n   * This attribute contains the list of all the disjunctive facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * @member {string[]}\n   */\n  this.disjunctiveFacets = params.disjunctiveFacets || [];\n  /**\n   * This attribute contains the list of all the hierarchical facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * Hierarchical facets are a sub type of disjunctive facets that\n   * let you filter faceted attributes hierarchically.\n   * @member {string[]|object[]}\n   */\n  this.hierarchicalFacets = params.hierarchicalFacets || [];\n\n  // Refinements\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the conjunctive facets. Each facet must be properly\n   * defined in the `facets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.facetsRefinements = params.facetsRefinements || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * excluded from the conjunctive facets. Each facet must be properly\n   * defined in the `facets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters excluded for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.facetsExcludes = params.facetsExcludes || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the disjunctive facets. Each facet must be properly\n   * defined in the `disjunctiveFacets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.disjunctiveFacetsRefinements = params.disjunctiveFacetsRefinements || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the numeric attributes.\n   *\n   * The key is the name of the attribute, and the value is the\n   * filters to apply to this attribute.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `numericFilters` attribute.\n   * @member {Object.<string, SearchParameters.OperatorList>}\n   */\n  this.numericRefinements = params.numericRefinements || {};\n  /**\n   * This attribute contains all the tags used to refine the query.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `tagFilters` attribute.\n   * @member {string[]}\n   */\n  this.tagRefinements = params.tagRefinements || [];\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the hierarchical facets. Each facet must be properly\n   * defined in the `hierarchicalFacets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name. The FacetList values\n   * are structured as a string that contain the values for each level\n   * separated by the configured separator.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.hierarchicalFacetsRefinements =\n    params.hierarchicalFacetsRefinements || {};\n\n  // eslint-disable-next-line consistent-this\n  var self = this;\n  Object.keys(params).forEach(function (paramName) {\n    var isKeyKnown = SearchParameters.PARAMETERS.indexOf(paramName) !== -1;\n    var isValueDefined = params[paramName] !== undefined;\n\n    if (!isKeyKnown && isValueDefined) {\n      self[paramName] = params[paramName];\n    }\n  });\n}\n\n/**\n * List all the properties in SearchParameters and therefore all the known Algolia properties\n * This doesn't contain any beta/hidden features.\n * @private\n */\nSearchParameters.PARAMETERS = Object.keys(new SearchParameters());\n\n/**\n * @private\n * @param {object} partialState full or part of a state\n * @return {object} a new object with the number keys as number\n */\nSearchParameters._parseNumbers = function (partialState) {\n  // Do not parse numbers again in SearchParameters, they ought to be parsed already\n  if (partialState instanceof SearchParameters) return partialState;\n\n  var numbers = {};\n\n  var numberKeys = [\n    'aroundPrecision',\n    'aroundRadius',\n    'getRankingInfo',\n    'minWordSizefor2Typos',\n    'minWordSizefor1Typo',\n    'page',\n    'maxValuesPerFacet',\n    'distinct',\n    'minimumAroundRadius',\n    'hitsPerPage',\n    'minProximity',\n  ];\n\n  numberKeys.forEach(function (k) {\n    var value = partialState[k];\n    if (typeof value === 'string') {\n      var parsedValue = parseFloat(value);\n      // global isNaN is ok to use here, value is only number or NaN\n      numbers[k] = isNaN(parsedValue) ? value : parsedValue;\n    }\n  });\n\n  // there's two formats of insideBoundingBox, we need to parse\n  // the one which is an array of float geo rectangles\n  if (Array.isArray(partialState.insideBoundingBox)) {\n    numbers.insideBoundingBox = partialState.insideBoundingBox.map(function (\n      geoRect\n    ) {\n      if (Array.isArray(geoRect)) {\n        return geoRect.map(function (value) {\n          return parseFloat(value);\n        });\n      }\n      return geoRect;\n    });\n  }\n\n  if (partialState.numericRefinements) {\n    var numericRefinements = {};\n    Object.keys(partialState.numericRefinements).forEach(function (attribute) {\n      var operators = partialState.numericRefinements[attribute] || {};\n      numericRefinements[attribute] = {};\n      Object.keys(operators).forEach(function (operator) {\n        var values = operators[operator];\n        var parsedValues = values.map(function (v) {\n          if (Array.isArray(v)) {\n            return v.map(function (vPrime) {\n              if (typeof vPrime === 'string') {\n                return parseFloat(vPrime);\n              }\n              return vPrime;\n            });\n          } else if (typeof v === 'string') {\n            return parseFloat(v);\n          }\n          return v;\n        });\n        numericRefinements[attribute][operator] = parsedValues;\n      });\n    });\n    numbers.numericRefinements = numericRefinements;\n  }\n\n  return merge({}, partialState, numbers);\n};\n\n/**\n * Factory for SearchParameters\n * @param {object|SearchParameters} newParameters existing parameters or partial\n * object for the properties of a new SearchParameters\n * @return {SearchParameters} frozen instance of SearchParameters\n */\nSearchParameters.make = function makeSearchParameters(newParameters) {\n  var instance = new SearchParameters(newParameters);\n\n  var hierarchicalFacets = newParameters.hierarchicalFacets || [];\n  hierarchicalFacets.forEach(function (facet) {\n    if (facet.rootPath) {\n      var currentRefinement = instance.getHierarchicalRefinement(facet.name);\n\n      if (\n        currentRefinement.length > 0 &&\n        currentRefinement[0].indexOf(facet.rootPath) !== 0\n      ) {\n        instance = instance.clearRefinements(facet.name);\n      }\n\n      // get it again in case it has been cleared\n      currentRefinement = instance.getHierarchicalRefinement(facet.name);\n      if (currentRefinement.length === 0) {\n        instance = instance.toggleHierarchicalFacetRefinement(\n          facet.name,\n          facet.rootPath\n        );\n      }\n    }\n  });\n\n  return instance;\n};\n\n/**\n * Validates the new parameters based on the previous state\n * @param {SearchParameters} currentState the current state\n * @param {object|SearchParameters} parameters the new parameters to set\n * @return {Error|null} Error if the modification is invalid, null otherwise\n */\nSearchParameters.validate = function (currentState, parameters) {\n  var params = parameters || {};\n\n  if (\n    currentState.tagFilters &&\n    params.tagRefinements &&\n    params.tagRefinements.length > 0\n  ) {\n    return new Error(\n      '[Tags] Cannot switch from the managed tag API to the advanced API. It is probably ' +\n        'an error, if it is really what you want, you should first clear the tags with clearTags method.'\n    );\n  }\n\n  if (currentState.tagRefinements.length > 0 && params.tagFilters) {\n    return new Error(\n      '[Tags] Cannot switch from the advanced tag API to the managed API. It is probably ' +\n        'an error, if it is not, you should first clear the tags with clearTags method.'\n    );\n  }\n\n  if (\n    currentState.numericFilters &&\n    params.numericRefinements &&\n    objectHasKeys(params.numericRefinements)\n  ) {\n    return new Error(\n      \"[Numeric filters] Can't switch from the advanced to the managed API. It\" +\n        ' is probably an error, if this is really what you want, you have to first' +\n        ' clear the numeric filters.'\n    );\n  }\n\n  if (objectHasKeys(currentState.numericRefinements) && params.numericFilters) {\n    return new Error(\n      \"[Numeric filters] Can't switch from the managed API to the advanced. It\" +\n        ' is probably an error, if this is really what you want, you have to first' +\n        ' clear the numeric filters.'\n    );\n  }\n\n  return null;\n};\n\nSearchParameters.prototype = {\n  constructor: SearchParameters,\n\n  /**\n   * Remove all refinements (disjunctive + conjunctive + excludes + numeric filters)\n   * @method\n   * @param {undefined|string|SearchParameters.clearCallback} [attribute] optional string or function\n   * - If not given, means to clear all the filters.\n   * - If `string`, means to clear all refinements for the `attribute` named filter.\n   * - If `function`, means to clear all the refinements that return truthy values.\n   * @return {SearchParameters} new instance with filters cleared\n   */\n  clearRefinements: function clearRefinements(attribute) {\n    var patch = {\n      numericRefinements: this._clearNumericRefinements(attribute),\n      facetsRefinements: RefinementList.clearRefinement(\n        this.facetsRefinements,\n        attribute,\n        'conjunctiveFacet'\n      ),\n      facetsExcludes: RefinementList.clearRefinement(\n        this.facetsExcludes,\n        attribute,\n        'exclude'\n      ),\n      disjunctiveFacetsRefinements: RefinementList.clearRefinement(\n        this.disjunctiveFacetsRefinements,\n        attribute,\n        'disjunctiveFacet'\n      ),\n      hierarchicalFacetsRefinements: RefinementList.clearRefinement(\n        this.hierarchicalFacetsRefinements,\n        attribute,\n        'hierarchicalFacet'\n      ),\n    };\n    if (\n      patch.numericRefinements === this.numericRefinements &&\n      patch.facetsRefinements === this.facetsRefinements &&\n      patch.facetsExcludes === this.facetsExcludes &&\n      patch.disjunctiveFacetsRefinements ===\n        this.disjunctiveFacetsRefinements &&\n      patch.hierarchicalFacetsRefinements === this.hierarchicalFacetsRefinements\n    ) {\n      return this;\n    }\n    return this.setQueryParameters(patch);\n  },\n  /**\n   * Remove all the refined tags from the SearchParameters\n   * @method\n   * @return {SearchParameters} new instance with tags cleared\n   */\n  clearTags: function clearTags() {\n    if (this.tagFilters === undefined && this.tagRefinements.length === 0)\n      return this;\n\n    return this.setQueryParameters({\n      tagFilters: undefined,\n      tagRefinements: [],\n    });\n  },\n  /**\n   * Set the index.\n   * @method\n   * @param {string} index the index name\n   * @return {SearchParameters} new instance\n   */\n  setIndex: function setIndex(index) {\n    if (index === this.index) return this;\n\n    return this.setQueryParameters({\n      index: index,\n    });\n  },\n  /**\n   * Query setter\n   * @method\n   * @param {string} newQuery value for the new query\n   * @return {SearchParameters} new instance\n   */\n  setQuery: function setQuery(newQuery) {\n    if (newQuery === this.query) return this;\n\n    return this.setQueryParameters({\n      query: newQuery,\n    });\n  },\n  /**\n   * Page setter\n   * @method\n   * @param {number} newPage new page number\n   * @return {SearchParameters} new instance\n   */\n  setPage: function setPage(newPage) {\n    if (newPage === this.page) return this;\n\n    return this.setQueryParameters({\n      page: newPage,\n    });\n  },\n  /**\n   * Facets setter\n   * The facets are the simple facets, used for conjunctive (and) faceting.\n   * @method\n   * @param {string[]} facets all the attributes of the algolia records used for conjunctive faceting\n   * @return {SearchParameters} new instance\n   */\n  setFacets: function setFacets(facets) {\n    return this.setQueryParameters({\n      facets: facets,\n    });\n  },\n  /**\n   * Disjunctive facets setter\n   * Change the list of disjunctive (or) facets the helper chan handle.\n   * @method\n   * @param {string[]} facets all the attributes of the algolia records used for disjunctive faceting\n   * @return {SearchParameters} new instance\n   */\n  setDisjunctiveFacets: function setDisjunctiveFacets(facets) {\n    return this.setQueryParameters({\n      disjunctiveFacets: facets,\n    });\n  },\n  /**\n   * HitsPerPage setter\n   * Hits per page represents the number of hits retrieved for this query\n   * @method\n   * @param {number} n number of hits retrieved per page of results\n   * @return {SearchParameters} new instance\n   */\n  setHitsPerPage: function setHitsPerPage(n) {\n    if (this.hitsPerPage === n) return this;\n\n    return this.setQueryParameters({\n      hitsPerPage: n,\n    });\n  },\n  /**\n   * typoTolerance setter\n   * Set the value of typoTolerance\n   * @method\n   * @param {string} typoTolerance new value of typoTolerance (\"true\", \"false\", \"min\" or \"strict\")\n   * @return {SearchParameters} new instance\n   */\n  setTypoTolerance: function setTypoTolerance(typoTolerance) {\n    if (this.typoTolerance === typoTolerance) return this;\n\n    return this.setQueryParameters({\n      typoTolerance: typoTolerance,\n    });\n  },\n  /**\n   * Add a numeric filter for a given attribute\n   * When value is an array, they are combined with OR\n   * When value is a single value, it will combined with AND\n   * @method\n   * @param {string} attribute attribute to set the filter on\n   * @param {string} operator operator of the filter (possible values: =, >, >=, <, <=, !=)\n   * @param {number | number[]} value value of the filter\n   * @return {SearchParameters} new instance\n   * @example\n   * // for price = 50 or 40\n   * state.addNumericRefinement('price', '=', [50, 40]);\n   * @example\n   * // for size = 38 and 40\n   * state.addNumericRefinement('size', '=', 38);\n   * state.addNumericRefinement('size', '=', 40);\n   */\n  addNumericRefinement: function (attribute, operator, value) {\n    var val = valToNumber(value);\n\n    if (this.isNumericRefined(attribute, operator, val)) return this;\n\n    var mod = merge({}, this.numericRefinements);\n\n    mod[attribute] = merge({}, mod[attribute]);\n\n    if (mod[attribute][operator]) {\n      // Array copy\n      mod[attribute][operator] = mod[attribute][operator].slice();\n      // Add the element. Concat can't be used here because value can be an array.\n      mod[attribute][operator].push(val);\n    } else {\n      mod[attribute][operator] = [val];\n    }\n\n    return this.setQueryParameters({\n      numericRefinements: mod,\n    });\n  },\n  /**\n   * Get the list of conjunctive refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getConjunctiveRefinements: function (facetName) {\n    if (!this.isConjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.facetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of disjunctive refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getDisjunctiveRefinements: function (facetName) {\n    if (!this.isDisjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.disjunctiveFacetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of hierarchical refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getHierarchicalRefinement: function (facetName) {\n    // we send an array but we currently do not support multiple\n    // hierarchicalRefinements for a hierarchicalFacet\n    return this.hierarchicalFacetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of exclude refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getExcludeRefinements: function (facetName) {\n    if (!this.isConjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.facetsExcludes[facetName] || [];\n  },\n\n  /**\n   * Remove all the numeric filter for a given (attribute, operator)\n   * @method\n   * @param {string} attribute attribute to set the filter on\n   * @param {string} [operator] operator of the filter (possible values: =, >, >=, <, <=, !=)\n   * @param {number} [number] the value to be removed\n   * @return {SearchParameters} new instance\n   */\n  removeNumericRefinement: function (attribute, operator, number) {\n    var paramValue = number;\n    if (paramValue !== undefined) {\n      if (!this.isNumericRefined(attribute, operator, paramValue)) {\n        return this;\n      }\n      return this.setQueryParameters({\n        numericRefinements: this._clearNumericRefinements(function (\n          value,\n          key\n        ) {\n          return (\n            key === attribute &&\n            value.op === operator &&\n            isEqualNumericRefinement(value.val, valToNumber(paramValue))\n          );\n        }),\n      });\n    } else if (operator !== undefined) {\n      if (!this.isNumericRefined(attribute, operator)) return this;\n      return this.setQueryParameters({\n        numericRefinements: this._clearNumericRefinements(function (\n          value,\n          key\n        ) {\n          return key === attribute && value.op === operator;\n        }),\n      });\n    }\n\n    if (!this.isNumericRefined(attribute)) return this;\n    return this.setQueryParameters({\n      numericRefinements: this._clearNumericRefinements(function (value, key) {\n        return key === attribute;\n      }),\n    });\n  },\n  /**\n   * Get the list of numeric refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {SearchParameters.OperatorList} list of refinements\n   */\n  getNumericRefinements: function (facetName) {\n    return this.numericRefinements[facetName] || {};\n  },\n  /**\n   * Return the current refinement for the (attribute, operator)\n   * @param {string} attribute attribute in the record\n   * @param {string} operator operator applied on the refined values\n   * @return {Array.<number|number[]>} refined values\n   */\n  getNumericRefinement: function (attribute, operator) {\n    return (\n      this.numericRefinements[attribute] &&\n      this.numericRefinements[attribute][operator]\n    );\n  },\n  /**\n   * Clear numeric filters.\n   * @method\n   * @private\n   * @param {string|SearchParameters.clearCallback} [attribute] optional string or function\n   * - If not given, means to clear all the filters.\n   * - If `string`, means to clear all refinements for the `attribute` named filter.\n   * - If `function`, means to clear all the refinements that return truthy values.\n   * @return {Object.<string, OperatorList>} new numeric refinements\n   */\n  _clearNumericRefinements: function _clearNumericRefinements(attribute) {\n    if (attribute === undefined) {\n      if (!objectHasKeys(this.numericRefinements)) {\n        return this.numericRefinements;\n      }\n      return {};\n    } else if (typeof attribute === 'string') {\n      return omit(this.numericRefinements, [attribute]);\n    } else if (typeof attribute === 'function') {\n      var hasChanged = false;\n      var numericRefinements = this.numericRefinements;\n      var newNumericRefinements = Object.keys(numericRefinements).reduce(\n        function (memo, key) {\n          var operators = numericRefinements[key];\n          var operatorList = {};\n\n          operators = operators || {};\n          Object.keys(operators).forEach(function (operator) {\n            var values = operators[operator] || [];\n            var outValues = [];\n            values.forEach(function (value) {\n              var predicateResult = attribute(\n                { val: value, op: operator },\n                key,\n                'numeric'\n              );\n              if (!predicateResult) outValues.push(value);\n            });\n            if (outValues.length !== values.length) {\n              hasChanged = true;\n            }\n            operatorList[operator] = outValues;\n          });\n\n          memo[key] = operatorList;\n\n          return memo;\n        },\n        {}\n      );\n\n      if (hasChanged) return newNumericRefinements;\n      return this.numericRefinements;\n    }\n\n    // We return nothing if the attribute is not undefined, a string or a function,\n    // as it is not a valid value for a refinement\n    return undefined;\n  },\n  /**\n   * Add a facet to the facets attribute of the helper configuration, if it\n   * isn't already present.\n   * @method\n   * @param {string} facet facet name to add\n   * @return {SearchParameters} new instance\n   */\n  addFacet: function addFacet(facet) {\n    if (this.isConjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.setQueryParameters({\n      facets: this.facets.concat([facet]),\n    });\n  },\n  /**\n   * Add a disjunctive facet to the disjunctiveFacets attribute of the helper\n   * configuration, if it isn't already present.\n   * @method\n   * @param {string} facet disjunctive facet name to add\n   * @return {SearchParameters} new instance\n   */\n  addDisjunctiveFacet: function addDisjunctiveFacet(facet) {\n    if (this.isDisjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.setQueryParameters({\n      disjunctiveFacets: this.disjunctiveFacets.concat([facet]),\n    });\n  },\n  /**\n   * Add a hierarchical facet to the hierarchicalFacets attribute of the helper\n   * configuration.\n   * @method\n   * @param {object} hierarchicalFacet hierarchical facet to add\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if a hierarchical facet with the same name was already declared\n   */\n  addHierarchicalFacet: function addHierarchicalFacet(hierarchicalFacet) {\n    if (this.isHierarchicalFacet(hierarchicalFacet.name)) {\n      throw new Error(\n        'Cannot declare two hierarchical facets with the same name: `' +\n          hierarchicalFacet.name +\n          '`'\n      );\n    }\n\n    return this.setQueryParameters({\n      hierarchicalFacets: this.hierarchicalFacets.concat([hierarchicalFacet]),\n    });\n  },\n  /**\n   * Add a refinement on a \"normal\" facet\n   * @method\n   * @param {string} facet attribute to apply the faceting on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addFacetRefinement: function addFacetRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (RefinementList.isRefined(this.facetsRefinements, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.addRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Exclude a value from a \"normal\" facet\n   * @method\n   * @param {string} facet attribute to apply the exclusion on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addExcludeRefinement: function addExcludeRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (RefinementList.isRefined(this.facetsExcludes, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.addRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Adds a refinement on a disjunctive facet.\n   * @method\n   * @param {string} facet attribute to apply the faceting on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addDisjunctiveFacetRefinement: function addDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n\n    if (\n      RefinementList.isRefined(this.disjunctiveFacetsRefinements, facet, value)\n    )\n      return this;\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.addRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * addTagRefinement adds a tag to the list used to filter the results\n   * @param {string} tag tag to be added\n   * @return {SearchParameters} new instance\n   */\n  addTagRefinement: function addTagRefinement(tag) {\n    if (this.isTagRefined(tag)) return this;\n\n    var modification = {\n      tagRefinements: this.tagRefinements.concat(tag),\n    };\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Remove a facet from the facets attribute of the helper configuration, if it\n   * is present.\n   * @method\n   * @param {string} facet facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeFacet: function removeFacet(facet) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      facets: this.facets.filter(function (f) {\n        return f !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a disjunctive facet from the disjunctiveFacets attribute of the\n   * helper configuration, if it is present.\n   * @method\n   * @param {string} facet disjunctive facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeDisjunctiveFacet: function removeDisjunctiveFacet(facet) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      disjunctiveFacets: this.disjunctiveFacets.filter(function (f) {\n        return f !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a hierarchical facet from the hierarchicalFacets attribute of the\n   * helper configuration, if it is present.\n   * @method\n   * @param {string} facet hierarchical facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeHierarchicalFacet: function removeHierarchicalFacet(facet) {\n    if (!this.isHierarchicalFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      hierarchicalFacets: this.hierarchicalFacets.filter(function (f) {\n        return f.name !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a refinement set on facet. If a value is provided, it will clear the\n   * refinement for the given value, otherwise it will clear all the refinement\n   * values for the faceted attribute.\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} [value] value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeFacetRefinement: function removeFacetRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (!RefinementList.isRefined(this.facetsRefinements, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.removeRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a negative refinement on a facet\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} value value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeExcludeRefinement: function removeExcludeRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (!RefinementList.isRefined(this.facetsExcludes, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.removeRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a refinement on a disjunctive facet\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} value value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeDisjunctiveFacetRefinement: function removeDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n    if (\n      !RefinementList.isRefined(this.disjunctiveFacetsRefinements, facet, value)\n    )\n      return this;\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.removeRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a tag from the list of tag refinements\n   * @method\n   * @param {string} tag the tag to remove\n   * @return {SearchParameters} new instance\n   */\n  removeTagRefinement: function removeTagRefinement(tag) {\n    if (!this.isTagRefined(tag)) return this;\n\n    var modification = {\n      tagRefinements: this.tagRefinements.filter(function (t) {\n        return t !== tag;\n      }),\n    };\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Generic toggle refinement method to use with facet, disjunctive facets\n   * and hierarchical facets\n   * @param  {string} facet the facet to refine\n   * @param  {string} value the associated value\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if the facet is not declared in the settings of the helper\n   * @deprecated since version 2.19.0, see {@link SearchParameters#toggleFacetRefinement}\n   */\n  toggleRefinement: function toggleRefinement(facet, value) {\n    return this.toggleFacetRefinement(facet, value);\n  },\n  /**\n   * Generic toggle refinement method to use with facet, disjunctive facets\n   * and hierarchical facets\n   * @param  {string} facet the facet to refine\n   * @param  {string} value the associated value\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if the facet is not declared in the settings of the helper\n   */\n  toggleFacetRefinement: function toggleFacetRefinement(facet, value) {\n    if (this.isHierarchicalFacet(facet)) {\n      return this.toggleHierarchicalFacetRefinement(facet, value);\n    } else if (this.isConjunctiveFacet(facet)) {\n      return this.toggleConjunctiveFacetRefinement(facet, value);\n    } else if (this.isDisjunctiveFacet(facet)) {\n      return this.toggleDisjunctiveFacetRefinement(facet, value);\n    }\n\n    throw new Error(\n      'Cannot refine the undeclared facet ' +\n        facet +\n        '; it should be added to the helper options facets, disjunctiveFacets or hierarchicalFacets'\n    );\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleConjunctiveFacetRefinement: function toggleConjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.toggleRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleExcludeFacetRefinement: function toggleExcludeFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.toggleRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleDisjunctiveFacetRefinement: function toggleDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.toggleRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleHierarchicalFacetRefinement: function toggleHierarchicalFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isHierarchicalFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the hierarchicalFacets attribute of the helper configuration'\n      );\n    }\n\n    var separator = this._getHierarchicalFacetSeparator(\n      this.getHierarchicalFacetByName(facet)\n    );\n\n    var mod = {};\n\n    var upOneOrMultipleLevel =\n      this.hierarchicalFacetsRefinements[facet] !== undefined &&\n      this.hierarchicalFacetsRefinements[facet].length > 0 &&\n      // remove current refinement:\n      // refinement was 'beer > IPA', call is toggleRefine('beer > IPA'), refinement should be `beer`\n      (this.hierarchicalFacetsRefinements[facet][0] === value ||\n        // remove a parent refinement of the current refinement:\n        //  - refinement was 'beer > IPA > Flying dog'\n        //  - call is toggleRefine('beer > IPA')\n        //  - refinement should be `beer`\n        this.hierarchicalFacetsRefinements[facet][0].indexOf(\n          value + separator\n        ) === 0);\n\n    if (upOneOrMultipleLevel) {\n      if (value.indexOf(separator) === -1) {\n        // go back to root level\n        mod[facet] = [];\n      } else {\n        mod[facet] = [value.slice(0, value.lastIndexOf(separator))];\n      }\n    } else {\n      mod[facet] = [value];\n    }\n\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n\n  /**\n   * Adds a refinement on a hierarchical facet.\n   * @param {string} facet the facet name\n   * @param {string} path the hierarchical facet path\n   * @return {SearchParameter} the new state\n   * @throws Error if the facet is not defined or if the facet is refined\n   */\n  addHierarchicalFacetRefinement: function (facet, path) {\n    if (this.isHierarchicalFacetRefined(facet)) {\n      throw new Error(facet + ' is already refined.');\n    }\n    if (!this.isHierarchicalFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the hierarchicalFacets attribute of the helper configuration.'\n      );\n    }\n    var mod = {};\n    mod[facet] = [path];\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n\n  /**\n   * Removes the refinement set on a hierarchical facet.\n   * @param {string} facet the facet name\n   * @return {SearchParameter} the new state\n   * @throws Error if the facet is not defined or if the facet is not refined\n   */\n  removeHierarchicalFacetRefinement: function (facet) {\n    if (!this.isHierarchicalFacetRefined(facet)) {\n      return this;\n    }\n    var mod = {};\n    mod[facet] = [];\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n  /**\n   * Switch the tag refinement\n   * @method\n   * @param {string} tag the tag to remove or add\n   * @return {SearchParameters} new instance\n   */\n  toggleTagRefinement: function toggleTagRefinement(tag) {\n    if (this.isTagRefined(tag)) {\n      return this.removeTagRefinement(tag);\n    }\n\n    return this.addTagRefinement(tag);\n  },\n  /**\n   * Test if the facet name is from one of the disjunctive facets\n   * @method\n   * @param {string} facet facet name to test\n   * @return {boolean} true if facet is a disjunctive facet\n   */\n  isDisjunctiveFacet: function (facet) {\n    return this.disjunctiveFacets.indexOf(facet) > -1;\n  },\n  /**\n   * Test if the facet name is from one of the hierarchical facets\n   * @method\n   * @param {string} facetName facet name to test\n   * @return {boolean} true if facetName is a hierarchical facet\n   */\n  isHierarchicalFacet: function (facetName) {\n    return this.getHierarchicalFacetByName(facetName) !== undefined;\n  },\n  /**\n   * Test if the facet name is from one of the conjunctive/normal facets\n   * @method\n   * @param {string} facet facet name to test\n   * @return {boolean} true if facet is a conjunctive facet\n   */\n  isConjunctiveFacet: function (facet) {\n    return this.facets.indexOf(facet) > -1;\n  },\n  /**\n   * Returns true if the facet is refined, either for a specific value or in\n   * general.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value, optional value. If passed will test that this value\n   * is filtering the given facet.\n   * @return {boolean} returns true if refined\n   */\n  isFacetRefined: function isFacetRefined(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(this.facetsRefinements, facet, value);\n  },\n  /**\n   * Returns true if the facet contains exclusions or if a specific value is\n   * excluded.\n   *\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} [value] optional value. If passed will test that this value\n   * is filtering the given facet.\n   * @return {boolean} returns true if refined\n   */\n  isExcludeRefined: function isExcludeRefined(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(this.facetsExcludes, facet, value);\n  },\n  /**\n   * Returns true if the facet contains a refinement, or if a value passed is a\n   * refinement for the facet.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value optional, will test if the value is used for refinement\n   * if there is one, otherwise will test if the facet contains any refinement\n   * @return {boolean} true if the facet is refined\n   */\n  isDisjunctiveFacetRefined: function isDisjunctiveFacetRefined(facet, value) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(\n      this.disjunctiveFacetsRefinements,\n      facet,\n      value\n    );\n  },\n  /**\n   * Returns true if the facet contains a refinement, or if a value passed is a\n   * refinement for the facet.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value optional, will test if the value is used for refinement\n   * if there is one, otherwise will test if the facet contains any refinement\n   * @return {boolean} true if the facet is refined\n   */\n  isHierarchicalFacetRefined: function isHierarchicalFacetRefined(\n    facet,\n    value\n  ) {\n    if (!this.isHierarchicalFacet(facet)) {\n      return false;\n    }\n\n    var refinements = this.getHierarchicalRefinement(facet);\n\n    if (!value) {\n      return refinements.length > 0;\n    }\n\n    return refinements.indexOf(value) !== -1;\n  },\n  /**\n   * Test if the triple (attribute, operator, value) is already refined.\n   * If only the attribute and the operator are provided, it tests if the\n   * contains any refinement value.\n   * @method\n   * @param {string} attribute attribute for which the refinement is applied\n   * @param {string} [operator] operator of the refinement\n   * @param {string} [value] value of the refinement\n   * @return {boolean} true if it is refined\n   */\n  isNumericRefined: function isNumericRefined(attribute, operator, value) {\n    if (value === undefined && operator === undefined) {\n      return Boolean(this.numericRefinements[attribute]);\n    }\n\n    var isOperatorDefined =\n      this.numericRefinements[attribute] &&\n      this.numericRefinements[attribute][operator] !== undefined;\n\n    if (value === undefined || !isOperatorDefined) {\n      return isOperatorDefined;\n    }\n\n    var parsedValue = valToNumber(value);\n    var isAttributeValueDefined =\n      findArray(this.numericRefinements[attribute][operator], parsedValue) !==\n      undefined;\n\n    return isOperatorDefined && isAttributeValueDefined;\n  },\n  /**\n   * Returns true if the tag refined, false otherwise\n   * @method\n   * @param {string} tag the tag to check\n   * @return {boolean} true if tag is refined\n   */\n  isTagRefined: function isTagRefined(tag) {\n    return this.tagRefinements.indexOf(tag) !== -1;\n  },\n  /**\n   * Returns the list of all disjunctive facets refined\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {string[]} returns the list of refinements\n   */\n  getRefinedDisjunctiveFacets: function getRefinedDisjunctiveFacets() {\n    // eslint-disable-next-line consistent-this\n    var self = this;\n\n    // attributes used for numeric filter can also be disjunctive\n    var disjunctiveNumericRefinedFacets = intersection(\n      Object.keys(this.numericRefinements).filter(function (facet) {\n        return Object.keys(self.numericRefinements[facet]).length > 0;\n      }),\n      this.disjunctiveFacets\n    );\n\n    return Object.keys(this.disjunctiveFacetsRefinements)\n      .filter(function (facet) {\n        return self.disjunctiveFacetsRefinements[facet].length > 0;\n      })\n      .concat(disjunctiveNumericRefinedFacets)\n      .concat(this.getRefinedHierarchicalFacets())\n      .sort();\n  },\n  /**\n   * Returns the list of all disjunctive facets refined\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {string[]} returns the list of refinements\n   */\n  getRefinedHierarchicalFacets: function getRefinedHierarchicalFacets() {\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    return intersection(\n      // enforce the order between the two arrays,\n      // so that refinement name index === hierarchical facet index\n      this.hierarchicalFacets.map(function (facet) {\n        return facet.name;\n      }),\n      Object.keys(this.hierarchicalFacetsRefinements).filter(function (facet) {\n        return self.hierarchicalFacetsRefinements[facet].length > 0;\n      })\n    ).sort();\n  },\n  /**\n   * Returned the list of all disjunctive facets not refined\n   * @method\n   * @return {string[]} returns the list of facets that are not refined\n   */\n  getUnrefinedDisjunctiveFacets: function () {\n    var refinedFacets = this.getRefinedDisjunctiveFacets();\n\n    return this.disjunctiveFacets.filter(function (f) {\n      return refinedFacets.indexOf(f) === -1;\n    });\n  },\n\n  managedParameters: [\n    'index',\n\n    'facets',\n    'disjunctiveFacets',\n    'facetsRefinements',\n    'hierarchicalFacets',\n    'facetsExcludes',\n\n    'disjunctiveFacetsRefinements',\n    'numericRefinements',\n    'tagRefinements',\n    'hierarchicalFacetsRefinements',\n  ],\n\n  getQueryParams: function getQueryParams() {\n    var managedParameters = this.managedParameters;\n\n    var queryParams = {};\n\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    Object.keys(this).forEach(function (paramName) {\n      var paramValue = self[paramName];\n      if (\n        managedParameters.indexOf(paramName) === -1 &&\n        paramValue !== undefined\n      ) {\n        queryParams[paramName] = paramValue;\n      }\n    });\n\n    return queryParams;\n  },\n  /**\n   * Let the user set a specific value for a given parameter. Will return the\n   * same instance if the parameter is invalid or if the value is the same as the\n   * previous one.\n   * @method\n   * @param {string} parameter the parameter name\n   * @param {any} value the value to be set, must be compliant with the definition\n   * of the attribute on the object\n   * @return {SearchParameters} the updated state\n   */\n  setQueryParameter: function setParameter(parameter, value) {\n    if (this[parameter] === value) return this;\n\n    var modification = {};\n\n    modification[parameter] = value;\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Let the user set any of the parameters with a plain object.\n   * @method\n   * @param {object} params all the keys and the values to be updated\n   * @return {SearchParameters} a new updated instance\n   */\n  setQueryParameters: function setQueryParameters(params) {\n    if (!params) return this;\n\n    var error = SearchParameters.validate(this, params);\n\n    if (error) {\n      throw error;\n    }\n\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    var nextWithNumbers = SearchParameters._parseNumbers(params);\n    var previousPlainObject = Object.keys(this).reduce(function (acc, key) {\n      acc[key] = self[key];\n      return acc;\n    }, {});\n\n    var nextPlainObject = Object.keys(nextWithNumbers).reduce(function (\n      previous,\n      key\n    ) {\n      var isPreviousValueDefined = previous[key] !== undefined;\n      var isNextValueDefined = nextWithNumbers[key] !== undefined;\n\n      if (isPreviousValueDefined && !isNextValueDefined) {\n        return omit(previous, [key]);\n      }\n\n      if (isNextValueDefined) {\n        previous[key] = nextWithNumbers[key];\n      }\n\n      return previous;\n    },\n    previousPlainObject);\n\n    return new this.constructor(nextPlainObject);\n  },\n\n  /**\n   * Returns a new instance with the page reset. Two scenarios possible:\n   * the page is omitted -> return the given instance\n   * the page is set -> return a new instance with a page of 0\n   * @return {SearchParameters} a new updated instance\n   */\n  resetPage: function () {\n    if (this.page === undefined) {\n      return this;\n    }\n\n    return this.setPage(0);\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet separator or the default one (`>`)\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.separator or `>` as default\n   */\n  _getHierarchicalFacetSortBy: function (hierarchicalFacet) {\n    return hierarchicalFacet.sortBy || ['isRefined:desc', 'name:asc'];\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet separator or the default one (`>`)\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.separator or `>` as default\n   */\n  _getHierarchicalFacetSeparator: function (hierarchicalFacet) {\n    return hierarchicalFacet.separator || ' > ';\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet prefix path or null\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.rootPath or null as default\n   */\n  _getHierarchicalRootPath: function (hierarchicalFacet) {\n    return hierarchicalFacet.rootPath || null;\n  },\n\n  /**\n   * Helper function to check if we show the parent level of the hierarchicalFacet\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.showParentLevel or true as default\n   */\n  _getHierarchicalShowParentLevel: function (hierarchicalFacet) {\n    if (typeof hierarchicalFacet.showParentLevel === 'boolean') {\n      return hierarchicalFacet.showParentLevel;\n    }\n    return true;\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet by it's name\n   * @param  {string} hierarchicalFacetName the hierarchicalFacet name\n   * @return {object} a hierarchicalFacet\n   */\n  getHierarchicalFacetByName: function (hierarchicalFacetName) {\n    return find(this.hierarchicalFacets, function (f) {\n      return f.name === hierarchicalFacetName;\n    });\n  },\n\n  /**\n   * Get the current breadcrumb for a hierarchical facet, as an array\n   * @param  {string} facetName Hierarchical facet name\n   * @return {array.<string>} the path as an array of string\n   */\n  getHierarchicalFacetBreadcrumb: function (facetName) {\n    if (!this.isHierarchicalFacet(facetName)) {\n      return [];\n    }\n\n    var refinement = this.getHierarchicalRefinement(facetName)[0];\n    if (!refinement) return [];\n\n    var separator = this._getHierarchicalFacetSeparator(\n      this.getHierarchicalFacetByName(facetName)\n    );\n    var path = refinement.split(separator);\n    return path.map(function (part) {\n      return part.trim();\n    });\n  },\n\n  toString: function () {\n    return JSON.stringify(this, null, 2);\n  },\n};\n\n/**\n * Callback used for clearRefinement method\n * @callback SearchParameters.clearCallback\n * @param {OperatorList|FacetList} value the value of the filter\n * @param {string} key the current attribute name\n * @param {string} type `numeric`, `disjunctiveFacet`, `conjunctiveFacet`, `hierarchicalFacet` or `exclude`\n * depending on the type of facet\n * @return {boolean} `true` if the element should be removed. `false` otherwise.\n */\nmodule.exports = SearchParameters;\n","'use strict';\n\nmodule.exports = generateTrees;\n\nvar fv = require('../functions/escapeFacetValue');\nvar find = require('../functions/find');\nvar prepareHierarchicalFacetSortBy = require('../functions/formatSort');\nvar orderBy = require('../functions/orderBy');\nvar escapeFacetValue = fv.escapeFacetValue;\nvar unescapeFacetValue = fv.unescapeFacetValue;\n\nfunction generateTrees(state) {\n  return function generate(hierarchicalFacetResult, hierarchicalFacetIndex) {\n    var hierarchicalFacet = state.hierarchicalFacets[hierarchicalFacetIndex];\n    var hierarchicalFacetRefinement =\n      (state.hierarchicalFacetsRefinements[hierarchicalFacet.name] &&\n        state.hierarchicalFacetsRefinements[hierarchicalFacet.name][0]) ||\n      '';\n    var hierarchicalSeparator =\n      state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    var hierarchicalRootPath =\n      state._getHierarchicalRootPath(hierarchicalFacet);\n    var hierarchicalShowParentLevel =\n      state._getHierarchicalShowParentLevel(hierarchicalFacet);\n    var sortBy = prepareHierarchicalFacetSortBy(\n      state._getHierarchicalFacetSortBy(hierarchicalFacet)\n    );\n\n    var rootExhaustive = hierarchicalFacetResult.every(function (facetResult) {\n      return facetResult.exhaustive;\n    });\n\n    var generateTreeFn = generateHierarchicalTree(\n      sortBy,\n      hierarchicalSeparator,\n      hierarchicalRootPath,\n      hierarchicalShowParentLevel,\n      hierarchicalFacetRefinement\n    );\n\n    var results = hierarchicalFacetResult;\n\n    if (hierarchicalRootPath) {\n      results = hierarchicalFacetResult.slice(\n        hierarchicalRootPath.split(hierarchicalSeparator).length\n      );\n    }\n\n    return results.reduce(generateTreeFn, {\n      name: state.hierarchicalFacets[hierarchicalFacetIndex].name,\n      count: null, // root level, no count\n      isRefined: true, // root level, always refined\n      path: null, // root level, no path\n      escapedValue: null,\n      exhaustive: rootExhaustive,\n      data: null,\n    });\n  };\n}\n\nfunction generateHierarchicalTree(\n  sortBy,\n  hierarchicalSeparator,\n  hierarchicalRootPath,\n  hierarchicalShowParentLevel,\n  currentRefinement\n) {\n  return function generateTree(\n    hierarchicalTree,\n    hierarchicalFacetResult,\n    currentHierarchicalLevel\n  ) {\n    var parent = hierarchicalTree;\n\n    if (currentHierarchicalLevel > 0) {\n      var level = 0;\n\n      parent = hierarchicalTree;\n\n      while (level < currentHierarchicalLevel) {\n        /**\n         * @type {object[]]} hierarchical data\n         */\n        var data = parent && Array.isArray(parent.data) ? parent.data : [];\n        parent = find(data, function (subtree) {\n          return subtree.isRefined;\n        });\n        level++;\n      }\n    }\n\n    // we found a refined parent, let's add current level data under it\n    if (parent) {\n      // filter values in case an object has multiple categories:\n      //   {\n      //     categories: {\n      //       level0: ['beers', 'bires'],\n      //       level1: ['beers > IPA', 'bires > Belges']\n      //     }\n      //   }\n      //\n      // If parent refinement is `beers`, then we do not want to have `bires > Belges`\n      // showing up\n\n      var picked = Object.keys(hierarchicalFacetResult.data)\n        .map(function (facetValue) {\n          return [facetValue, hierarchicalFacetResult.data[facetValue]];\n        })\n        .filter(function (tuple) {\n          var facetValue = tuple[0];\n          return onlyMatchingTree(\n            facetValue,\n            parent.path || hierarchicalRootPath,\n            currentRefinement,\n            hierarchicalSeparator,\n            hierarchicalRootPath,\n            hierarchicalShowParentLevel\n          );\n        });\n\n      parent.data = orderBy(\n        picked.map(function (tuple) {\n          var facetValue = tuple[0];\n          var facetCount = tuple[1];\n\n          return format(\n            facetCount,\n            facetValue,\n            hierarchicalSeparator,\n            unescapeFacetValue(currentRefinement),\n            hierarchicalFacetResult.exhaustive\n          );\n        }),\n        sortBy[0],\n        sortBy[1]\n      );\n    }\n\n    return hierarchicalTree;\n  };\n}\n\n// eslint-disable-next-line max-params\nfunction onlyMatchingTree(\n  facetValue,\n  parentPath,\n  currentRefinement,\n  hierarchicalSeparator,\n  hierarchicalRootPath,\n  hierarchicalShowParentLevel\n) {\n  // we want the facetValue is a child of hierarchicalRootPath\n  if (\n    hierarchicalRootPath &&\n    (facetValue.indexOf(hierarchicalRootPath) !== 0 ||\n      hierarchicalRootPath === facetValue)\n  ) {\n    return false;\n  }\n\n  // we always want root levels (only when there is no prefix path)\n  return (\n    (!hierarchicalRootPath &&\n      facetValue.indexOf(hierarchicalSeparator) === -1) ||\n    // if there is a rootPath, being root level mean 1 level under rootPath\n    (hierarchicalRootPath &&\n      facetValue.split(hierarchicalSeparator).length -\n        hierarchicalRootPath.split(hierarchicalSeparator).length ===\n        1) ||\n    // if current refinement is a root level and current facetValue is a root level,\n    // keep the facetValue\n    (facetValue.indexOf(hierarchicalSeparator) === -1 &&\n      currentRefinement.indexOf(hierarchicalSeparator) === -1) ||\n    // currentRefinement is a child of the facet value\n    currentRefinement.indexOf(facetValue) === 0 ||\n    // facetValue is a child of the current parent, add it\n    (facetValue.indexOf(parentPath + hierarchicalSeparator) === 0 &&\n      (hierarchicalShowParentLevel ||\n        facetValue.indexOf(currentRefinement) === 0))\n  );\n}\n\nfunction format(\n  facetCount,\n  facetValue,\n  hierarchicalSeparator,\n  currentRefinement,\n  exhaustive\n) {\n  var parts = facetValue.split(hierarchicalSeparator);\n  return {\n    name: parts[parts.length - 1].trim(),\n    path: facetValue,\n    escapedValue: escapeFacetValue(facetValue),\n    count: facetCount,\n    isRefined:\n      currentRefinement === facetValue ||\n      currentRefinement.indexOf(facetValue + hierarchicalSeparator) === 0,\n    exhaustive: exhaustive,\n    data: null,\n  };\n}\n","'use strict';\n\nvar compact = require('../functions/compact');\nvar defaultsPure = require('../functions/defaultsPure');\nvar fv = require('../functions/escapeFacetValue');\nvar find = require('../functions/find');\nvar findIndex = require('../functions/findIndex');\nvar formatSort = require('../functions/formatSort');\nvar merge = require('../functions/merge');\nvar orderBy = require('../functions/orderBy');\nvar escapeFacetValue = fv.escapeFacetValue;\nvar unescapeFacetValue = fv.unescapeFacetValue;\n\nvar generateHierarchicalTree = require('./generate-hierarchical-tree');\n\n/**\n * @typedef SearchResults.Facet\n * @type {object}\n * @property {string} name name of the attribute in the record\n * @property {object} data the faceting data: value, number of entries\n * @property {object} stats undefined unless facet_stats is retrieved from algolia\n */\n\n/**\n * @typedef SearchResults.HierarchicalFacet\n * @type {object}\n * @property {string} name name of the current value given the hierarchical level, trimmed.\n * If root node, you get the facet name\n * @property {number} count number of objects matching this hierarchical value\n * @property {string} path the current hierarchical value full path\n * @property {boolean} isRefined `true` if the current value was refined, `false` otherwise\n * @property {HierarchicalFacet[]} data sub values for the current level\n */\n\n/**\n * @typedef SearchResults.FacetValue\n * @type {object}\n * @property {string} name the facet value itself\n * @property {number} count times this facet appears in the results\n * @property {boolean} isRefined is the facet currently selected\n * @property {boolean} isExcluded is the facet currently excluded (only for conjunctive facets)\n */\n\n/**\n * @typedef Refinement\n * @type {object}\n * @property {string} type the type of filter used:\n * `numeric`, `facet`, `exclude`, `disjunctive`, `hierarchical`\n * @property {string} attributeName name of the attribute used for filtering\n * @property {string} name the value of the filter\n * @property {number} numericValue the value as a number. Only for numeric filters.\n * @property {string} operator the operator used. Only for numeric filters.\n * @property {number} count the number of computed hits for this filter. Only on facets.\n * @property {boolean} exhaustive if the count is exhaustive\n */\n\n/**\n * Turn an array of attributes in an object of attributes with their position in the array as value\n * @param {string[]} attributes the list of attributes in the record\n * @return {object} the list of attributes indexed by attribute name\n */\nfunction getIndices(attributes) {\n  var indices = {};\n\n  attributes.forEach(function (val, idx) {\n    indices[val] = idx;\n  });\n\n  return indices;\n}\n\nfunction assignFacetStats(dest, facetStats, key) {\n  if (facetStats && facetStats[key]) {\n    dest.stats = facetStats[key];\n  }\n}\n\n/**\n * @typedef {Object} HierarchicalFacet\n * @property {string} name\n * @property {string[]} attributes\n */\n\n/**\n * @param {HierarchicalFacet[]} hierarchicalFacets All hierarchical facets\n * @param {string} hierarchicalAttributeName The name of the hierarchical attribute\n * @return {HierarchicalFacet} The hierarchical facet matching the attribute name\n */\nfunction findMatchingHierarchicalFacetFromAttributeName(\n  hierarchicalFacets,\n  hierarchicalAttributeName\n) {\n  return find(\n    hierarchicalFacets,\n    function facetKeyMatchesAttribute(hierarchicalFacet) {\n      var facetNames = hierarchicalFacet.attributes || [];\n      return facetNames.indexOf(hierarchicalAttributeName) > -1;\n    }\n  );\n}\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * Constructor for SearchResults\n * @class\n * @classdesc SearchResults contains the results of a query to Algolia using the\n * {@link AlgoliaSearchHelper}.\n * @param {SearchParameters} state state that led to the response\n * @param {array.<object>} results the results from algolia client\n * @example <caption>SearchResults of the first query in\n * <a href=\"http://demos.algolia.com/instant-search-demo\">the instant search demo</a></caption>\n{\n   \"hitsPerPage\": 10,\n   \"processingTimeMS\": 2,\n   \"facets\": [\n      {\n         \"name\": \"type\",\n         \"data\": {\n            \"HardGood\": 6627,\n            \"BlackTie\": 550,\n            \"Music\": 665,\n            \"Software\": 131,\n            \"Game\": 456,\n            \"Movie\": 1571\n         },\n         \"exhaustive\": false\n      },\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"Free shipping\": 5507\n         },\n         \"name\": \"shipping\"\n      }\n  ],\n   \"hits\": [\n      {\n         \"thumbnailImage\": \"http://img.bbystatic.com/BestBuy_US/images/products/1688/1688832_54x108_s.gif\",\n         \"_highlightResult\": {\n            \"shortDescription\": {\n               \"matchLevel\": \"none\",\n               \"value\": \"Safeguard your PC, Mac, Android and iOS devices with comprehensive Internet protection\",\n               \"matchedWords\": []\n            },\n            \"category\": {\n               \"matchLevel\": \"none\",\n               \"value\": \"Computer Security Software\",\n               \"matchedWords\": []\n            },\n            \"manufacturer\": {\n               \"matchedWords\": [],\n               \"value\": \"Webroot\",\n               \"matchLevel\": \"none\"\n            },\n            \"name\": {\n               \"value\": \"Webroot SecureAnywhere Internet Security (3-Device) (1-Year Subscription) - Mac/Windows\",\n               \"matchedWords\": [],\n               \"matchLevel\": \"none\"\n            }\n         },\n         \"image\": \"http://img.bbystatic.com/BestBuy_US/images/products/1688/1688832_105x210_sc.jpg\",\n         \"shipping\": \"Free shipping\",\n         \"bestSellingRank\": 4,\n         \"shortDescription\": \"Safeguard your PC, Mac, Android and iOS devices with comprehensive Internet protection\",\n         \"url\": \"http://www.bestbuy.com/site/webroot-secureanywhere-internet-security-3-devid=1219060687969&skuId=1688832&cmp=RMX&ky=2d3GfEmNIzjA0vkzveHdZEBgpPCyMnLTJ\",\n         \"name\": \"Webroot SecureAnywhere Internet Security (3-Device) (1-Year Subscription) - Mac/Windows\",\n         \"category\": \"Computer Security Software\",\n         \"salePrice_range\": \"1 - 50\",\n         \"objectID\": \"1688832\",\n         \"type\": \"Software\",\n         \"customerReviewCount\": 5980,\n         \"salePrice\": 49.99,\n         \"manufacturer\": \"Webroot\"\n      },\n      ....\n  ],\n   \"nbHits\": 10000,\n   \"disjunctiveFacets\": [\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"5\": 183,\n            \"12\": 112,\n            \"7\": 149,\n            ...\n         },\n         \"name\": \"customerReviewCount\",\n         \"stats\": {\n            \"max\": 7461,\n            \"avg\": 157.939,\n            \"min\": 1\n         }\n      },\n      {\n         \"data\": {\n            \"Printer Ink\": 142,\n            \"Wireless Speakers\": 60,\n            \"Point & Shoot Cameras\": 48,\n            ...\n         },\n         \"name\": \"category\",\n         \"exhaustive\": false\n      },\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"> 5000\": 2,\n            \"1 - 50\": 6524,\n            \"501 - 2000\": 566,\n            \"201 - 500\": 1501,\n            \"101 - 200\": 1360,\n            \"2001 - 5000\": 47\n         },\n         \"name\": \"salePrice_range\"\n      },\n      {\n         \"data\": {\n            \"Dynex\": 202,\n            \"Insignia\": 230,\n            \"PNY\": 72,\n            ...\n         },\n         \"name\": \"manufacturer\",\n         \"exhaustive\": false\n      }\n  ],\n   \"query\": \"\",\n   \"nbPages\": 100,\n   \"page\": 0,\n   \"index\": \"bestbuy\"\n}\n **/\nfunction SearchResults(state, results, options) {\n  var mainSubResponse = results[0];\n\n  this._rawResults = results;\n\n  // eslint-disable-next-line consistent-this\n  var self = this;\n\n  // https://www.algolia.com/doc/api-reference/api-methods/search/#response\n  Object.keys(mainSubResponse).forEach(function (key) {\n    self[key] = mainSubResponse[key];\n  });\n\n  // Make every key of the result options reachable from the instance\n  Object.keys(options || {}).forEach(function (key) {\n    self[key] = options[key];\n  });\n\n  /**\n   * query used to generate the results\n   * @name query\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * The query as parsed by the engine given all the rules.\n   * @name parsedQuery\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * all the records that match the search parameters. Each record is\n   * augmented with a new attribute `_highlightResult`\n   * which is an object keyed by attribute and with the following properties:\n   * - `value` : the value of the facet highlighted (html)\n   * - `matchLevel`: `full`, `partial` or `none`, depending on how the query terms match\n   * @name hits\n   * @member {object[]}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * index where the results come from\n   * @name index\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * number of hits per page requested\n   * @name hitsPerPage\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * total number of hits of this query on the index\n   * @name nbHits\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * total number of pages with respect to the number of hits per page and the total number of hits\n   * @name nbPages\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * current page\n   * @name page\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * The position if the position was guessed by IP.\n   * @name aroundLatLng\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"48.8637,2.3615\",\n   */\n  /**\n   * The radius computed by Algolia.\n   * @name automaticRadius\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"126792922\",\n   */\n  /**\n   * String identifying the server used to serve this request.\n   *\n   * getRankingInfo needs to be set to `true` for this to be returned\n   *\n   * @name serverUsed\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"c7-use-2.algolia.net\",\n   */\n  /**\n   * Boolean that indicates if the computation of the counts did time out.\n   * @deprecated\n   * @name timeoutCounts\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * Boolean that indicates if the computation of the hits did time out.\n   * @deprecated\n   * @name timeoutHits\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * True if the counts of the facets is exhaustive\n   * @name exhaustiveFacetsCount\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * True if the number of hits is exhaustive\n   * @name exhaustiveNbHits\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * Contains the userData if they are set by a [query rule](https://www.algolia.com/doc/guides/query-rules/query-rules-overview/).\n   * @name userData\n   * @member {object[]}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * queryID is the unique identifier of the query used to generate the current search results.\n   * This value is only available if the `clickAnalytics` search parameter is set to `true`.\n   * @name queryID\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n\n  /**\n   * sum of the processing time of all the queries\n   * @name processingTimeMS\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  this.processingTimeMS = results.reduce(function (sum, result) {\n    return result.processingTimeMS === undefined\n      ? sum\n      : sum + result.processingTimeMS;\n  }, 0);\n\n  /**\n   * disjunctive facets results\n   * @member {SearchResults.Facet[]}\n   */\n  this.disjunctiveFacets = [];\n  /**\n   * disjunctive facets results\n   * @member {SearchResults.HierarchicalFacet[]}\n   */\n  this.hierarchicalFacets = state.hierarchicalFacets.map(\n    function initFutureTree() {\n      return [];\n    }\n  );\n  /**\n   * other facets results\n   * @member {SearchResults.Facet[]}\n   */\n  this.facets = [];\n\n  var disjunctiveFacets = state.getRefinedDisjunctiveFacets();\n\n  var facetsIndices = getIndices(state.facets);\n  var disjunctiveFacetsIndices = getIndices(state.disjunctiveFacets);\n  var nextDisjunctiveResult = 1;\n\n  // Since we send request only for disjunctive facets that have been refined,\n  // we get the facets information from the first, general, response.\n\n  var mainFacets = mainSubResponse.facets || {};\n\n  Object.keys(mainFacets).forEach(function (facetKey) {\n    var facetValueObject = mainFacets[facetKey];\n\n    var hierarchicalFacet = findMatchingHierarchicalFacetFromAttributeName(\n      state.hierarchicalFacets,\n      facetKey\n    );\n\n    if (hierarchicalFacet) {\n      // Place the hierarchicalFacet data at the correct index depending on\n      // the attributes order that was defined at the helper initialization\n      var facetIndex = hierarchicalFacet.attributes.indexOf(facetKey);\n      var idxAttributeName = findIndex(state.hierarchicalFacets, function (f) {\n        return f.name === hierarchicalFacet.name;\n      });\n      self.hierarchicalFacets[idxAttributeName][facetIndex] = {\n        attribute: facetKey,\n        data: facetValueObject,\n        exhaustive: mainSubResponse.exhaustiveFacetsCount,\n      };\n    } else {\n      var isFacetDisjunctive = state.disjunctiveFacets.indexOf(facetKey) !== -1;\n      var isFacetConjunctive = state.facets.indexOf(facetKey) !== -1;\n      var position;\n\n      if (isFacetDisjunctive) {\n        position = disjunctiveFacetsIndices[facetKey];\n        self.disjunctiveFacets[position] = {\n          name: facetKey,\n          data: facetValueObject,\n          exhaustive: mainSubResponse.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.disjunctiveFacets[position],\n          mainSubResponse.facets_stats,\n          facetKey\n        );\n      }\n      if (isFacetConjunctive) {\n        position = facetsIndices[facetKey];\n        self.facets[position] = {\n          name: facetKey,\n          data: facetValueObject,\n          exhaustive: mainSubResponse.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.facets[position],\n          mainSubResponse.facets_stats,\n          facetKey\n        );\n      }\n    }\n  });\n\n  // Make sure we do not keep holes within the hierarchical facets\n  this.hierarchicalFacets = compact(this.hierarchicalFacets);\n\n  // aggregate the refined disjunctive facets\n  disjunctiveFacets.forEach(function (disjunctiveFacet) {\n    var result = results[nextDisjunctiveResult];\n    var facets = result && result.facets ? result.facets : {};\n    var hierarchicalFacet = state.getHierarchicalFacetByName(disjunctiveFacet);\n\n    // There should be only item in facets.\n    Object.keys(facets).forEach(function (dfacet) {\n      var facetResults = facets[dfacet];\n\n      var position;\n\n      if (hierarchicalFacet) {\n        position = findIndex(state.hierarchicalFacets, function (f) {\n          return f.name === hierarchicalFacet.name;\n        });\n        var attributeIndex = findIndex(\n          self.hierarchicalFacets[position],\n          function (f) {\n            return f.attribute === dfacet;\n          }\n        );\n\n        // previous refinements and no results so not able to find it\n        if (attributeIndex === -1) {\n          return;\n        }\n\n        self.hierarchicalFacets[position][attributeIndex].data = merge(\n          {},\n          self.hierarchicalFacets[position][attributeIndex].data,\n          facetResults\n        );\n      } else {\n        position = disjunctiveFacetsIndices[dfacet];\n\n        var dataFromMainRequest =\n          (mainSubResponse.facets && mainSubResponse.facets[dfacet]) || {};\n\n        self.disjunctiveFacets[position] = {\n          name: dfacet,\n          data: defaultsPure({}, facetResults, dataFromMainRequest),\n          exhaustive: result.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.disjunctiveFacets[position],\n          result.facets_stats,\n          dfacet\n        );\n\n        if (state.disjunctiveFacetsRefinements[dfacet]) {\n          state.disjunctiveFacetsRefinements[dfacet].forEach(function (\n            refinementValue\n          ) {\n            // add the disjunctive refinements if it is no more retrieved\n            if (\n              !self.disjunctiveFacets[position].data[refinementValue] &&\n              state.disjunctiveFacetsRefinements[dfacet].indexOf(\n                unescapeFacetValue(refinementValue)\n              ) > -1\n            ) {\n              self.disjunctiveFacets[position].data[refinementValue] = 0;\n            }\n          });\n        }\n      }\n    });\n    nextDisjunctiveResult++;\n  });\n\n  // if we have some parent level values for hierarchical facets, merge them\n  state.getRefinedHierarchicalFacets().forEach(function (refinedFacet) {\n    var hierarchicalFacet = state.getHierarchicalFacetByName(refinedFacet);\n    var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n\n    var currentRefinement = state.getHierarchicalRefinement(refinedFacet);\n    // if we are already at a root refinement (or no refinement at all), there is no\n    // root level values request\n    if (\n      currentRefinement.length === 0 ||\n      currentRefinement[0].split(separator).length < 2\n    ) {\n      return;\n    }\n\n    results.slice(nextDisjunctiveResult).forEach(function (result) {\n      var facets = result && result.facets ? result.facets : {};\n\n      Object.keys(facets).forEach(function (dfacet) {\n        var facetResults = facets[dfacet];\n        var position = findIndex(state.hierarchicalFacets, function (f) {\n          return f.name === hierarchicalFacet.name;\n        });\n        var attributeIndex = findIndex(\n          self.hierarchicalFacets[position],\n          function (f) {\n            return f.attribute === dfacet;\n          }\n        );\n\n        // previous refinements and no results so not able to find it\n        if (attributeIndex === -1) {\n          return;\n        }\n\n        // when we always get root levels, if the hits refinement is `beers > IPA` (count: 5),\n        // then the disjunctive values will be `beers` (count: 100),\n        // but we do not want to display\n        //   | beers (100)\n        //     > IPA (5)\n        // We want\n        //   | beers (5)\n        //     > IPA (5)\n        var defaultData = {};\n\n        if (currentRefinement.length > 0) {\n          var root = currentRefinement[0].split(separator)[0];\n          defaultData[root] =\n            self.hierarchicalFacets[position][attributeIndex].data[root];\n        }\n\n        self.hierarchicalFacets[position][attributeIndex].data = defaultsPure(\n          defaultData,\n          facetResults,\n          self.hierarchicalFacets[position][attributeIndex].data\n        );\n      });\n\n      nextDisjunctiveResult++;\n    });\n  });\n\n  // add the excludes\n  Object.keys(state.facetsExcludes).forEach(function (facetName) {\n    var excludes = state.facetsExcludes[facetName];\n    var position = facetsIndices[facetName];\n\n    self.facets[position] = {\n      name: facetName,\n      data: mainFacets[facetName],\n      exhaustive: mainSubResponse.exhaustiveFacetsCount,\n    };\n    excludes.forEach(function (facetValue) {\n      self.facets[position] = self.facets[position] || { name: facetName };\n      self.facets[position].data = self.facets[position].data || {};\n      self.facets[position].data[facetValue] = 0;\n    });\n  });\n\n  /**\n   * @type {Array}\n   */\n  this.hierarchicalFacets = this.hierarchicalFacets.map(\n    generateHierarchicalTree(state)\n  );\n\n  /**\n   * @type {Array}\n   */\n  this.facets = compact(this.facets);\n  /**\n   * @type {Array}\n   */\n  this.disjunctiveFacets = compact(this.disjunctiveFacets);\n\n  this._state = state;\n}\n\n/**\n * Get a facet object with its name\n * @deprecated\n * @param {string} name name of the faceted attribute\n * @return {SearchResults.Facet} the facet object\n */\nSearchResults.prototype.getFacetByName = function (name) {\n  function predicate(facet) {\n    return facet.name === name;\n  }\n\n  return (\n    find(this.facets, predicate) ||\n    find(this.disjunctiveFacets, predicate) ||\n    find(this.hierarchicalFacets, predicate)\n  );\n};\n\n/**\n * Get the facet values of a specified attribute from a SearchResults object.\n * @private\n * @param {SearchResults} results the search results to search in\n * @param {string} attribute name of the faceted attribute to search for\n * @return {array|object} facet values. For the hierarchical facets it is an object.\n */\nfunction extractNormalizedFacetValues(results, attribute) {\n  function predicate(facet) {\n    return facet.name === attribute;\n  }\n\n  if (results._state.isConjunctiveFacet(attribute)) {\n    var facet = find(results.facets, predicate);\n    if (!facet) return [];\n\n    return Object.keys(facet.data).map(function (name) {\n      var value = escapeFacetValue(name);\n      return {\n        name: name,\n        escapedValue: value,\n        count: facet.data[name],\n        isRefined: results._state.isFacetRefined(attribute, value),\n        isExcluded: results._state.isExcludeRefined(attribute, name),\n      };\n    });\n  } else if (results._state.isDisjunctiveFacet(attribute)) {\n    var disjunctiveFacet = find(results.disjunctiveFacets, predicate);\n    if (!disjunctiveFacet) return [];\n\n    return Object.keys(disjunctiveFacet.data).map(function (name) {\n      var value = escapeFacetValue(name);\n      return {\n        name: name,\n        escapedValue: value,\n        count: disjunctiveFacet.data[name],\n        isRefined: results._state.isDisjunctiveFacetRefined(attribute, value),\n      };\n    });\n  } else if (results._state.isHierarchicalFacet(attribute)) {\n    var hierarchicalFacetValues = find(results.hierarchicalFacets, predicate);\n    if (!hierarchicalFacetValues) return hierarchicalFacetValues;\n\n    var hierarchicalFacet =\n      results._state.getHierarchicalFacetByName(attribute);\n    var separator =\n      results._state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    var currentRefinement = unescapeFacetValue(\n      results._state.getHierarchicalRefinement(attribute)[0] || ''\n    );\n\n    if (currentRefinement.indexOf(hierarchicalFacet.rootPath) === 0) {\n      currentRefinement = currentRefinement.replace(\n        hierarchicalFacet.rootPath + separator,\n        ''\n      );\n    }\n\n    var currentRefinementSplit = currentRefinement.split(separator);\n    currentRefinementSplit.unshift(attribute);\n\n    setIsRefined(hierarchicalFacetValues, currentRefinementSplit, 0);\n\n    return hierarchicalFacetValues;\n  }\n\n  return undefined;\n}\n\n/**\n * Set the isRefined of a hierarchical facet result based on the current state.\n * @param {SearchResults.HierarchicalFacet} item Hierarchical facet to fix\n * @param {string[]} currentRefinement array of parts of the current hierarchical refinement\n * @param {number} depth recursion depth in the currentRefinement\n * @return {undefined} function mutates the item\n */\nfunction setIsRefined(item, currentRefinement, depth) {\n  item.isRefined = item.name === currentRefinement[depth];\n  if (item.data) {\n    item.data.forEach(function (child) {\n      setIsRefined(child, currentRefinement, depth + 1);\n    });\n  }\n}\n\n/**\n * Sort nodes of a hierarchical or disjunctive facet results\n * @private\n * @param {function} sortFn sort function to apply\n * @param {HierarchicalFacet|Array} node node upon which we want to apply the sort\n * @param {string[]} names attribute names\n * @param {number} [level=0] current index in the names array\n * @return {HierarchicalFacet|Array} sorted node\n */\nfunction recSort(sortFn, node, names, level) {\n  level = level || 0;\n\n  if (Array.isArray(node)) {\n    return sortFn(node, names[level]);\n  }\n\n  if (!node.data || node.data.length === 0) {\n    return node;\n  }\n\n  var children = node.data.map(function (childNode) {\n    return recSort(sortFn, childNode, names, level + 1);\n  });\n  var sortedChildren = sortFn(children, names[level]);\n  var newNode = defaultsPure({ data: sortedChildren }, node);\n  return newNode;\n}\n\nSearchResults.DEFAULT_SORT = ['isRefined:desc', 'count:desc', 'name:asc'];\n\nfunction vanillaSortFn(order, data) {\n  return data.sort(order);\n}\n\n/**\n * @typedef FacetOrdering\n * @type {Object}\n * @property {string[]} [order]\n * @property {'count' | 'alpha' | 'hidden'} [sortRemainingBy]\n */\n\n/**\n * Sorts facet arrays via their facet ordering\n * @param {Array} facetValues the values\n * @param {FacetOrdering} facetOrdering the ordering\n * @returns {Array} the sorted facet values\n */\nfunction sortViaFacetOrdering(facetValues, facetOrdering) {\n  var orderedFacets = [];\n  var remainingFacets = [];\n\n  var order = facetOrdering.order || [];\n  /**\n   * an object with the keys being the values in order, the values their index:\n   * ['one', 'two'] -> { one: 0, two: 1 }\n   */\n  var reverseOrder = order.reduce(function (acc, name, i) {\n    acc[name] = i;\n    return acc;\n  }, {});\n\n  facetValues.forEach(function (item) {\n    // hierarchical facets get sorted using their raw name\n    var name = item.path || item.name;\n    if (reverseOrder[name] !== undefined) {\n      orderedFacets[reverseOrder[name]] = item;\n    } else {\n      remainingFacets.push(item);\n    }\n  });\n\n  orderedFacets = orderedFacets.filter(function (facet) {\n    return facet;\n  });\n\n  var sortRemainingBy = facetOrdering.sortRemainingBy;\n  var ordering;\n  if (sortRemainingBy === 'hidden') {\n    return orderedFacets;\n  } else if (sortRemainingBy === 'alpha') {\n    ordering = [\n      ['path', 'name'],\n      ['asc', 'asc'],\n    ];\n  } else {\n    ordering = [['count'], ['desc']];\n  }\n\n  return orderedFacets.concat(\n    orderBy(remainingFacets, ordering[0], ordering[1])\n  );\n}\n\n/**\n * @param {SearchResults} results the search results class\n * @param {string} attribute the attribute to retrieve ordering of\n * @returns {FacetOrdering | undefined} the facet ordering\n */\nfunction getFacetOrdering(results, attribute) {\n  return (\n    results.renderingContent &&\n    results.renderingContent.facetOrdering &&\n    results.renderingContent.facetOrdering.values &&\n    results.renderingContent.facetOrdering.values[attribute]\n  );\n}\n\n/**\n * Get a the list of values for a given facet attribute. Those values are sorted\n * refinement first, descending count (bigger value on top), and name ascending\n * (alphabetical order). The sort formula can overridden using either string based\n * predicates or a function.\n *\n * This method will return all the values returned by the Algolia engine plus all\n * the values already refined. This means that it can happen that the\n * `maxValuesPerFacet` [configuration](https://www.algolia.com/doc/rest-api/search#param-maxValuesPerFacet)\n * might not be respected if you have facet values that are already refined.\n * @param {string} attribute attribute name\n * @param {object} opts configuration options.\n * @param {boolean} [opts.facetOrdering]\n * Force the use of facetOrdering from the result if a sortBy is present. If\n * sortBy isn't present, facetOrdering will be used automatically.\n * @param {Array.<string> | function} opts.sortBy\n * When using strings, it consists of\n * the name of the [FacetValue](#SearchResults.FacetValue) or the\n * [HierarchicalFacet](#SearchResults.HierarchicalFacet) attributes with the\n * order (`asc` or `desc`). For example to order the value by count, the\n * argument would be `['count:asc']`.\n *\n * If only the attribute name is specified, the ordering defaults to the one\n * specified in the default value for this attribute.\n *\n * When not specified, the order is\n * ascending.  This parameter can also be a function which takes two facet\n * values and should return a number, 0 if equal, 1 if the first argument is\n * bigger or -1 otherwise.\n *\n * The default value for this attribute `['isRefined:desc', 'count:desc', 'name:asc']`\n * @return {FacetValue[]|HierarchicalFacet|undefined} depending on the type of facet of\n * the attribute requested (hierarchical, disjunctive or conjunctive)\n * @example\n * helper.on('result', function(event){\n *   //get values ordered only by name ascending using the string predicate\n *   event.results.getFacetValues('city', {sortBy: ['name:asc']});\n *   //get values  ordered only by count ascending using a function\n *   event.results.getFacetValues('city', {\n *     // this is equivalent to ['count:asc']\n *     sortBy: function(a, b) {\n *       if (a.count === b.count) return 0;\n *       if (a.count > b.count)   return 1;\n *       if (b.count > a.count)   return -1;\n *     }\n *   });\n * });\n */\nSearchResults.prototype.getFacetValues = function (attribute, opts) {\n  var facetValues = extractNormalizedFacetValues(this, attribute);\n  if (!facetValues) {\n    return undefined;\n  }\n\n  var options = defaultsPure({}, opts, {\n    sortBy: SearchResults.DEFAULT_SORT,\n    // if no sortBy is given, attempt to sort based on facetOrdering\n    // if it is given, we still allow to sort via facet ordering first\n    facetOrdering: !(opts && opts.sortBy),\n  });\n\n  // eslint-disable-next-line consistent-this\n  var results = this;\n  var attributes;\n  if (Array.isArray(facetValues)) {\n    attributes = [attribute];\n  } else {\n    var config = results._state.getHierarchicalFacetByName(facetValues.name);\n    attributes = config.attributes;\n  }\n\n  return recSort(\n    function (data, facetName) {\n      if (options.facetOrdering) {\n        var facetOrdering = getFacetOrdering(results, facetName);\n        if (facetOrdering) {\n          return sortViaFacetOrdering(data, facetOrdering);\n        }\n      }\n\n      if (Array.isArray(options.sortBy)) {\n        var order = formatSort(options.sortBy, SearchResults.DEFAULT_SORT);\n        return orderBy(data, order[0], order[1]);\n      } else if (typeof options.sortBy === 'function') {\n        return vanillaSortFn(options.sortBy, data);\n      }\n      throw new Error(\n        'options.sortBy is optional but if defined it must be ' +\n          'either an array of string (predicates) or a sorting function'\n      );\n    },\n    facetValues,\n    attributes\n  );\n};\n\n/**\n * Returns the facet stats if attribute is defined and the facet contains some.\n * Otherwise returns undefined.\n * @param {string} attribute name of the faceted attribute\n * @return {object} The stats of the facet\n */\nSearchResults.prototype.getFacetStats = function (attribute) {\n  if (this._state.isConjunctiveFacet(attribute)) {\n    return getFacetStatsIfAvailable(this.facets, attribute);\n  } else if (this._state.isDisjunctiveFacet(attribute)) {\n    return getFacetStatsIfAvailable(this.disjunctiveFacets, attribute);\n  }\n\n  return undefined;\n};\n\n/**\n * @typedef {Object} FacetListItem\n * @property {string} name\n */\n\n/**\n * @param {FacetListItem[]} facetList (has more items, but enough for here)\n * @param {string} facetName The attribute to look for\n * @return {object|undefined} The stats of the facet\n */\nfunction getFacetStatsIfAvailable(facetList, facetName) {\n  var data = find(facetList, function (facet) {\n    return facet.name === facetName;\n  });\n  return data && data.stats;\n}\n\n/**\n * Returns all refinements for all filters + tags. It also provides\n * additional information: count and exhaustiveness for each filter.\n *\n * See the [refinement type](#Refinement) for an exhaustive view of the available\n * data.\n *\n * Note that for a numeric refinement, results are grouped per operator, this\n * means that it will return responses for operators which are empty.\n *\n * @return {Array.<Refinement>} all the refinements\n */\nSearchResults.prototype.getRefinements = function () {\n  var state = this._state;\n  // eslint-disable-next-line consistent-this\n  var results = this;\n  var res = [];\n\n  Object.keys(state.facetsRefinements).forEach(function (attributeName) {\n    state.facetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(state, 'facet', attributeName, name, results.facets)\n      );\n    });\n  });\n\n  Object.keys(state.facetsExcludes).forEach(function (attributeName) {\n    state.facetsExcludes[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(state, 'exclude', attributeName, name, results.facets)\n      );\n    });\n  });\n\n  Object.keys(state.disjunctiveFacetsRefinements).forEach(function (\n    attributeName\n  ) {\n    state.disjunctiveFacetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(\n          state,\n          'disjunctive',\n          attributeName,\n          name,\n          results.disjunctiveFacets\n        )\n      );\n    });\n  });\n\n  Object.keys(state.hierarchicalFacetsRefinements).forEach(function (\n    attributeName\n  ) {\n    state.hierarchicalFacetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getHierarchicalRefinement(\n          state,\n          attributeName,\n          name,\n          results.hierarchicalFacets\n        )\n      );\n    });\n  });\n\n  Object.keys(state.numericRefinements).forEach(function (attributeName) {\n    var operators = state.numericRefinements[attributeName];\n    Object.keys(operators).forEach(function (operator) {\n      operators[operator].forEach(function (value) {\n        res.push({\n          type: 'numeric',\n          attributeName: attributeName,\n          name: value,\n          numericValue: value,\n          operator: operator,\n        });\n      });\n    });\n  });\n\n  state.tagRefinements.forEach(function (name) {\n    res.push({ type: 'tag', attributeName: '_tags', name: name });\n  });\n\n  return res;\n};\n\n/**\n * @typedef {Object} Facet\n * @property {string} name\n * @property {Object} data\n * @property {boolean} exhaustive\n */\n\n/**\n * @param {SearchParameters} state the current state\n * @param {string} type the type of the refinement\n * @param {string} attributeName The attribute of the facet\n * @param {*} name The name of the facet\n * @param {Facet[]} resultsFacets facets from the results\n * @return {Refinement} the refinement\n */\nfunction getRefinement(state, type, attributeName, name, resultsFacets) {\n  var facet = find(resultsFacets, function (f) {\n    return f.name === attributeName;\n  });\n  var count = facet && facet.data && facet.data[name] ? facet.data[name] : 0;\n  var exhaustive = (facet && facet.exhaustive) || false;\n\n  return {\n    type: type,\n    attributeName: attributeName,\n    name: name,\n    count: count,\n    exhaustive: exhaustive,\n  };\n}\n\n/**\n * @param {SearchParameters} state the current state\n * @param {string} attributeName the attribute of the hierarchical facet\n * @param {string} name the name of the facet\n * @param {Facet[]} resultsFacets facets from the results\n * @return {HierarchicalFacet} the hierarchical facet\n */\nfunction getHierarchicalRefinement(state, attributeName, name, resultsFacets) {\n  var facetDeclaration = state.getHierarchicalFacetByName(attributeName);\n  var separator = state._getHierarchicalFacetSeparator(facetDeclaration);\n  var split = name.split(separator);\n  var rootFacet = find(resultsFacets, function (facet) {\n    return facet.name === attributeName;\n  });\n\n  var facet = split.reduce(function (intermediateFacet, part) {\n    var newFacet =\n      intermediateFacet &&\n      find(intermediateFacet.data, function (f) {\n        return f.name === part;\n      });\n    return newFacet !== undefined ? newFacet : intermediateFacet;\n  }, rootFacet);\n\n  var count = (facet && facet.count) || 0;\n  var exhaustive = (facet && facet.exhaustive) || false;\n  var path = (facet && facet.path) || '';\n\n  return {\n    type: 'hierarchical',\n    attributeName: attributeName,\n    name: path,\n    count: count,\n    exhaustive: exhaustive,\n  };\n}\n\nmodule.exports = SearchResults;\n","'use strict';\n\nvar EventEmitter = require('@algolia/events');\n\nvar DerivedHelper = require('./DerivedHelper');\nvar escapeFacetValue = require('./functions/escapeFacetValue').escapeFacetValue;\nvar inherits = require('./functions/inherits');\nvar merge = require('./functions/merge');\nvar objectHasKeys = require('./functions/objectHasKeys');\nvar omit = require('./functions/omit');\nvar requestBuilder = require('./requestBuilder');\nvar SearchParameters = require('./SearchParameters');\nvar SearchResults = require('./SearchResults');\nvar version = require('./version');\n\n/**\n * Event triggered when a parameter is set or updated\n * @event AlgoliaSearchHelper#event:change\n * @property {object} event\n * @property {SearchParameters} event.state the current parameters with the latest changes applied\n * @property {SearchResults} event.results the previous results received from Algolia. `null` before the first request\n * @example\n * helper.on('change', function(event) {\n *   console.log('The parameters have changed');\n * });\n */\n\n/**\n * Event triggered when a main search is sent to Algolia\n * @event AlgoliaSearchHelper#event:search\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search\n * @property {SearchResults} event.results the results from the previous search. `null` if it is the first search.\n * @example\n * helper.on('search', function(event) {\n *   console.log('Search sent');\n * });\n */\n\n/**\n * Event triggered when a search using `searchForFacetValues` is sent to Algolia\n * @event AlgoliaSearchHelper#event:searchForFacetValues\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search it is the first search.\n * @property {string} event.facet the facet searched into\n * @property {string} event.query the query used to search in the facets\n * @example\n * helper.on('searchForFacetValues', function(event) {\n *   console.log('searchForFacetValues sent');\n * });\n */\n\n/**\n * Event triggered when a search using `searchOnce` is sent to Algolia\n * @event AlgoliaSearchHelper#event:searchOnce\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search it is the first search.\n * @example\n * helper.on('searchOnce', function(event) {\n *   console.log('searchOnce sent');\n * });\n */\n\n/**\n * Event triggered when the results are retrieved from Algolia\n * @event AlgoliaSearchHelper#event:result\n * @property {object} event\n * @property {SearchResults} event.results the results received from Algolia\n * @property {SearchParameters} event.state the parameters used to query Algolia. Those might be different from the one in the helper instance (for example if the network is unreliable).\n * @example\n * helper.on('result', function(event) {\n *   console.log('Search results received');\n * });\n */\n\n/**\n * Event triggered when Algolia sends back an error. For example, if an unknown parameter is\n * used, the error can be caught using this event.\n * @event AlgoliaSearchHelper#event:error\n * @property {object} event\n * @property {Error} event.error the error returned by the Algolia.\n * @example\n * helper.on('error', function(event) {\n *   console.log('Houston we got a problem.');\n * });\n */\n\n/**\n * Event triggered when the queue of queries have been depleted (with any result or outdated queries)\n * @event AlgoliaSearchHelper#event:searchQueueEmpty\n * @example\n * helper.on('searchQueueEmpty', function() {\n *   console.log('No more search pending');\n *   // This is received before the result event if we're not expecting new results\n * });\n *\n * helper.search();\n */\n\n/**\n * Initialize a new AlgoliaSearchHelper\n * @class\n * @classdesc The AlgoliaSearchHelper is a class that ease the management of the\n * search. It provides an event based interface for search callbacks:\n *  - change: when the internal search state is changed.\n *    This event contains a {@link SearchParameters} object and the\n *    {@link SearchResults} of the last result if any.\n *  - search: when a search is triggered using the `search()` method.\n *  - result: when the response is retrieved from Algolia and is processed.\n *    This event contains a {@link SearchResults} object and the\n *    {@link SearchParameters} corresponding to this answer.\n *  - error: when the response is an error. This event contains the error returned by the server.\n * @param  {AlgoliaSearch} client an AlgoliaSearch client\n * @param  {string} index the index name to query\n * @param  {SearchParameters | object} options an object defining the initial\n * config of the search. It doesn't have to be a {SearchParameters},\n * just an object containing the properties you need from it.\n */\nfunction AlgoliaSearchHelper(client, index, options) {\n  if (typeof client.addAlgoliaAgent === 'function') {\n    client.addAlgoliaAgent('JS Helper (' + version + ')');\n  }\n\n  this.setClient(client);\n  var opts = options || {};\n  opts.index = index;\n  this.state = SearchParameters.make(opts);\n  this.lastResults = null;\n  this._queryId = 0;\n  this._lastQueryIdReceived = -1;\n  this.derivedHelpers = [];\n  this._currentNbQueries = 0;\n}\n\ninherits(AlgoliaSearchHelper, EventEmitter);\n\n/**\n * Start the search with the parameters set in the state. When the\n * method is called, it triggers a `search` event. The results will\n * be available through the `result` event. If an error occurs, an\n * `error` will be fired instead.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires search\n * @fires result\n * @fires error\n * @chainable\n */\nAlgoliaSearchHelper.prototype.search = function () {\n  this._search({ onlyWithDerivedHelpers: false });\n  return this;\n};\n\nAlgoliaSearchHelper.prototype.searchOnlyWithDerivedHelpers = function () {\n  this._search({ onlyWithDerivedHelpers: true });\n  return this;\n};\n\n/**\n * Gets the search query parameters that would be sent to the Algolia Client\n * for the hits\n * @return {object} Query Parameters\n */\nAlgoliaSearchHelper.prototype.getQuery = function () {\n  var state = this.state;\n  return requestBuilder._getHitsSearchParams(state);\n};\n\n/**\n * Start a search using a modified version of the current state. This method does\n * not trigger the helper lifecycle and does not modify the state kept internally\n * by the helper. This second aspect means that the next search call will be the\n * same as a search call before calling searchOnce.\n * @param {object} options can contain all the parameters that can be set to SearchParameters\n * plus the index\n * @param {function} [cb] optional callback executed when the response from the\n * server is back.\n * @return {promise|undefined} if a callback is passed the method returns undefined\n * otherwise it returns a promise containing an object with two keys :\n *  - content with a SearchResults\n *  - state with the state used for the query as a SearchParameters\n * @example\n * // Changing the number of records returned per page to 1\n * // This example uses the callback API\n * var state = helper.searchOnce({hitsPerPage: 1},\n *   function(error, content, state) {\n *     // if an error occurred it will be passed in error, otherwise its value is null\n *     // content contains the results formatted as a SearchResults\n *     // state is the instance of SearchParameters used for this search\n *   });\n * @example\n * // Changing the number of records returned per page to 1\n * // This example uses the promise API\n * var state1 = helper.searchOnce({hitsPerPage: 1})\n *                 .then(promiseHandler);\n *\n * function promiseHandler(res) {\n *   // res contains\n *   // {\n *   //   content : SearchResults\n *   //   state   : SearchParameters (the one used for this specific search)\n *   // }\n * }\n */\nAlgoliaSearchHelper.prototype.searchOnce = function (options, cb) {\n  var tempState = !options\n    ? this.state\n    : this.state.setQueryParameters(options);\n  var queries = requestBuilder._getQueries(tempState.index, tempState);\n  // eslint-disable-next-line consistent-this\n  var self = this;\n\n  this._currentNbQueries++;\n\n  this.emit('searchOnce', {\n    state: tempState,\n  });\n\n  if (cb) {\n    this.client\n      .search(queries)\n      .then(function (content) {\n        self._currentNbQueries--;\n        if (self._currentNbQueries === 0) {\n          self.emit('searchQueueEmpty');\n        }\n\n        cb(null, new SearchResults(tempState, content.results), tempState);\n      })\n      .catch(function (err) {\n        self._currentNbQueries--;\n        if (self._currentNbQueries === 0) {\n          self.emit('searchQueueEmpty');\n        }\n\n        cb(err, null, tempState);\n      });\n\n    return undefined;\n  }\n\n  return this.client.search(queries).then(\n    function (content) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      return {\n        content: new SearchResults(tempState, content.results),\n        state: tempState,\n        _originalResponse: content,\n      };\n    },\n    function (e) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      throw e;\n    }\n  );\n};\n\n/**\n * Start the search for answers with the parameters set in the state.\n * This method returns a promise.\n * @param {Object} options - the options for answers API call\n * @param {string[]} options.attributesForPrediction - Attributes to use for predictions. If empty, `searchableAttributes` is used instead.\n * @param {string[]} options.queryLanguages - The languages in the query. Currently only supports ['en'].\n * @param {number} options.nbHits - Maximum number of answers to retrieve from the Answers Engine. Cannot be greater than 1000.\n *\n * @return {promise} the answer results\n * @deprecated answers is deprecated and will be replaced with new initiatives\n */\nAlgoliaSearchHelper.prototype.findAnswers = function (options) {\n  // eslint-disable-next-line no-console\n  console.warn('[algoliasearch-helper] answers is no longer supported');\n  var state = this.state;\n  var derivedHelper = this.derivedHelpers[0];\n  if (!derivedHelper) {\n    return Promise.resolve([]);\n  }\n  var derivedState = derivedHelper.getModifiedState(state);\n  var data = merge(\n    {\n      attributesForPrediction: options.attributesForPrediction,\n      nbHits: options.nbHits,\n    },\n    {\n      params: omit(requestBuilder._getHitsSearchParams(derivedState), [\n        'attributesToSnippet',\n        'hitsPerPage',\n        'restrictSearchableAttributes',\n        'snippetEllipsisText',\n      ]),\n    }\n  );\n\n  var errorMessage =\n    'search for answers was called, but this client does not have a function client.initIndex(index).findAnswers';\n  if (typeof this.client.initIndex !== 'function') {\n    throw new Error(errorMessage);\n  }\n  var index = this.client.initIndex(derivedState.index);\n  if (typeof index.findAnswers !== 'function') {\n    throw new Error(errorMessage);\n  }\n  return index.findAnswers(derivedState.query, options.queryLanguages, data);\n};\n\n/**\n * Structure of each result when using\n * [`searchForFacetValues()`](reference.html#AlgoliaSearchHelper#searchForFacetValues)\n * @typedef FacetSearchHit\n * @type {object}\n * @property {string} value the facet value\n * @property {string} highlighted the facet value highlighted with the query string\n * @property {number} count number of occurrence of this facet value\n * @property {boolean} isRefined true if the value is already refined\n */\n\n/**\n * Structure of the data resolved by the\n * [`searchForFacetValues()`](reference.html#AlgoliaSearchHelper#searchForFacetValues)\n * promise.\n * @typedef FacetSearchResult\n * @type {object}\n * @property {FacetSearchHit} facetHits the results for this search for facet values\n * @property {number} processingTimeMS time taken by the query inside the engine\n */\n\n/**\n * Search for facet values based on an query and the name of a faceted attribute. This\n * triggers a search and will return a promise. On top of using the query, it also sends\n * the parameters from the state so that the search is narrowed down to only the possible values.\n *\n * See the description of [FacetSearchResult](reference.html#FacetSearchResult)\n * @param {string} facet the name of the faceted attribute\n * @param {string} query the string query for the search\n * @param {number} [maxFacetHits] the maximum number values returned. Should be > 0 and <= 100\n * @param {object} [userState] the set of custom parameters to use on top of the current state. Setting a property to `undefined` removes\n * it in the generated query.\n * @return {promise.<FacetSearchResult>} the results of the search\n */\nAlgoliaSearchHelper.prototype.searchForFacetValues = function (\n  facet,\n  query,\n  maxFacetHits,\n  userState\n) {\n  var clientHasSFFV = typeof this.client.searchForFacetValues === 'function';\n  var clientHasInitIndex = typeof this.client.initIndex === 'function';\n  if (\n    !clientHasSFFV &&\n    !clientHasInitIndex &&\n    typeof this.client.search !== 'function'\n  ) {\n    throw new Error(\n      'search for facet values (searchable) was called, but this client does not have a function client.searchForFacetValues or client.initIndex(index).searchForFacetValues'\n    );\n  }\n\n  var state = this.state.setQueryParameters(userState || {});\n  var isDisjunctive = state.isDisjunctiveFacet(facet);\n  var algoliaQuery = requestBuilder.getSearchForFacetQuery(\n    facet,\n    query,\n    maxFacetHits,\n    state\n  );\n\n  this._currentNbQueries++;\n  // eslint-disable-next-line consistent-this\n  var self = this;\n  var searchForFacetValuesPromise;\n  // newer algoliasearch ^3.27.1 - ~4.0.0\n  if (clientHasSFFV) {\n    searchForFacetValuesPromise = this.client.searchForFacetValues([\n      { indexName: state.index, params: algoliaQuery },\n    ]);\n    // algoliasearch < 3.27.1\n  } else if (clientHasInitIndex) {\n    searchForFacetValuesPromise = this.client\n      .initIndex(state.index)\n      .searchForFacetValues(algoliaQuery);\n    // algoliasearch ~5.0.0\n  } else {\n    // @MAJOR only use client.search\n    delete algoliaQuery.facetName;\n    searchForFacetValuesPromise = this.client\n      .search([\n        {\n          type: 'facet',\n          facet: facet,\n          indexName: state.index,\n          params: algoliaQuery,\n        },\n      ])\n      .then(function processResponse(response) {\n        return response.results[0];\n      });\n  }\n\n  this.emit('searchForFacetValues', {\n    state: state,\n    facet: facet,\n    query: query,\n  });\n\n  return searchForFacetValuesPromise.then(\n    function addIsRefined(content) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n\n      content = Array.isArray(content) ? content[0] : content;\n\n      content.facetHits.forEach(function (f) {\n        f.escapedValue = escapeFacetValue(f.value);\n        f.isRefined = isDisjunctive\n          ? state.isDisjunctiveFacetRefined(facet, f.escapedValue)\n          : state.isFacetRefined(facet, f.escapedValue);\n      });\n\n      return content;\n    },\n    function (e) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      throw e;\n    }\n  );\n};\n\n/**\n * Sets the text query used for the search.\n *\n * This method resets the current page to 0.\n * @param  {string} q the user query\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setQuery = function (q) {\n  this._change({\n    state: this.state.resetPage().setQuery(q),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Remove all the types of refinements except tags. A string can be provided to remove\n * only the refinements of a specific attribute. For more advanced use case, you can\n * provide a function instead. This function should follow the\n * [clearCallback definition](#SearchParameters.clearCallback).\n *\n * This method resets the current page to 0.\n * @param {string} [name] optional name of the facet / attribute on which we want to remove all refinements\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * // Removing all the refinements\n * helper.clearRefinements().search();\n * @example\n * // Removing all the filters on a the category attribute.\n * helper.clearRefinements('category').search();\n * @example\n * // Removing only the exclude filters on the category facet.\n * helper.clearRefinements(function(value, attribute, type) {\n *   return type === 'exclude' && attribute === 'category';\n * }).search();\n */\nAlgoliaSearchHelper.prototype.clearRefinements = function (name) {\n  this._change({\n    state: this.state.resetPage().clearRefinements(name),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Remove all the tag filters.\n *\n * This method resets the current page to 0.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.clearTags = function () {\n  this._change({\n    state: this.state.resetPage().clearTags(),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a disjunctive filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addDisjunctiveFacetRefinement = function (\n  facet,\n  value\n) {\n  this._change({\n    state: this.state.resetPage().addDisjunctiveFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addDisjunctiveFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.addDisjunctiveRefine = function () {\n  return this.addDisjunctiveFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds a refinement on a hierarchical facet. It will throw\n * an exception if the facet is not defined or if the facet\n * is already refined.\n *\n * This method resets the current page to 0.\n * @param {string} facet the facet name\n * @param {string} path the hierarchical facet path\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error if the facet is not defined or if the facet is refined\n * @chainable\n * @fires change\n */\nAlgoliaSearchHelper.prototype.addHierarchicalFacetRefinement = function (\n  facet,\n  path\n) {\n  this._change({\n    state: this.state.resetPage().addHierarchicalFacetRefinement(facet, path),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a an numeric filter to an attribute with the `operator` and `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} attribute the attribute on which the numeric filter applies\n * @param  {string} operator the operator of the filter\n * @param  {number} value the value of the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addNumericRefinement = function (\n  attribute,\n  operator,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .addNumericRefinement(attribute, operator, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().addFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.addRefine = function () {\n  return this.addFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds a an exclusion filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().addExcludeRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.addExclude = function () {\n  return this.addFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Adds a tag filter with the `tag` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param {string} tag the tag to add to the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().addTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes an numeric filter to an attribute with the `operator` and `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * Some parameters are optional, triggering different behavior:\n *  - if the value is not provided, then all the numeric value will be removed for the\n *  specified attribute/operator couple.\n *  - if the operator is not provided either, then all the numeric filter on this attribute\n *  will be removed.\n *\n * This method resets the current page to 0.\n * @param  {string} attribute the attribute on which the numeric filter applies\n * @param  {string} [operator] the operator of the filter\n * @param  {number} [value] the value of the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeNumericRefinement = function (\n  attribute,\n  operator,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .removeNumericRefinement(attribute, operator, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes a disjunctive filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeDisjunctiveFacetRefinement = function (\n  facet,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .removeDisjunctiveFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeDisjunctiveFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.removeDisjunctiveRefine = function () {\n  return this.removeDisjunctiveFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Removes the refinement set on a hierarchical facet.\n * @param {string} facet the facet name\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error if the facet is not defined or if the facet is not refined\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeHierarchicalFacetRefinement = function (\n  facet\n) {\n  this._change({\n    state: this.state.resetPage().removeHierarchicalFacetRefinement(facet),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes a filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().removeFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.removeRefine = function () {\n  return this.removeFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Removes an exclusion filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().removeExcludeRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.removeExclude = function () {\n  return this.removeFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Removes a tag filter with the `tag` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param {string} tag tag to remove from the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().removeTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds or removes an exclusion filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().toggleExcludeFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#toggleFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.toggleExclude = function () {\n  return this.toggleFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Adds or removes a filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method can be used for conjunctive, disjunctive and hierarchical filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error will throw an error if the facet is not declared in the settings of the helper\n * @fires change\n * @chainable\n * @deprecated since version 2.19.0, see {@link AlgoliaSearchHelper#toggleFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.toggleRefinement = function (facet, value) {\n  return this.toggleFacetRefinement(facet, value);\n};\n\n/**\n * Adds or removes a filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method can be used for conjunctive, disjunctive and hierarchical filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error will throw an error if the facet is not declared in the settings of the helper\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().toggleFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#toggleFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.toggleRefine = function () {\n  return this.toggleFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds or removes a tag filter with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method resets the current page to 0.\n * @param {string} tag tag to remove or add\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().toggleTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Increments the page number by one.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * helper.setPage(0).nextPage().getPage();\n * // returns 1\n */\nAlgoliaSearchHelper.prototype.nextPage = function () {\n  var page = this.state.page || 0;\n  return this.setPage(page + 1);\n};\n\n/**\n * Decrements the page number by one.\n * @fires change\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @chainable\n * @example\n * helper.setPage(1).previousPage().getPage();\n * // returns 0\n */\nAlgoliaSearchHelper.prototype.previousPage = function () {\n  var page = this.state.page || 0;\n  return this.setPage(page - 1);\n};\n\n/**\n * @private\n * @param {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @chainable\n * @fires change\n */\nfunction setCurrentPage(page) {\n  if (page < 0) throw new Error('Page requested below 0.');\n\n  this._change({\n    state: this.state.setPage(page),\n    isPageReset: false,\n  });\n\n  return this;\n}\n\n/**\n * Change the current page\n * @deprecated\n * @param  {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setCurrentPage = setCurrentPage;\n\n/**\n * Updates the current page.\n * @function\n * @param  {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setPage = setCurrentPage;\n\n/**\n * Updates the name of the index that will be targeted by the query.\n *\n * This method resets the current page to 0.\n * @param {string} name the index name\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setIndex = function (name) {\n  this._change({\n    state: this.state.resetPage().setIndex(name),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Update a parameter of the search. This method reset the page\n *\n * The complete list of parameters is available on the\n * [Algolia website](https://www.algolia.com/doc/rest#query-an-index).\n * The most commonly used parameters have their own [shortcuts](#query-parameters-shortcuts)\n * or benefit from higher-level APIs (all the kind of filters and facets have their own API)\n *\n * This method resets the current page to 0.\n * @param {string} parameter name of the parameter to update\n * @param {any} value new value of the parameter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * helper.setQueryParameter('hitsPerPage', 20).search();\n */\nAlgoliaSearchHelper.prototype.setQueryParameter = function (parameter, value) {\n  this._change({\n    state: this.state.resetPage().setQueryParameter(parameter, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Set the whole state (warning: will erase previous state)\n * @param {SearchParameters} newState the whole new state\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setState = function (newState) {\n  this._change({\n    state: SearchParameters.make(newState),\n    isPageReset: false,\n  });\n\n  return this;\n};\n\n/**\n * Override the current state without triggering a change event.\n * Do not use this method unless you know what you are doing. (see the example\n * for a legit use case)\n * @param {SearchParameters} newState the whole new state\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @example\n *  helper.on('change', function(state){\n *    // In this function you might want to find a way to store the state in the url/history\n *    updateYourURL(state)\n *  })\n *  window.onpopstate = function(event){\n *    // This is naive though as you should check if the state is really defined etc.\n *    helper.overrideStateWithoutTriggeringChangeEvent(event.state).search()\n *  }\n * @chainable\n */\nAlgoliaSearchHelper.prototype.overrideStateWithoutTriggeringChangeEvent =\n  function (newState) {\n    this.state = new SearchParameters(newState);\n    return this;\n  };\n\n/**\n * Check if an attribute has any numeric, conjunctive, disjunctive or hierarchical filters.\n * @param {string} attribute the name of the attribute\n * @return {boolean} true if the attribute is filtered by at least one value\n * @example\n * // hasRefinements works with numeric, conjunctive, disjunctive and hierarchical filters\n * helper.hasRefinements('price'); // false\n * helper.addNumericRefinement('price', '>', 100);\n * helper.hasRefinements('price'); // true\n *\n * helper.hasRefinements('color'); // false\n * helper.addFacetRefinement('color', 'blue');\n * helper.hasRefinements('color'); // true\n *\n * helper.hasRefinements('material'); // false\n * helper.addDisjunctiveFacetRefinement('material', 'plastic');\n * helper.hasRefinements('material'); // true\n *\n * helper.hasRefinements('categories'); // false\n * helper.toggleFacetRefinement('categories', 'kitchen > knife');\n * helper.hasRefinements('categories'); // true\n *\n */\nAlgoliaSearchHelper.prototype.hasRefinements = function (attribute) {\n  if (objectHasKeys(this.state.getNumericRefinements(attribute))) {\n    return true;\n  } else if (this.state.isConjunctiveFacet(attribute)) {\n    return this.state.isFacetRefined(attribute);\n  } else if (this.state.isDisjunctiveFacet(attribute)) {\n    return this.state.isDisjunctiveFacetRefined(attribute);\n  } else if (this.state.isHierarchicalFacet(attribute)) {\n    return this.state.isHierarchicalFacetRefined(attribute);\n  }\n\n  // there's currently no way to know that the user did call `addNumericRefinement` at some point\n  // thus we cannot distinguish if there once was a numeric refinement that was cleared\n  // so we will return false in every other situations to be consistent\n  // while what we should do here is throw because we did not find the attribute in any type\n  // of refinement\n  return false;\n};\n\n/**\n * Check if a value is excluded for a specific faceted attribute. If the value\n * is omitted then the function checks if there is any excluding refinements.\n *\n * @param  {string}  facet name of the attribute for used for faceting\n * @param  {string}  [value] optional value. If passed will test that this value\n * is filtering the given facet.\n * @return {boolean} true if refined\n * @example\n * helper.isExcludeRefined('color'); // false\n * helper.isExcludeRefined('color', 'blue') // false\n * helper.isExcludeRefined('color', 'red') // false\n *\n * helper.addFacetExclusion('color', 'red');\n *\n * helper.isExcludeRefined('color'); // true\n * helper.isExcludeRefined('color', 'blue') // false\n * helper.isExcludeRefined('color', 'red') // true\n */\nAlgoliaSearchHelper.prototype.isExcluded = function (facet, value) {\n  return this.state.isExcludeRefined(facet, value);\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since 2.4.0, see {@link AlgoliaSearchHelper#hasRefinements}\n */\nAlgoliaSearchHelper.prototype.isDisjunctiveRefined = function (facet, value) {\n  return this.state.isDisjunctiveFacetRefined(facet, value);\n};\n\n/**\n * Check if the string is a currently filtering tag.\n * @param {string} tag tag to check\n * @return {boolean} true if the tag is currently refined\n */\nAlgoliaSearchHelper.prototype.hasTag = function (tag) {\n  return this.state.isTagRefined(tag);\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since 2.4.0, see {@link AlgoliaSearchHelper#hasTag}\n */\nAlgoliaSearchHelper.prototype.isTagRefined = function () {\n  return this.hasTagRefinements.apply(this, arguments);\n};\n\n/**\n * Get the name of the currently used index.\n * @return {string} name of the index\n * @example\n * helper.setIndex('highestPrice_products').getIndex();\n * // returns 'highestPrice_products'\n */\nAlgoliaSearchHelper.prototype.getIndex = function () {\n  return this.state.index;\n};\n\nfunction getCurrentPage() {\n  return this.state.page;\n}\n\n/**\n * Get the currently selected page\n * @deprecated\n * @return {number} the current page\n */\nAlgoliaSearchHelper.prototype.getCurrentPage = getCurrentPage;\n/**\n * Get the currently selected page\n * @function\n * @return {number} the current page\n */\nAlgoliaSearchHelper.prototype.getPage = getCurrentPage;\n\n/**\n * Get all the tags currently set to filters the results.\n *\n * @return {string[]} The list of tags currently set.\n */\nAlgoliaSearchHelper.prototype.getTags = function () {\n  return this.state.tagRefinements;\n};\n\n/**\n * Get the list of refinements for a given attribute. This method works with\n * conjunctive, disjunctive, excluding and numerical filters.\n *\n * See also SearchResults#getRefinements\n *\n * @param {string} facetName attribute name used for faceting\n * @return {Array.<FacetRefinement|NumericRefinement>} All Refinement are objects that contain a value, and\n * a type. Numeric also contains an operator.\n * @example\n * helper.addNumericRefinement('price', '>', 100);\n * helper.getRefinements('price');\n * // [\n * //   {\n * //     \"value\": [\n * //       100\n * //     ],\n * //     \"operator\": \">\",\n * //     \"type\": \"numeric\"\n * //   }\n * // ]\n * @example\n * helper.addFacetRefinement('color', 'blue');\n * helper.addFacetExclusion('color', 'red');\n * helper.getRefinements('color');\n * // [\n * //   {\n * //     \"value\": \"blue\",\n * //     \"type\": \"conjunctive\"\n * //   },\n * //   {\n * //     \"value\": \"red\",\n * //     \"type\": \"exclude\"\n * //   }\n * // ]\n * @example\n * helper.addDisjunctiveFacetRefinement('material', 'plastic');\n * // [\n * //   {\n * //     \"value\": \"plastic\",\n * //     \"type\": \"disjunctive\"\n * //   }\n * // ]\n */\nAlgoliaSearchHelper.prototype.getRefinements = function (facetName) {\n  var refinements = [];\n\n  if (this.state.isConjunctiveFacet(facetName)) {\n    var conjRefinements = this.state.getConjunctiveRefinements(facetName);\n\n    conjRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'conjunctive',\n      });\n    });\n\n    var excludeRefinements = this.state.getExcludeRefinements(facetName);\n\n    excludeRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'exclude',\n      });\n    });\n  } else if (this.state.isDisjunctiveFacet(facetName)) {\n    var disjunctiveRefinements =\n      this.state.getDisjunctiveRefinements(facetName);\n\n    disjunctiveRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'disjunctive',\n      });\n    });\n  }\n\n  var numericRefinements = this.state.getNumericRefinements(facetName);\n\n  Object.keys(numericRefinements).forEach(function (operator) {\n    var value = numericRefinements[operator];\n\n    refinements.push({\n      value: value,\n      operator: operator,\n      type: 'numeric',\n    });\n  });\n\n  return refinements;\n};\n\n/**\n * Return the current refinement for the (attribute, operator)\n * @param {string} attribute attribute in the record\n * @param {string} operator operator applied on the refined values\n * @return {Array.<number|number[]>} refined values\n */\nAlgoliaSearchHelper.prototype.getNumericRefinement = function (\n  attribute,\n  operator\n) {\n  return this.state.getNumericRefinement(attribute, operator);\n};\n\n/**\n * Get the current breadcrumb for a hierarchical facet, as an array\n * @param  {string} facetName Hierarchical facet name\n * @return {array.<string>} the path as an array of string\n */\nAlgoliaSearchHelper.prototype.getHierarchicalFacetBreadcrumb = function (\n  facetName\n) {\n  return this.state.getHierarchicalFacetBreadcrumb(facetName);\n};\n\n// /////////// PRIVATE\n\n/**\n * Perform the underlying queries\n * @private\n * @param {object} options options for the query\n * @param {boolean} [options.onlyWithDerivedHelpers=false] if true, only the derived helpers will be queried\n * @return {undefined} does not return anything\n * @fires search\n * @fires result\n * @fires error\n */\nAlgoliaSearchHelper.prototype._search = function (options) {\n  var state = this.state;\n  var states = [];\n  var mainQueries = [];\n\n  if (!options.onlyWithDerivedHelpers) {\n    mainQueries = requestBuilder._getQueries(state.index, state);\n\n    states.push({\n      state: state,\n      queriesCount: mainQueries.length,\n      helper: this,\n    });\n\n    this.emit('search', {\n      state: state,\n      results: this.lastResults,\n    });\n  }\n\n  var derivedQueries = this.derivedHelpers.map(function (derivedHelper) {\n    var derivedState = derivedHelper.getModifiedState(state);\n    var derivedStateQueries = derivedState.index\n      ? requestBuilder._getQueries(derivedState.index, derivedState)\n      : [];\n\n    states.push({\n      state: derivedState,\n      queriesCount: derivedStateQueries.length,\n      helper: derivedHelper,\n    });\n\n    derivedHelper.emit('search', {\n      state: derivedState,\n      results: derivedHelper.lastResults,\n    });\n\n    return derivedStateQueries;\n  });\n\n  var queries = Array.prototype.concat.apply(mainQueries, derivedQueries);\n\n  var queryId = this._queryId++;\n  this._currentNbQueries++;\n\n  if (!queries.length) {\n    return Promise.resolve({ results: [] }).then(\n      this._dispatchAlgoliaResponse.bind(this, states, queryId)\n    );\n  }\n\n  try {\n    this.client\n      .search(queries)\n      .then(this._dispatchAlgoliaResponse.bind(this, states, queryId))\n      .catch(this._dispatchAlgoliaError.bind(this, queryId));\n  } catch (error) {\n    // If we reach this part, we're in an internal error state\n    this.emit('error', {\n      error: error,\n    });\n  }\n\n  return undefined;\n};\n\n/**\n * Transform the responses as sent by the server and transform them into a user\n * usable object that merge the results of all the batch requests. It will dispatch\n * over the different helper + derived helpers (when there are some).\n * @private\n * @param {array.<{SearchParameters, AlgoliaQueries, AlgoliaSearchHelper}>} states state used to generate the request\n * @param {number} queryId id of the current request\n * @param {object} content content of the response\n * @return {undefined}\n */\nAlgoliaSearchHelper.prototype._dispatchAlgoliaResponse = function (\n  states,\n  queryId,\n  content\n) {\n  // @TODO remove the number of outdated queries discarded instead of just one\n\n  if (queryId < this._lastQueryIdReceived) {\n    // Outdated answer\n    return;\n  }\n\n  this._currentNbQueries -= queryId - this._lastQueryIdReceived;\n  this._lastQueryIdReceived = queryId;\n\n  if (this._currentNbQueries === 0) this.emit('searchQueueEmpty');\n\n  var results = content.results.slice();\n\n  states.forEach(function (s) {\n    var state = s.state;\n    var queriesCount = s.queriesCount;\n    var helper = s.helper;\n    var specificResults = results.splice(0, queriesCount);\n\n    if (!state.index) {\n      helper.emit('result', {\n        results: null,\n        state: state,\n      });\n      return;\n    }\n\n    helper.lastResults = new SearchResults(state, specificResults);\n\n    helper.emit('result', {\n      results: helper.lastResults,\n      state: state,\n    });\n  });\n};\n\nAlgoliaSearchHelper.prototype._dispatchAlgoliaError = function (\n  queryId,\n  error\n) {\n  if (queryId < this._lastQueryIdReceived) {\n    // Outdated answer\n    return;\n  }\n\n  this._currentNbQueries -= queryId - this._lastQueryIdReceived;\n  this._lastQueryIdReceived = queryId;\n\n  this.emit('error', {\n    error: error,\n  });\n\n  if (this._currentNbQueries === 0) this.emit('searchQueueEmpty');\n};\n\nAlgoliaSearchHelper.prototype.containsRefinement = function (\n  query,\n  facetFilters,\n  numericFilters,\n  tagFilters\n) {\n  return (\n    query ||\n    facetFilters.length !== 0 ||\n    numericFilters.length !== 0 ||\n    tagFilters.length !== 0\n  );\n};\n\n/**\n * Test if there are some disjunctive refinements on the facet\n * @private\n * @param {string} facet the attribute to test\n * @return {boolean} true if there are refinements on this attribute\n */\nAlgoliaSearchHelper.prototype._hasDisjunctiveRefinements = function (facet) {\n  return (\n    this.state.disjunctiveRefinements[facet] &&\n    this.state.disjunctiveRefinements[facet].length > 0\n  );\n};\n\nAlgoliaSearchHelper.prototype._change = function (event) {\n  var state = event.state;\n  var isPageReset = event.isPageReset;\n\n  if (state !== this.state) {\n    this.state = state;\n\n    this.emit('change', {\n      state: this.state,\n      results: this.lastResults,\n      isPageReset: isPageReset,\n    });\n  }\n};\n\n/**\n * Clears the cache of the underlying Algolia client.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n */\nAlgoliaSearchHelper.prototype.clearCache = function () {\n  if (this.client.clearCache) this.client.clearCache();\n  return this;\n};\n\n/**\n * Updates the internal client instance. If the reference of the clients\n * are equal then no update is actually done.\n * @param  {AlgoliaSearch} newClient an AlgoliaSearch client\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n */\nAlgoliaSearchHelper.prototype.setClient = function (newClient) {\n  if (this.client === newClient) return this;\n\n  if (typeof newClient.addAlgoliaAgent === 'function') {\n    newClient.addAlgoliaAgent('JS Helper (' + version + ')');\n  }\n  this.client = newClient;\n\n  return this;\n};\n\n/**\n * Gets the instance of the currently used client.\n * @return {AlgoliaSearch} the currently used client\n */\nAlgoliaSearchHelper.prototype.getClient = function () {\n  return this.client;\n};\n\n/**\n * Creates an derived instance of the Helper. A derived helper\n * is a way to request other indices synchronised with the lifecycle\n * of the main Helper. This mechanism uses the multiqueries feature\n * of Algolia to aggregate all the requests in a single network call.\n *\n * This method takes a function that is used to create a new SearchParameter\n * that will be used to create requests to Algolia. Those new requests\n * are created just before the `search` event. The signature of the function\n * is `SearchParameters -> SearchParameters`.\n *\n * This method returns a new DerivedHelper which is an EventEmitter\n * that fires the same `search`, `result` and `error` events. Those\n * events, however, will receive data specific to this DerivedHelper\n * and the SearchParameters that is returned by the call of the\n * parameter function.\n * @param {function} fn SearchParameters -> SearchParameters\n * @return {DerivedHelper} a new DerivedHelper\n */\nAlgoliaSearchHelper.prototype.derive = function (fn) {\n  var derivedHelper = new DerivedHelper(this, fn);\n  this.derivedHelpers.push(derivedHelper);\n  return derivedHelper;\n};\n\n/**\n * This method detaches a derived Helper from the main one. Prefer using the one from the\n * derived helper itself, to remove the event listeners too.\n * @private\n * @param  {DerivedHelper} derivedHelper the derived helper to detach\n * @return {undefined} nothing is returned\n * @throws Error\n */\nAlgoliaSearchHelper.prototype.detachDerivedHelper = function (derivedHelper) {\n  var pos = this.derivedHelpers.indexOf(derivedHelper);\n  if (pos === -1) throw new Error('Derived helper already detached');\n  this.derivedHelpers.splice(pos, 1);\n};\n\n/**\n * This method returns true if there is currently at least one on-going search.\n * @return {boolean} true if there is a search pending\n */\nAlgoliaSearchHelper.prototype.hasPendingRequests = function () {\n  return this._currentNbQueries > 0;\n};\n\n/**\n * @typedef AlgoliaSearchHelper.NumericRefinement\n * @type {object}\n * @property {number[]} value the numbers that are used for filtering this attribute with\n * the operator specified.\n * @property {string} operator the faceting data: value, number of entries\n * @property {string} type will be 'numeric'\n */\n\n/**\n * @typedef AlgoliaSearchHelper.FacetRefinement\n * @type {object}\n * @property {string} value the string use to filter the attribute\n * @property {string} type the type of filter: 'conjunctive', 'disjunctive', 'exclude'\n */\n\nmodule.exports = AlgoliaSearchHelper;\n","'use strict';\n\nmodule.exports = function compact(array) {\n  if (!Array.isArray(array)) {\n    return [];\n  }\n\n  return array.filter(Boolean);\n};\n","'use strict';\n\n// NOTE: this behaves like lodash/defaults, but doesn't mutate the target\n// it also preserve keys order\nmodule.exports = function defaultsPure() {\n  var sources = Array.prototype.slice.call(arguments);\n\n  return sources.reduceRight(function (acc, source) {\n    Object.keys(Object(source)).forEach(function (key) {\n      if (source[key] === undefined) {\n        return;\n      }\n      if (acc[key] !== undefined) {\n        // remove if already added, so that we can add it in correct order\n        delete acc[key];\n      }\n      acc[key] = source[key];\n    });\n    return acc;\n  }, {});\n};\n","'use strict';\n\n/**\n * Replaces a leading - with \\-\n * @private\n * @param {any} value the facet value to replace\n * @returns {any} the escaped facet value or the value if it was not a string\n */\nfunction escapeFacetValue(value) {\n  if (typeof value !== 'string') return value;\n\n  return String(value).replace(/^-/, '\\\\-');\n}\n\n/**\n * Replaces a leading \\- with -\n * @private\n * @param {any} value the escaped facet value\n * @returns {any} the unescaped facet value or the value if it was not a string\n */\nfunction unescapeFacetValue(value) {\n  if (typeof value !== 'string') return value;\n\n  return value.replace(/^\\\\-/, '-');\n}\n\nmodule.exports = {\n  escapeFacetValue: escapeFacetValue,\n  unescapeFacetValue: unescapeFacetValue,\n};\n","'use strict';\n\n// @MAJOR can be replaced by native Array#find when we change support\nmodule.exports = function find(array, comparator) {\n  if (!Array.isArray(array)) {\n    return undefined;\n  }\n\n  for (var i = 0; i < array.length; i++) {\n    if (comparator(array[i])) {\n      return array[i];\n    }\n  }\n\n  return undefined;\n};\n","'use strict';\n\n// @MAJOR can be replaced by native Array#findIndex when we change support\nmodule.exports = function find(array, comparator) {\n  if (!Array.isArray(array)) {\n    return -1;\n  }\n\n  for (var i = 0; i < array.length; i++) {\n    if (comparator(array[i])) {\n      return i;\n    }\n  }\n  return -1;\n};\n","'use strict';\n\nvar find = require('./find');\n\n/**\n * Transform sort format from user friendly notation to lodash format\n * @param {string[]} sortBy array of predicate of the form \"attribute:order\"\n * @param {string[]} [defaults] array of predicate of the form \"attribute:order\"\n * @return {array.<string[]>} array containing 2 elements : attributes, orders\n */\nmodule.exports = function formatSort(sortBy, defaults) {\n  var defaultInstructions = (defaults || []).map(function (sort) {\n    return sort.split(':');\n  });\n\n  return sortBy.reduce(\n    function preparePredicate(out, sort) {\n      var sortInstruction = sort.split(':');\n\n      var matchingDefault = find(\n        defaultInstructions,\n        function (defaultInstruction) {\n          return defaultInstruction[0] === sortInstruction[0];\n        }\n      );\n\n      if (sortInstruction.length > 1 || !matchingDefault) {\n        out[0].push(sortInstruction[0]);\n        out[1].push(sortInstruction[1]);\n        return out;\n      }\n\n      out[0].push(matchingDefault[0]);\n      out[1].push(matchingDefault[1]);\n      return out;\n    },\n    [[], []]\n  );\n};\n","'use strict';\n\nfunction inherits(ctor, superCtor) {\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true,\n    },\n  });\n}\n\nmodule.exports = inherits;\n","'use strict';\n\nfunction intersection(arr1, arr2) {\n  return arr1.filter(function (value, index) {\n    return (\n      arr2.indexOf(value) > -1 &&\n      arr1.indexOf(value) === index /* skips duplicates */\n    );\n  });\n}\n\nmodule.exports = intersection;\n","'use strict';\n\nfunction clone(value) {\n  if (typeof value === 'object' && value !== null) {\n    return _merge(Array.isArray(value) ? [] : {}, value);\n  }\n  return value;\n}\n\nfunction isObjectOrArrayOrFunction(value) {\n  return (\n    typeof value === 'function' ||\n    Array.isArray(value) ||\n    Object.prototype.toString.call(value) === '[object Object]'\n  );\n}\n\nfunction _merge(target, source) {\n  if (target === source) {\n    return target;\n  }\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (var key in source) {\n    if (\n      !Object.prototype.hasOwnProperty.call(source, key) ||\n      key === '__proto__' ||\n      key === 'constructor'\n    ) {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    var sourceVal = source[key];\n    var targetVal = target[key];\n\n    if (typeof targetVal !== 'undefined' && typeof sourceVal === 'undefined') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (\n      isObjectOrArrayOrFunction(targetVal) &&\n      isObjectOrArrayOrFunction(sourceVal)\n    ) {\n      target[key] = _merge(targetVal, sourceVal);\n    } else {\n      target[key] = clone(sourceVal);\n    }\n  }\n  return target;\n}\n\n/**\n * This method is like Object.assign, but recursively merges own and inherited\n * enumerable keyed properties of source objects into the destination object.\n *\n * NOTE: this behaves like lodash/merge, but:\n * - does mutate functions if they are a source\n * - treats non-plain objects as plain\n * - does not work for circular objects\n * - treats sparse arrays as sparse\n * - does not convert Array-like objects (Arguments, NodeLists, etc.) to arrays\n *\n * @param {Object} target The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n */\nfunction merge(target) {\n  if (!isObjectOrArrayOrFunction(target)) {\n    target = {};\n  }\n\n  for (var i = 1, l = arguments.length; i < l; i++) {\n    var source = arguments[i];\n\n    if (isObjectOrArrayOrFunction(source)) {\n      _merge(target, source);\n    }\n  }\n  return target;\n}\n\nmodule.exports = merge;\n","'use strict';\n\nfunction objectHasKeys(obj) {\n  return obj && Object.keys(obj).length > 0;\n}\n\nmodule.exports = objectHasKeys;\n","'use strict';\n\n// https://github.com/babel/babel/blob/3aaafae053fa75febb3aa45d45b6f00646e30ba4/packages/babel-helpers/src/helpers.js#L604-L620\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source === null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key;\n  var i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    // eslint-disable-next-line no-continue\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\n","'use strict';\n\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined;\n    var valIsNull = value === null;\n\n    var othIsDefined = other !== undefined;\n    var othIsNull = other === null;\n\n    if (\n      (!othIsNull && value > other) ||\n      (valIsNull && othIsDefined) ||\n      !valIsDefined\n    ) {\n      return 1;\n    }\n    if (\n      (!valIsNull && value < other) ||\n      (othIsNull && valIsDefined) ||\n      !othIsDefined\n    ) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\n/**\n * @param {Array<object>} collection object with keys in attributes\n * @param {Array<string>} iteratees attributes\n * @param {Array<string>} orders asc | desc\n * @return {Array<object>} sorted collection\n */\nfunction orderBy(collection, iteratees, orders) {\n  if (!Array.isArray(collection)) {\n    return [];\n  }\n\n  if (!Array.isArray(orders)) {\n    orders = [];\n  }\n\n  var result = collection.map(function (value, index) {\n    return {\n      criteria: iteratees.map(function (iteratee) {\n        return value[iteratee];\n      }),\n      index: index,\n      value: value,\n    };\n  });\n\n  result.sort(function comparer(object, other) {\n    var index = -1;\n\n    while (++index < object.criteria.length) {\n      var res = compareAscending(object.criteria[index], other.criteria[index]);\n      if (res) {\n        if (index >= orders.length) {\n          return res;\n        }\n        if (orders[index] === 'desc') {\n          return -res;\n        }\n        return res;\n      }\n    }\n\n    // This ensures a stable sort in V8 and other engines.\n    // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n    return object.index - other.index;\n  });\n\n  return result.map(function (res) {\n    return res.value;\n  });\n}\n\nmodule.exports = orderBy;\n","'use strict';\n\nfunction valToNumber(v) {\n  if (typeof v === 'number') {\n    return v;\n  } else if (typeof v === 'string') {\n    return parseFloat(v);\n  } else if (Array.isArray(v)) {\n    return v.map(valToNumber);\n  }\n\n  throw new Error(\n    'The value should be a number, a parsable string or an array of those.'\n  );\n}\n\nmodule.exports = valToNumber;\n","'use strict';\n\nvar merge = require('./functions/merge');\n\nfunction sortObject(obj) {\n  return Object.keys(obj)\n    .sort()\n    .reduce(function (acc, curr) {\n      acc[curr] = obj[curr];\n      return acc;\n    }, {});\n}\n\nvar requestBuilder = {\n  /**\n   * Get all the queries to send to the client, those queries can used directly\n   * with the Algolia client.\n   * @private\n   * @param  {string} index The name of the index\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @return {object[]} The queries\n   */\n  _getQueries: function getQueries(index, state) {\n    var queries = [];\n\n    // One query for the hits\n    queries.push({\n      indexName: index,\n      params: requestBuilder._getHitsSearchParams(state),\n    });\n\n    // One for each disjunctive facets\n    state.getRefinedDisjunctiveFacets().forEach(function (refinedFacet) {\n      queries.push({\n        indexName: index,\n        params: requestBuilder._getDisjunctiveFacetSearchParams(\n          state,\n          refinedFacet\n        ),\n      });\n    });\n\n    // More to get the parent levels of the hierarchical facets when refined\n    state.getRefinedHierarchicalFacets().forEach(function (refinedFacet) {\n      var hierarchicalFacet = state.getHierarchicalFacetByName(refinedFacet);\n      var currentRefinement = state.getHierarchicalRefinement(refinedFacet);\n      var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n\n      // If we are deeper than level 0 (starting from `beer > IPA`)\n      // we want to get all parent values\n      if (\n        currentRefinement.length > 0 &&\n        currentRefinement[0].split(separator).length > 1\n      ) {\n        // We generate a map of the filters we will use for our facet values queries\n        var filtersMap = currentRefinement[0]\n          .split(separator)\n          .slice(0, -1)\n          .reduce(function createFiltersMap(map, segment, level) {\n            return map.concat({\n              attribute: hierarchicalFacet.attributes[level],\n              value:\n                level === 0\n                  ? segment\n                  : [map[map.length - 1].value, segment].join(separator),\n            });\n          }, []);\n\n        filtersMap.forEach(function (filter, level) {\n          var params = requestBuilder._getDisjunctiveFacetSearchParams(\n            state,\n            filter.attribute,\n            level === 0\n          );\n\n          // Keep facet filters unrelated to current hierarchical attributes\n          function hasHierarchicalFacetFilter(value) {\n            return hierarchicalFacet.attributes.some(function (attribute) {\n              return attribute === value.split(':')[0];\n            });\n          }\n\n          var filteredFacetFilters = (params.facetFilters || []).reduce(\n            function (acc, facetFilter) {\n              if (Array.isArray(facetFilter)) {\n                var filtered = facetFilter.filter(function (filterValue) {\n                  return !hasHierarchicalFacetFilter(filterValue);\n                });\n\n                if (filtered.length > 0) {\n                  acc.push(filtered);\n                }\n              }\n\n              if (\n                typeof facetFilter === 'string' &&\n                !hasHierarchicalFacetFilter(facetFilter)\n              ) {\n                acc.push(facetFilter);\n              }\n\n              return acc;\n            },\n            []\n          );\n\n          var parent = filtersMap[level - 1];\n          if (level > 0) {\n            params.facetFilters = filteredFacetFilters.concat(\n              parent.attribute + ':' + parent.value\n            );\n          } else {\n            params.facetFilters =\n              filteredFacetFilters.length > 0\n                ? filteredFacetFilters\n                : undefined;\n          }\n\n          queries.push({ indexName: index, params: params });\n        });\n      }\n    });\n\n    return queries;\n  },\n\n  /**\n   * Build search parameters used to fetch hits\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @return {object.<string, any>} The search parameters for hits\n   */\n  _getHitsSearchParams: function (state) {\n    var facets = state.facets\n      .concat(state.disjunctiveFacets)\n      .concat(requestBuilder._getHitsHierarchicalFacetsAttributes(state))\n      .sort();\n\n    var facetFilters = requestBuilder._getFacetFilters(state);\n    var numericFilters = requestBuilder._getNumericFilters(state);\n    var tagFilters = requestBuilder._getTagFilters(state);\n    var additionalParams = {\n      facets: facets.indexOf('*') > -1 ? ['*'] : facets,\n      tagFilters: tagFilters,\n    };\n\n    if (facetFilters.length > 0) {\n      additionalParams.facetFilters = facetFilters;\n    }\n\n    if (numericFilters.length > 0) {\n      additionalParams.numericFilters = numericFilters;\n    }\n\n    return sortObject(merge({}, state.getQueryParams(), additionalParams));\n  },\n\n  /**\n   * Build search parameters used to fetch a disjunctive facet\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @param  {string} facet the associated facet name\n   * @param  {boolean} hierarchicalRootLevel ?? FIXME\n   * @return {object} The search parameters for a disjunctive facet\n   */\n  _getDisjunctiveFacetSearchParams: function (\n    state,\n    facet,\n    hierarchicalRootLevel\n  ) {\n    var facetFilters = requestBuilder._getFacetFilters(\n      state,\n      facet,\n      hierarchicalRootLevel\n    );\n    var numericFilters = requestBuilder._getNumericFilters(state, facet);\n    var tagFilters = requestBuilder._getTagFilters(state);\n    var additionalParams = {\n      hitsPerPage: 0,\n      page: 0,\n      analytics: false,\n      clickAnalytics: false,\n    };\n\n    if (tagFilters.length > 0) {\n      additionalParams.tagFilters = tagFilters;\n    }\n\n    var hierarchicalFacet = state.getHierarchicalFacetByName(facet);\n\n    if (hierarchicalFacet) {\n      additionalParams.facets =\n        requestBuilder._getDisjunctiveHierarchicalFacetAttribute(\n          state,\n          hierarchicalFacet,\n          hierarchicalRootLevel\n        );\n    } else {\n      additionalParams.facets = facet;\n    }\n\n    if (numericFilters.length > 0) {\n      additionalParams.numericFilters = numericFilters;\n    }\n\n    if (facetFilters.length > 0) {\n      additionalParams.facetFilters = facetFilters;\n    }\n\n    return sortObject(merge({}, state.getQueryParams(), additionalParams));\n  },\n\n  /**\n   * Return the numeric filters in an algolia request fashion\n   * @private\n   * @param {SearchParameters} state the state from which to get the filters\n   * @param {string} [facetName] the name of the attribute for which the filters should be excluded\n   * @return {string[]} the numeric filters in the algolia format\n   */\n  _getNumericFilters: function (state, facetName) {\n    if (state.numericFilters) {\n      return state.numericFilters;\n    }\n\n    var numericFilters = [];\n\n    Object.keys(state.numericRefinements).forEach(function (attribute) {\n      var operators = state.numericRefinements[attribute] || {};\n      Object.keys(operators).forEach(function (operator) {\n        var values = operators[operator] || [];\n        if (facetName !== attribute) {\n          values.forEach(function (value) {\n            if (Array.isArray(value)) {\n              var vs = value.map(function (v) {\n                return attribute + operator + v;\n              });\n              numericFilters.push(vs);\n            } else {\n              numericFilters.push(attribute + operator + value);\n            }\n          });\n        }\n      });\n    });\n\n    return numericFilters;\n  },\n\n  /**\n   * Return the tags filters depending on which format is used, either tagFilters or tagRefinements\n   * @private\n   * @param {SearchParameters} state the state from which to get the filters\n   * @return {string} Tag filters in a single string\n   */\n  _getTagFilters: function (state) {\n    if (state.tagFilters) {\n      return state.tagFilters;\n    }\n\n    return state.tagRefinements.join(',');\n  },\n\n  /**\n   * Build facetFilters parameter based on current refinements. The array returned\n   * contains strings representing the facet filters in the algolia format.\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @param  {string} [facet] if set, the current disjunctive facet\n   * @param  {boolean} [hierarchicalRootLevel] ?? FIXME\n   * @return {array.<string>} The facet filters in the algolia format\n   */\n  _getFacetFilters: function (state, facet, hierarchicalRootLevel) {\n    var facetFilters = [];\n\n    var facetsRefinements = state.facetsRefinements || {};\n    Object.keys(facetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = facetsRefinements[facetName] || [];\n        facetValues.sort().forEach(function (facetValue) {\n          facetFilters.push(facetName + ':' + facetValue);\n        });\n      });\n\n    var facetsExcludes = state.facetsExcludes || {};\n    Object.keys(facetsExcludes)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = facetsExcludes[facetName] || [];\n        facetValues.sort().forEach(function (facetValue) {\n          facetFilters.push(facetName + ':-' + facetValue);\n        });\n      });\n\n    var disjunctiveFacetsRefinements = state.disjunctiveFacetsRefinements || {};\n    Object.keys(disjunctiveFacetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = disjunctiveFacetsRefinements[facetName] || [];\n        if (facetName === facet || !facetValues || facetValues.length === 0) {\n          return;\n        }\n        var orFilters = [];\n\n        facetValues.sort().forEach(function (facetValue) {\n          orFilters.push(facetName + ':' + facetValue);\n        });\n\n        facetFilters.push(orFilters);\n      });\n\n    var hierarchicalFacetsRefinements =\n      state.hierarchicalFacetsRefinements || {};\n    Object.keys(hierarchicalFacetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = hierarchicalFacetsRefinements[facetName] || [];\n        var facetValue = facetValues[0];\n\n        if (facetValue === undefined) {\n          return;\n        }\n\n        var hierarchicalFacet = state.getHierarchicalFacetByName(facetName);\n        var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n        var rootPath = state._getHierarchicalRootPath(hierarchicalFacet);\n        var attributeToRefine;\n        var attributesIndex;\n\n        // we ask for parent facet values only when the `facet` is the current hierarchical facet\n        if (facet === facetName) {\n          // if we are at the root level already, no need to ask for facet values, we get them from\n          // the hits query\n          if (\n            facetValue.indexOf(separator) === -1 ||\n            (!rootPath && hierarchicalRootLevel === true) ||\n            (rootPath &&\n              rootPath.split(separator).length ===\n                facetValue.split(separator).length)\n          ) {\n            return;\n          }\n\n          if (!rootPath) {\n            attributesIndex = facetValue.split(separator).length - 2;\n            facetValue = facetValue.slice(0, facetValue.lastIndexOf(separator));\n          } else {\n            attributesIndex = rootPath.split(separator).length - 1;\n            facetValue = rootPath;\n          }\n\n          attributeToRefine = hierarchicalFacet.attributes[attributesIndex];\n        } else {\n          attributesIndex = facetValue.split(separator).length - 1;\n\n          attributeToRefine = hierarchicalFacet.attributes[attributesIndex];\n        }\n\n        if (attributeToRefine) {\n          facetFilters.push([attributeToRefine + ':' + facetValue]);\n        }\n      });\n\n    return facetFilters;\n  },\n\n  _getHitsHierarchicalFacetsAttributes: function (state) {\n    var out = [];\n\n    return state.hierarchicalFacets.reduce(\n      // ask for as much levels as there's hierarchical refinements\n      function getHitsAttributesForHierarchicalFacet(\n        allAttributes,\n        hierarchicalFacet\n      ) {\n        var hierarchicalRefinement = state.getHierarchicalRefinement(\n          hierarchicalFacet.name\n        )[0];\n\n        // if no refinement, ask for root level\n        if (!hierarchicalRefinement) {\n          allAttributes.push(hierarchicalFacet.attributes[0]);\n          return allAttributes;\n        }\n\n        var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n        var level = hierarchicalRefinement.split(separator).length;\n        var newAttributes = hierarchicalFacet.attributes.slice(0, level + 1);\n\n        return allAttributes.concat(newAttributes);\n      },\n      out\n    );\n  },\n\n  _getDisjunctiveHierarchicalFacetAttribute: function (\n    state,\n    hierarchicalFacet,\n    rootLevel\n  ) {\n    var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    if (rootLevel === true) {\n      var rootPath = state._getHierarchicalRootPath(hierarchicalFacet);\n      var attributeIndex = 0;\n\n      if (rootPath) {\n        attributeIndex = rootPath.split(separator).length;\n      }\n      return [hierarchicalFacet.attributes[attributeIndex]];\n    }\n\n    var hierarchicalRefinement =\n      state.getHierarchicalRefinement(hierarchicalFacet.name)[0] || '';\n    // if refinement is 'beers > IPA > Flying dog',\n    // then we want `facets: ['beers > IPA']` as disjunctive facet (parent level values)\n\n    var parentLevel = hierarchicalRefinement.split(separator).length - 1;\n    return hierarchicalFacet.attributes.slice(0, parentLevel + 1);\n  },\n\n  getSearchForFacetQuery: function (facetName, query, maxFacetHits, state) {\n    var stateForSearchForFacetValues = state.isDisjunctiveFacet(facetName)\n      ? state.clearRefinements(facetName)\n      : state;\n    var searchForFacetSearchParameters = {\n      facetQuery: query,\n      facetName: facetName,\n    };\n    if (typeof maxFacetHits === 'number') {\n      searchForFacetSearchParameters.maxFacetHits = maxFacetHits;\n    }\n    return sortObject(\n      merge(\n        {},\n        requestBuilder._getHitsSearchParams(stateForSearchForFacetValues),\n        searchForFacetSearchParameters\n      )\n    );\n  },\n};\n\nmodule.exports = requestBuilder;\n","'use strict';\n\nmodule.exports = function isValidUserToken(userToken) {\n  if (userToken === null) {\n    return false;\n  }\n  return /^[a-zA-Z0-9_-]{1,64}$/.test(userToken);\n};\n","'use strict';\n\nmodule.exports = '3.14.1';\n","'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nvar Format = {\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n\nmodule.exports = {\n    'default': Format.RFC3986,\n    formatters: {\n        RFC1738: function (value) {\n            return replace.call(value, percentTwenties, '+');\n        },\n        RFC3986: function (value) {\n            return String(value);\n        }\n    },\n    RFC1738: Format.RFC1738,\n    RFC3986: Format.RFC3986\n};\n","'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n","'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    charset: 'utf-8',\n    charsetSentinel: false,\n    comma: false,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    ignoreQueryPrefix: false,\n    interpretNumericEntities: false,\n    parameterLimit: 1000,\n    parseArrays: true,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar interpretNumericEntities = function (str) {\n    return str.replace(/&#(\\d+);/g, function ($0, numberStr) {\n        return String.fromCharCode(parseInt(numberStr, 10));\n    });\n};\n\nvar parseArrayValue = function (val, options) {\n    if (val && typeof val === 'string' && options.comma && val.indexOf(',') > -1) {\n        return val.split(',');\n    }\n\n    return val;\n};\n\n// This is what browsers will submit when the  character occurs in an\n// application/x-www-form-urlencoded body and the encoding of the page containing\n// the form is iso-8859-1, or when the submitted form has an accept-charset\n// attribute of iso-8859-1. Presumably also with other charsets that do not contain\n// the  character, such as us-ascii.\nvar isoSentinel = 'utf8=%26%2310003%3B'; // encodeURIComponent('&#10003;')\n\n// These are the percent-encoded utf-8 octets representing a checkmark, indicating that the request actually is utf-8 encoded.\nvar charsetSentinel = 'utf8=%E2%9C%93'; // encodeURIComponent('')\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(options.delimiter, limit);\n    var skipIndex = -1; // Keep track of where the utf8 sentinel was found\n    var i;\n\n    var charset = options.charset;\n    if (options.charsetSentinel) {\n        for (i = 0; i < parts.length; ++i) {\n            if (parts[i].indexOf('utf8=') === 0) {\n                if (parts[i] === charsetSentinel) {\n                    charset = 'utf-8';\n                } else if (parts[i] === isoSentinel) {\n                    charset = 'iso-8859-1';\n                }\n                skipIndex = i;\n                i = parts.length; // The eslint settings do not allow break;\n            }\n        }\n    }\n\n    for (i = 0; i < parts.length; ++i) {\n        if (i === skipIndex) {\n            continue;\n        }\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder, charset, 'key');\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder, charset, 'key');\n            val = utils.maybeMap(\n                parseArrayValue(part.slice(pos + 1), options),\n                function (encodedVal) {\n                    return options.decoder(encodedVal, defaults.decoder, charset, 'value');\n                }\n            );\n        }\n\n        if (val && options.interpretNumericEntities && charset === 'iso-8859-1') {\n            val = interpretNumericEntities(val);\n        }\n\n        if (part.indexOf('[]=') > -1) {\n            val = isArray(val) ? [val] : val;\n        }\n\n        if (has.call(obj, key)) {\n            obj[key] = utils.combine(obj[key], val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options, valuesParsed) {\n    var leaf = valuesParsed ? val : parseArrayValue(val, options);\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]' && options.parseArrays) {\n            obj = [].concat(leaf);\n        } else {\n            obj = options.plainObjects ? Object.create(null) : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var index = parseInt(cleanRoot, 10);\n            if (!options.parseArrays && cleanRoot === '') {\n                obj = { 0: leaf };\n            } else if (\n                !isNaN(index)\n                && root !== cleanRoot\n                && String(index) === cleanRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else if (cleanRoot !== '__proto__') {\n                obj[cleanRoot] = leaf;\n            }\n        }\n\n        leaf = obj;\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options, valuesParsed) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = options.depth > 0 && brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while (options.depth > 0 && (segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options, valuesParsed);\n};\n\nvar normalizeParseOptions = function normalizeParseOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (opts.decoder !== null && opts.decoder !== undefined && typeof opts.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n    var charset = typeof opts.charset === 'undefined' ? defaults.charset : opts.charset;\n\n    return {\n        allowDots: typeof opts.allowDots === 'undefined' ? defaults.allowDots : !!opts.allowDots,\n        allowPrototypes: typeof opts.allowPrototypes === 'boolean' ? opts.allowPrototypes : defaults.allowPrototypes,\n        arrayLimit: typeof opts.arrayLimit === 'number' ? opts.arrayLimit : defaults.arrayLimit,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        comma: typeof opts.comma === 'boolean' ? opts.comma : defaults.comma,\n        decoder: typeof opts.decoder === 'function' ? opts.decoder : defaults.decoder,\n        delimiter: typeof opts.delimiter === 'string' || utils.isRegExp(opts.delimiter) ? opts.delimiter : defaults.delimiter,\n        // eslint-disable-next-line no-implicit-coercion, no-extra-parens\n        depth: (typeof opts.depth === 'number' || opts.depth === false) ? +opts.depth : defaults.depth,\n        ignoreQueryPrefix: opts.ignoreQueryPrefix === true,\n        interpretNumericEntities: typeof opts.interpretNumericEntities === 'boolean' ? opts.interpretNumericEntities : defaults.interpretNumericEntities,\n        parameterLimit: typeof opts.parameterLimit === 'number' ? opts.parameterLimit : defaults.parameterLimit,\n        parseArrays: opts.parseArrays !== false,\n        plainObjects: typeof opts.plainObjects === 'boolean' ? opts.plainObjects : defaults.plainObjects,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling\n    };\n};\n\nmodule.exports = function (str, opts) {\n    var options = normalizeParseOptions(opts);\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options, typeof str === 'string');\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar formats = require('./formats');\nvar has = Object.prototype.hasOwnProperty;\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) {\n        return prefix + '[]';\n    },\n    comma: 'comma',\n    indices: function indices(prefix, key) {\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) {\n        return prefix;\n    }\n};\n\nvar isArray = Array.isArray;\nvar split = String.prototype.split;\nvar push = Array.prototype.push;\nvar pushToArray = function (arr, valueOrArray) {\n    push.apply(arr, isArray(valueOrArray) ? valueOrArray : [valueOrArray]);\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaultFormat = formats['default'];\nvar defaults = {\n    addQueryPrefix: false,\n    allowDots: false,\n    charset: 'utf-8',\n    charsetSentinel: false,\n    delimiter: '&',\n    encode: true,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    format: defaultFormat,\n    formatter: formats.formatters[defaultFormat],\n    // deprecated\n    indices: false,\n    serializeDate: function serializeDate(date) {\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar isNonNullishPrimitive = function isNonNullishPrimitive(v) {\n    return typeof v === 'string'\n        || typeof v === 'number'\n        || typeof v === 'boolean'\n        || typeof v === 'symbol'\n        || typeof v === 'bigint';\n};\n\nvar stringify = function stringify(\n    object,\n    prefix,\n    generateArrayPrefix,\n    strictNullHandling,\n    skipNulls,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    format,\n    formatter,\n    encodeValuesOnly,\n    charset\n) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (generateArrayPrefix === 'comma' && isArray(obj)) {\n        obj = utils.maybeMap(obj, function (value) {\n            if (value instanceof Date) {\n                return serializeDate(value);\n            }\n            return value;\n        });\n    }\n\n    if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder, charset, 'key', format) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (isNonNullishPrimitive(obj) || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder, charset, 'key', format);\n            if (generateArrayPrefix === 'comma' && encodeValuesOnly) {\n                var valuesArray = split.call(String(obj), ',');\n                var valuesJoined = '';\n                for (var i = 0; i < valuesArray.length; ++i) {\n                    valuesJoined += (i === 0 ? '' : ',') + formatter(encoder(valuesArray[i], defaults.encoder, charset, 'value', format));\n                }\n                return [formatter(keyValue) + '=' + valuesJoined];\n            }\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder, charset, 'value', format))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (generateArrayPrefix === 'comma' && isArray(obj)) {\n        // we need to join elements in\n        objKeys = [{ value: obj.length > 0 ? obj.join(',') || null : void undefined }];\n    } else if (isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var j = 0; j < objKeys.length; ++j) {\n        var key = objKeys[j];\n        var value = typeof key === 'object' && typeof key.value !== 'undefined' ? key.value : obj[key];\n\n        if (skipNulls && value === null) {\n            continue;\n        }\n\n        var keyPrefix = isArray(obj)\n            ? typeof generateArrayPrefix === 'function' ? generateArrayPrefix(prefix, key) : prefix\n            : prefix + (allowDots ? '.' + key : '[' + key + ']');\n\n        pushToArray(values, stringify(\n            value,\n            keyPrefix,\n            generateArrayPrefix,\n            strictNullHandling,\n            skipNulls,\n            encoder,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            format,\n            formatter,\n            encodeValuesOnly,\n            charset\n        ));\n    }\n\n    return values;\n};\n\nvar normalizeStringifyOptions = function normalizeStringifyOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (opts.encoder !== null && typeof opts.encoder !== 'undefined' && typeof opts.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var charset = opts.charset || defaults.charset;\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n\n    var format = formats['default'];\n    if (typeof opts.format !== 'undefined') {\n        if (!has.call(formats.formatters, opts.format)) {\n            throw new TypeError('Unknown format option provided.');\n        }\n        format = opts.format;\n    }\n    var formatter = formats.formatters[format];\n\n    var filter = defaults.filter;\n    if (typeof opts.filter === 'function' || isArray(opts.filter)) {\n        filter = opts.filter;\n    }\n\n    return {\n        addQueryPrefix: typeof opts.addQueryPrefix === 'boolean' ? opts.addQueryPrefix : defaults.addQueryPrefix,\n        allowDots: typeof opts.allowDots === 'undefined' ? defaults.allowDots : !!opts.allowDots,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        delimiter: typeof opts.delimiter === 'undefined' ? defaults.delimiter : opts.delimiter,\n        encode: typeof opts.encode === 'boolean' ? opts.encode : defaults.encode,\n        encoder: typeof opts.encoder === 'function' ? opts.encoder : defaults.encoder,\n        encodeValuesOnly: typeof opts.encodeValuesOnly === 'boolean' ? opts.encodeValuesOnly : defaults.encodeValuesOnly,\n        filter: filter,\n        format: format,\n        formatter: formatter,\n        serializeDate: typeof opts.serializeDate === 'function' ? opts.serializeDate : defaults.serializeDate,\n        skipNulls: typeof opts.skipNulls === 'boolean' ? opts.skipNulls : defaults.skipNulls,\n        sort: typeof opts.sort === 'function' ? opts.sort : null,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling\n    };\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = normalizeStringifyOptions(opts);\n\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (opts && opts.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = opts.arrayFormat;\n    } else if (opts && 'indices' in opts) {\n        arrayFormat = opts.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (options.sort) {\n        objKeys.sort(options.sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (options.skipNulls && obj[key] === null) {\n            continue;\n        }\n        pushToArray(keys, stringify(\n            obj[key],\n            key,\n            generateArrayPrefix,\n            options.strictNullHandling,\n            options.skipNulls,\n            options.encode ? options.encoder : null,\n            options.filter,\n            options.sort,\n            options.allowDots,\n            options.serializeDate,\n            options.format,\n            options.formatter,\n            options.encodeValuesOnly,\n            options.charset\n        ));\n    }\n\n    var joined = keys.join(options.delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    if (options.charsetSentinel) {\n        if (options.charset === 'iso-8859-1') {\n            // encodeURIComponent('&#10003;'), the \"numeric entity\" representation of a checkmark\n            prefix += 'utf8=%26%2310003%3B&';\n        } else {\n            // encodeURIComponent('')\n            prefix += 'utf8=%E2%9C%93&';\n        }\n    }\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n","'use strict';\n\nvar formats = require('./formats');\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    while (queue.length > 1) {\n        var item = queue.pop();\n        var obj = item.obj[item.prop];\n\n        if (isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    /* eslint no-param-reassign: 0 */\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (isArray(target)) {\n            target.push(source);\n        } else if (target && typeof target === 'object') {\n            if ((options && (options.plainObjects || options.allowPrototypes)) || !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (!target || typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (isArray(target) && !isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (isArray(target) && isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                var targetItem = target[i];\n                if (targetItem && typeof targetItem === 'object' && item && typeof item === 'object') {\n                    target[i] = merge(targetItem, item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str, decoder, charset) {\n    var strWithoutPlus = str.replace(/\\+/g, ' ');\n    if (charset === 'iso-8859-1') {\n        // unescape never throws, no try...catch needed:\n        return strWithoutPlus.replace(/%[0-9a-f]{2}/gi, unescape);\n    }\n    // utf-8\n    try {\n        return decodeURIComponent(strWithoutPlus);\n    } catch (e) {\n        return strWithoutPlus;\n    }\n};\n\nvar encode = function encode(str, defaultEncoder, charset, kind, format) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = str;\n    if (typeof str === 'symbol') {\n        string = Symbol.prototype.toString.call(str);\n    } else if (typeof str !== 'string') {\n        string = String(str);\n    }\n\n    if (charset === 'iso-8859-1') {\n        return escape(string).replace(/%u[0-9a-f]{4}/gi, function ($0) {\n            return '%26%23' + parseInt($0.slice(2), 16) + '%3B';\n        });\n    }\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D // -\n            || c === 0x2E // .\n            || c === 0x5F // _\n            || c === 0x7E // ~\n            || (c >= 0x30 && c <= 0x39) // 0-9\n            || (c >= 0x41 && c <= 0x5A) // a-z\n            || (c >= 0x61 && c <= 0x7A) // A-Z\n            || (format === formats.RFC1738 && (c === 0x28 || c === 0x29)) // ( )\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        /* eslint operator-linebreak: [2, \"before\"] */\n        out += hexTable[0xF0 | (c >> 18)]\n            + hexTable[0x80 | ((c >> 12) & 0x3F)]\n            + hexTable[0x80 | ((c >> 6) & 0x3F)]\n            + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    compactQueue(queue);\n\n    return value;\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (!obj || typeof obj !== 'object') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nvar combine = function combine(a, b) {\n    return [].concat(a, b);\n};\n\nvar maybeMap = function maybeMap(val, fn) {\n    if (isArray(val)) {\n        var mapped = [];\n        for (var i = 0; i < val.length; i += 1) {\n            mapped.push(fn(val[i]));\n        }\n        return mapped;\n    }\n    return fn(val);\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    combine: combine,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    maybeMap: maybeMap,\n    merge: merge\n};\n","'use strict';\n\nvar AlgoliaSearchHelper = require('./src/algoliasearch.helper');\nvar SearchParameters = require('./src/SearchParameters');\nvar SearchResults = require('./src/SearchResults');\n\n/**\n * The algoliasearchHelper module is the function that will let its\n * contains everything needed to use the Algoliasearch\n * Helper. It is a also a function that instanciate the helper.\n * To use the helper, you also need the Algolia JS client v3.\n * @example\n * //using the UMD build\n * var client = algoliasearch('latency', '6be0576ff61c053d5f9a3225e2a90f76');\n * var helper = algoliasearchHelper(client, 'bestbuy', {\n *   facets: ['shipping'],\n *   disjunctiveFacets: ['category']\n * });\n * helper.on('result', function(event) {\n *   console.log(event.results);\n * });\n * helper\n *   .toggleFacetRefinement('category', 'Movies & TV Shows')\n *   .toggleFacetRefinement('shipping', 'Free shipping')\n *   .search();\n * @example\n * // The helper is an event emitter using the node API\n * helper.on('result', updateTheResults);\n * helper.once('result', updateTheResults);\n * helper.removeListener('result', updateTheResults);\n * helper.removeAllListeners('result');\n * @module algoliasearchHelper\n * @param  {AlgoliaSearch} client an AlgoliaSearch client\n * @param  {string} index the name of the index to query\n * @param  {SearchParameters|object} opts an object defining the initial config of the search. It doesn't have to be a {SearchParameters}, just an object containing the properties you need from it.\n * @return {AlgoliaSearchHelper} The helper instance\n */\nfunction algoliasearchHelper(client, index, opts) {\n  return new AlgoliaSearchHelper(client, index, opts);\n}\n\n/**\n * The version currently used\n * @member module:algoliasearchHelper.version\n * @type {number}\n */\nalgoliasearchHelper.version = require('./src/version');\n\n/**\n * Constructor for the Helper.\n * @member module:algoliasearchHelper.AlgoliaSearchHelper\n * @type {AlgoliaSearchHelper}\n */\nalgoliasearchHelper.AlgoliaSearchHelper = AlgoliaSearchHelper;\n\n/**\n * Constructor for the object containing all the parameters of the search.\n * @member module:algoliasearchHelper.SearchParameters\n * @type {SearchParameters}\n */\nalgoliasearchHelper.SearchParameters = SearchParameters;\n\n/**\n * Constructor for the object containing the results of the search.\n * @member module:algoliasearchHelper.SearchResults\n * @type {SearchResults}\n */\nalgoliasearchHelper.SearchResults = SearchResults;\n\nmodule.exports = algoliasearchHelper;\n","'use strict';\n\nvar EventEmitter = require('@algolia/events');\n\nvar inherits = require('../functions/inherits');\n\n/**\n * A DerivedHelper is a way to create sub requests to\n * Algolia from a main helper.\n * @class\n * @classdesc The DerivedHelper provides an event based interface for search callbacks:\n *  - search: when a search is triggered using the `search()` method.\n *  - result: when the response is retrieved from Algolia and is processed.\n *    This event contains a {@link SearchResults} object and the\n *    {@link SearchParameters} corresponding to this answer.\n * @param {AlgoliaSearchHelper} mainHelper the main helper\n * @param {function} fn the function to create the derived state\n */\nfunction DerivedHelper(mainHelper, fn) {\n  this.main = mainHelper;\n  this.fn = fn;\n  this.lastResults = null;\n}\n\ninherits(DerivedHelper, EventEmitter);\n\n/**\n * Detach this helper from the main helper\n * @return {undefined}\n * @throws Error if the derived helper is already detached\n */\nDerivedHelper.prototype.detach = function () {\n  this.removeAllListeners();\n  this.main.detachDerivedHelper(this);\n};\n\nDerivedHelper.prototype.getModifiedState = function (parameters) {\n  return this.fn(parameters);\n};\n\nmodule.exports = DerivedHelper;\n","'use strict';\n\n/**\n * Functions to manipulate refinement lists\n *\n * The RefinementList is not formally defined through a prototype but is based\n * on a specific structure.\n *\n * @module SearchParameters.refinementList\n *\n * @typedef {string[]} SearchParameters.refinementList.Refinements\n * @typedef {Object.<string, SearchParameters.refinementList.Refinements>} SearchParameters.refinementList.RefinementList\n */\n\nvar defaultsPure = require('../functions/defaultsPure');\nvar objectHasKeys = require('../functions/objectHasKeys');\nvar omit = require('../functions/omit');\n\nvar lib = {\n  /**\n   * Adds a refinement to a RefinementList\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} value the value of the refinement, if the value is not a string it will be converted\n   * @return {RefinementList} a new and updated refinement list\n   */\n  addRefinement: function addRefinement(refinementList, attribute, value) {\n    if (lib.isRefined(refinementList, attribute, value)) {\n      return refinementList;\n    }\n\n    var valueAsString = '' + value;\n\n    var facetRefinement = !refinementList[attribute]\n      ? [valueAsString]\n      : refinementList[attribute].concat(valueAsString);\n\n    var mod = {};\n\n    mod[attribute] = facetRefinement;\n\n    return defaultsPure({}, mod, refinementList);\n  },\n  /**\n   * Removes refinement(s) for an attribute:\n   *  - if the value is specified removes the refinement for the value on the attribute\n   *  - if no value is specified removes all the refinements for this attribute\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} [value] the value of the refinement\n   * @return {RefinementList} a new and updated refinement lst\n   */\n  removeRefinement: function removeRefinement(\n    refinementList,\n    attribute,\n    value\n  ) {\n    if (value === undefined) {\n      // we use the \"filter\" form of clearRefinement, since it leaves empty values as-is\n      // the form with a string will remove the attribute completely\n      return lib.clearRefinement(refinementList, function (v, f) {\n        return attribute === f;\n      });\n    }\n\n    var valueAsString = '' + value;\n\n    return lib.clearRefinement(refinementList, function (v, f) {\n      return attribute === f && valueAsString === v;\n    });\n  },\n  /**\n   * Toggles the refinement value for an attribute.\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} attribute the attribute to refine\n   * @param {string} value the value of the refinement\n   * @return {RefinementList} a new and updated list\n   */\n  toggleRefinement: function toggleRefinement(\n    refinementList,\n    attribute,\n    value\n  ) {\n    if (value === undefined)\n      throw new Error('toggleRefinement should be used with a value');\n\n    if (lib.isRefined(refinementList, attribute, value)) {\n      return lib.removeRefinement(refinementList, attribute, value);\n    }\n\n    return lib.addRefinement(refinementList, attribute, value);\n  },\n  /**\n   * Clear all or parts of a RefinementList. Depending on the arguments, three\n   * kinds of behavior can happen:\n   *  - if no attribute is provided: clears the whole list\n   *  - if an attribute is provided as a string: clears the list for the specific attribute\n   *  - if an attribute is provided as a function: discards the elements for which the function returns true\n   * @param {RefinementList} refinementList the initial list\n   * @param {string} [attribute] the attribute or function to discard\n   * @param {string} [refinementType] optional parameter to give more context to the attribute function\n   * @return {RefinementList} a new and updated refinement list\n   */\n  clearRefinement: function clearRefinement(\n    refinementList,\n    attribute,\n    refinementType\n  ) {\n    if (attribute === undefined) {\n      // return the same object if the list is already empty\n      // this is mainly for tests, as it doesn't have much impact on performance\n      if (!objectHasKeys(refinementList)) {\n        return refinementList;\n      }\n      return {};\n    } else if (typeof attribute === 'string') {\n      return omit(refinementList, [attribute]);\n    } else if (typeof attribute === 'function') {\n      var hasChanged = false;\n\n      var newRefinementList = Object.keys(refinementList).reduce(function (\n        memo,\n        key\n      ) {\n        var values = refinementList[key] || [];\n        var facetList = values.filter(function (value) {\n          return !attribute(value, key, refinementType);\n        });\n\n        if (facetList.length !== values.length) {\n          hasChanged = true;\n        }\n\n        memo[key] = facetList;\n\n        return memo;\n      },\n      {});\n\n      if (hasChanged) return newRefinementList;\n      return refinementList;\n    }\n\n    // We return nothing if the attribute is not undefined, a string or a function,\n    // as it is not a valid value for a refinement\n    return undefined;\n  },\n  /**\n   * Test if the refinement value is used for the attribute. If no refinement value\n   * is provided, test if the refinementList contains any refinement for the\n   * given attribute.\n   * @param {RefinementList} refinementList the list of refinement\n   * @param {string} attribute name of the attribute\n   * @param {string} [refinementValue] value of the filter/refinement\n   * @return {boolean} true if the attribute is refined, false otherwise\n   */\n  isRefined: function isRefined(refinementList, attribute, refinementValue) {\n    var containsRefinements =\n      Boolean(refinementList[attribute]) &&\n      refinementList[attribute].length > 0;\n\n    if (refinementValue === undefined || !containsRefinements) {\n      return containsRefinements;\n    }\n\n    var refinementValueAsString = '' + refinementValue;\n\n    return refinementList[attribute].indexOf(refinementValueAsString) !== -1;\n  },\n};\n\nmodule.exports = lib;\n","'use strict';\n\nvar defaultsPure = require('../functions/defaultsPure');\nvar find = require('../functions/find');\nvar intersection = require('../functions/intersection');\nvar merge = require('../functions/merge');\nvar objectHasKeys = require('../functions/objectHasKeys');\nvar omit = require('../functions/omit');\nvar valToNumber = require('../functions/valToNumber');\nvar isValidUserToken = require('../utils/isValidUserToken');\n\nvar RefinementList = require('./RefinementList');\n\n/**\n * isEqual, but only for numeric refinement values, possible values:\n * - 5\n * - [5]\n * - [[5]]\n * - [[5,5],[4]]\n * @param {any} a numeric refinement value\n * @param {any} b numeric refinement value\n * @return {boolean} true if the values are equal\n */\nfunction isEqualNumericRefinement(a, b) {\n  if (Array.isArray(a) && Array.isArray(b)) {\n    return (\n      a.length === b.length &&\n      a.every(function (el, i) {\n        return isEqualNumericRefinement(b[i], el);\n      })\n    );\n  }\n  return a === b;\n}\n\n/**\n * like _.find but using deep equality to be able to use it\n * to find arrays.\n * @private\n * @param {any[]} array array to search into (elements are base or array of base)\n * @param {any} searchedValue the value we're looking for (base or array of base)\n * @return {any} the searched value or undefined\n */\nfunction findArray(array, searchedValue) {\n  return find(array, function (currentValue) {\n    return isEqualNumericRefinement(currentValue, searchedValue);\n  });\n}\n\n/**\n * The facet list is the structure used to store the list of values used to\n * filter a single attribute.\n * @typedef {string[]} SearchParameters.FacetList\n */\n\n/**\n * Structure to store numeric filters with the operator as the key. The supported operators\n * are `=`, `>`, `<`, `>=`, `<=` and `!=`.\n * @typedef {Object.<string, Array.<number|number[]>>} SearchParameters.OperatorList\n */\n\n/**\n * SearchParameters is the data structure that contains all the information\n * usable for making a search to Algolia API. It doesn't do the search itself,\n * nor does it contains logic about the parameters.\n * It is an immutable object, therefore it has been created in a way that each\n * changes does not change the object itself but returns a copy with the\n * modification.\n * This object should probably not be instantiated outside of the helper. It will\n * be provided when needed. This object is documented for reference as you'll\n * get it from events generated by the {@link AlgoliaSearchHelper}.\n * If need be, instantiate the Helper from the factory function {@link SearchParameters.make}\n * @constructor\n * @classdesc contains all the parameters of a search\n * @param {object|SearchParameters} newParameters existing parameters or partial object\n * for the properties of a new SearchParameters\n * @see SearchParameters.make\n * @example <caption>SearchParameters of the first query in\n *   <a href=\"http://demos.algolia.com/instant-search-demo/\">the instant search demo</a></caption>\n{\n   \"query\": \"\",\n   \"disjunctiveFacets\": [\n      \"customerReviewCount\",\n      \"category\",\n      \"salePrice_range\",\n      \"manufacturer\"\n  ],\n   \"maxValuesPerFacet\": 30,\n   \"page\": 0,\n   \"hitsPerPage\": 10,\n   \"facets\": [\n      \"type\",\n      \"shipping\"\n  ]\n}\n */\nfunction SearchParameters(newParameters) {\n  var params = newParameters\n    ? SearchParameters._parseNumbers(newParameters)\n    : {};\n\n  if (params.userToken !== undefined && !isValidUserToken(params.userToken)) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      '[algoliasearch-helper] The `userToken` parameter is invalid. This can lead to wrong analytics.\\n  - Format: [a-zA-Z0-9_-]{1,64}'\n    );\n  }\n  /**\n   * This attribute contains the list of all the conjunctive facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * @member {string[]}\n   */\n  this.facets = params.facets || [];\n  /**\n   * This attribute contains the list of all the disjunctive facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * @member {string[]}\n   */\n  this.disjunctiveFacets = params.disjunctiveFacets || [];\n  /**\n   * This attribute contains the list of all the hierarchical facets\n   * used. This list will be added to requested facets in the\n   * [facets attribute](https://www.algolia.com/doc/rest-api/search#param-facets) sent to algolia.\n   * Hierarchical facets are a sub type of disjunctive facets that\n   * let you filter faceted attributes hierarchically.\n   * @member {string[]|object[]}\n   */\n  this.hierarchicalFacets = params.hierarchicalFacets || [];\n\n  // Refinements\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the conjunctive facets. Each facet must be properly\n   * defined in the `facets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.facetsRefinements = params.facetsRefinements || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * excluded from the conjunctive facets. Each facet must be properly\n   * defined in the `facets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters excluded for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.facetsExcludes = params.facetsExcludes || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the disjunctive facets. Each facet must be properly\n   * defined in the `disjunctiveFacets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.disjunctiveFacetsRefinements = params.disjunctiveFacetsRefinements || {};\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the numeric attributes.\n   *\n   * The key is the name of the attribute, and the value is the\n   * filters to apply to this attribute.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `numericFilters` attribute.\n   * @member {Object.<string, SearchParameters.OperatorList>}\n   */\n  this.numericRefinements = params.numericRefinements || {};\n  /**\n   * This attribute contains all the tags used to refine the query.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `tagFilters` attribute.\n   * @member {string[]}\n   */\n  this.tagRefinements = params.tagRefinements || [];\n  /**\n   * This attribute contains all the filters that need to be\n   * applied on the hierarchical facets. Each facet must be properly\n   * defined in the `hierarchicalFacets` attribute.\n   *\n   * The key is the name of the facet, and the `FacetList` contains all\n   * filters selected for the associated facet name. The FacetList values\n   * are structured as a string that contain the values for each level\n   * separated by the configured separator.\n   *\n   * When querying algolia, the values stored in this attribute will\n   * be translated into the `facetFilters` attribute.\n   * @member {Object.<string, SearchParameters.FacetList>}\n   */\n  this.hierarchicalFacetsRefinements =\n    params.hierarchicalFacetsRefinements || {};\n\n  // eslint-disable-next-line consistent-this\n  var self = this;\n  Object.keys(params).forEach(function (paramName) {\n    var isKeyKnown = SearchParameters.PARAMETERS.indexOf(paramName) !== -1;\n    var isValueDefined = params[paramName] !== undefined;\n\n    if (!isKeyKnown && isValueDefined) {\n      self[paramName] = params[paramName];\n    }\n  });\n}\n\n/**\n * List all the properties in SearchParameters and therefore all the known Algolia properties\n * This doesn't contain any beta/hidden features.\n * @private\n */\nSearchParameters.PARAMETERS = Object.keys(new SearchParameters());\n\n/**\n * @private\n * @param {object} partialState full or part of a state\n * @return {object} a new object with the number keys as number\n */\nSearchParameters._parseNumbers = function (partialState) {\n  // Do not parse numbers again in SearchParameters, they ought to be parsed already\n  if (partialState instanceof SearchParameters) return partialState;\n\n  var numbers = {};\n\n  var numberKeys = [\n    'aroundPrecision',\n    'aroundRadius',\n    'getRankingInfo',\n    'minWordSizefor2Typos',\n    'minWordSizefor1Typo',\n    'page',\n    'maxValuesPerFacet',\n    'distinct',\n    'minimumAroundRadius',\n    'hitsPerPage',\n    'minProximity',\n  ];\n\n  numberKeys.forEach(function (k) {\n    var value = partialState[k];\n    if (typeof value === 'string') {\n      var parsedValue = parseFloat(value);\n      // global isNaN is ok to use here, value is only number or NaN\n      numbers[k] = isNaN(parsedValue) ? value : parsedValue;\n    }\n  });\n\n  // there's two formats of insideBoundingBox, we need to parse\n  // the one which is an array of float geo rectangles\n  if (Array.isArray(partialState.insideBoundingBox)) {\n    numbers.insideBoundingBox = partialState.insideBoundingBox.map(function (\n      geoRect\n    ) {\n      if (Array.isArray(geoRect)) {\n        return geoRect.map(function (value) {\n          return parseFloat(value);\n        });\n      }\n      return geoRect;\n    });\n  }\n\n  if (partialState.numericRefinements) {\n    var numericRefinements = {};\n    Object.keys(partialState.numericRefinements).forEach(function (attribute) {\n      var operators = partialState.numericRefinements[attribute] || {};\n      numericRefinements[attribute] = {};\n      Object.keys(operators).forEach(function (operator) {\n        var values = operators[operator];\n        var parsedValues = values.map(function (v) {\n          if (Array.isArray(v)) {\n            return v.map(function (vPrime) {\n              if (typeof vPrime === 'string') {\n                return parseFloat(vPrime);\n              }\n              return vPrime;\n            });\n          } else if (typeof v === 'string') {\n            return parseFloat(v);\n          }\n          return v;\n        });\n        numericRefinements[attribute][operator] = parsedValues;\n      });\n    });\n    numbers.numericRefinements = numericRefinements;\n  }\n\n  return merge({}, partialState, numbers);\n};\n\n/**\n * Factory for SearchParameters\n * @param {object|SearchParameters} newParameters existing parameters or partial\n * object for the properties of a new SearchParameters\n * @return {SearchParameters} frozen instance of SearchParameters\n */\nSearchParameters.make = function makeSearchParameters(newParameters) {\n  var instance = new SearchParameters(newParameters);\n\n  var hierarchicalFacets = newParameters.hierarchicalFacets || [];\n  hierarchicalFacets.forEach(function (facet) {\n    if (facet.rootPath) {\n      var currentRefinement = instance.getHierarchicalRefinement(facet.name);\n\n      if (\n        currentRefinement.length > 0 &&\n        currentRefinement[0].indexOf(facet.rootPath) !== 0\n      ) {\n        instance = instance.clearRefinements(facet.name);\n      }\n\n      // get it again in case it has been cleared\n      currentRefinement = instance.getHierarchicalRefinement(facet.name);\n      if (currentRefinement.length === 0) {\n        instance = instance.toggleHierarchicalFacetRefinement(\n          facet.name,\n          facet.rootPath\n        );\n      }\n    }\n  });\n\n  return instance;\n};\n\n/**\n * Validates the new parameters based on the previous state\n * @param {SearchParameters} currentState the current state\n * @param {object|SearchParameters} parameters the new parameters to set\n * @return {Error|null} Error if the modification is invalid, null otherwise\n */\nSearchParameters.validate = function (currentState, parameters) {\n  var params = parameters || {};\n\n  if (\n    currentState.tagFilters &&\n    params.tagRefinements &&\n    params.tagRefinements.length > 0\n  ) {\n    return new Error(\n      '[Tags] Cannot switch from the managed tag API to the advanced API. It is probably ' +\n        'an error, if it is really what you want, you should first clear the tags with clearTags method.'\n    );\n  }\n\n  if (currentState.tagRefinements.length > 0 && params.tagFilters) {\n    return new Error(\n      '[Tags] Cannot switch from the advanced tag API to the managed API. It is probably ' +\n        'an error, if it is not, you should first clear the tags with clearTags method.'\n    );\n  }\n\n  if (\n    currentState.numericFilters &&\n    params.numericRefinements &&\n    objectHasKeys(params.numericRefinements)\n  ) {\n    return new Error(\n      \"[Numeric filters] Can't switch from the advanced to the managed API. It\" +\n        ' is probably an error, if this is really what you want, you have to first' +\n        ' clear the numeric filters.'\n    );\n  }\n\n  if (objectHasKeys(currentState.numericRefinements) && params.numericFilters) {\n    return new Error(\n      \"[Numeric filters] Can't switch from the managed API to the advanced. It\" +\n        ' is probably an error, if this is really what you want, you have to first' +\n        ' clear the numeric filters.'\n    );\n  }\n\n  return null;\n};\n\nSearchParameters.prototype = {\n  constructor: SearchParameters,\n\n  /**\n   * Remove all refinements (disjunctive + conjunctive + excludes + numeric filters)\n   * @method\n   * @param {undefined|string|SearchParameters.clearCallback} [attribute] optional string or function\n   * - If not given, means to clear all the filters.\n   * - If `string`, means to clear all refinements for the `attribute` named filter.\n   * - If `function`, means to clear all the refinements that return truthy values.\n   * @return {SearchParameters} new instance with filters cleared\n   */\n  clearRefinements: function clearRefinements(attribute) {\n    var patch = {\n      numericRefinements: this._clearNumericRefinements(attribute),\n      facetsRefinements: RefinementList.clearRefinement(\n        this.facetsRefinements,\n        attribute,\n        'conjunctiveFacet'\n      ),\n      facetsExcludes: RefinementList.clearRefinement(\n        this.facetsExcludes,\n        attribute,\n        'exclude'\n      ),\n      disjunctiveFacetsRefinements: RefinementList.clearRefinement(\n        this.disjunctiveFacetsRefinements,\n        attribute,\n        'disjunctiveFacet'\n      ),\n      hierarchicalFacetsRefinements: RefinementList.clearRefinement(\n        this.hierarchicalFacetsRefinements,\n        attribute,\n        'hierarchicalFacet'\n      ),\n    };\n    if (\n      patch.numericRefinements === this.numericRefinements &&\n      patch.facetsRefinements === this.facetsRefinements &&\n      patch.facetsExcludes === this.facetsExcludes &&\n      patch.disjunctiveFacetsRefinements ===\n        this.disjunctiveFacetsRefinements &&\n      patch.hierarchicalFacetsRefinements === this.hierarchicalFacetsRefinements\n    ) {\n      return this;\n    }\n    return this.setQueryParameters(patch);\n  },\n  /**\n   * Remove all the refined tags from the SearchParameters\n   * @method\n   * @return {SearchParameters} new instance with tags cleared\n   */\n  clearTags: function clearTags() {\n    if (this.tagFilters === undefined && this.tagRefinements.length === 0)\n      return this;\n\n    return this.setQueryParameters({\n      tagFilters: undefined,\n      tagRefinements: [],\n    });\n  },\n  /**\n   * Set the index.\n   * @method\n   * @param {string} index the index name\n   * @return {SearchParameters} new instance\n   */\n  setIndex: function setIndex(index) {\n    if (index === this.index) return this;\n\n    return this.setQueryParameters({\n      index: index,\n    });\n  },\n  /**\n   * Query setter\n   * @method\n   * @param {string} newQuery value for the new query\n   * @return {SearchParameters} new instance\n   */\n  setQuery: function setQuery(newQuery) {\n    if (newQuery === this.query) return this;\n\n    return this.setQueryParameters({\n      query: newQuery,\n    });\n  },\n  /**\n   * Page setter\n   * @method\n   * @param {number} newPage new page number\n   * @return {SearchParameters} new instance\n   */\n  setPage: function setPage(newPage) {\n    if (newPage === this.page) return this;\n\n    return this.setQueryParameters({\n      page: newPage,\n    });\n  },\n  /**\n   * Facets setter\n   * The facets are the simple facets, used for conjunctive (and) faceting.\n   * @method\n   * @param {string[]} facets all the attributes of the algolia records used for conjunctive faceting\n   * @return {SearchParameters} new instance\n   */\n  setFacets: function setFacets(facets) {\n    return this.setQueryParameters({\n      facets: facets,\n    });\n  },\n  /**\n   * Disjunctive facets setter\n   * Change the list of disjunctive (or) facets the helper chan handle.\n   * @method\n   * @param {string[]} facets all the attributes of the algolia records used for disjunctive faceting\n   * @return {SearchParameters} new instance\n   */\n  setDisjunctiveFacets: function setDisjunctiveFacets(facets) {\n    return this.setQueryParameters({\n      disjunctiveFacets: facets,\n    });\n  },\n  /**\n   * HitsPerPage setter\n   * Hits per page represents the number of hits retrieved for this query\n   * @method\n   * @param {number} n number of hits retrieved per page of results\n   * @return {SearchParameters} new instance\n   */\n  setHitsPerPage: function setHitsPerPage(n) {\n    if (this.hitsPerPage === n) return this;\n\n    return this.setQueryParameters({\n      hitsPerPage: n,\n    });\n  },\n  /**\n   * typoTolerance setter\n   * Set the value of typoTolerance\n   * @method\n   * @param {string} typoTolerance new value of typoTolerance (\"true\", \"false\", \"min\" or \"strict\")\n   * @return {SearchParameters} new instance\n   */\n  setTypoTolerance: function setTypoTolerance(typoTolerance) {\n    if (this.typoTolerance === typoTolerance) return this;\n\n    return this.setQueryParameters({\n      typoTolerance: typoTolerance,\n    });\n  },\n  /**\n   * Add a numeric filter for a given attribute\n   * When value is an array, they are combined with OR\n   * When value is a single value, it will combined with AND\n   * @method\n   * @param {string} attribute attribute to set the filter on\n   * @param {string} operator operator of the filter (possible values: =, >, >=, <, <=, !=)\n   * @param {number | number[]} value value of the filter\n   * @return {SearchParameters} new instance\n   * @example\n   * // for price = 50 or 40\n   * state.addNumericRefinement('price', '=', [50, 40]);\n   * @example\n   * // for size = 38 and 40\n   * state.addNumericRefinement('size', '=', 38);\n   * state.addNumericRefinement('size', '=', 40);\n   */\n  addNumericRefinement: function (attribute, operator, value) {\n    var val = valToNumber(value);\n\n    if (this.isNumericRefined(attribute, operator, val)) return this;\n\n    var mod = merge({}, this.numericRefinements);\n\n    mod[attribute] = merge({}, mod[attribute]);\n\n    if (mod[attribute][operator]) {\n      // Array copy\n      mod[attribute][operator] = mod[attribute][operator].slice();\n      // Add the element. Concat can't be used here because value can be an array.\n      mod[attribute][operator].push(val);\n    } else {\n      mod[attribute][operator] = [val];\n    }\n\n    return this.setQueryParameters({\n      numericRefinements: mod,\n    });\n  },\n  /**\n   * Get the list of conjunctive refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getConjunctiveRefinements: function (facetName) {\n    if (!this.isConjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.facetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of disjunctive refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getDisjunctiveRefinements: function (facetName) {\n    if (!this.isDisjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.disjunctiveFacetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of hierarchical refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getHierarchicalRefinement: function (facetName) {\n    // we send an array but we currently do not support multiple\n    // hierarchicalRefinements for a hierarchicalFacet\n    return this.hierarchicalFacetsRefinements[facetName] || [];\n  },\n  /**\n   * Get the list of exclude refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {string[]} list of refinements\n   */\n  getExcludeRefinements: function (facetName) {\n    if (!this.isConjunctiveFacet(facetName)) {\n      return [];\n    }\n    return this.facetsExcludes[facetName] || [];\n  },\n\n  /**\n   * Remove all the numeric filter for a given (attribute, operator)\n   * @method\n   * @param {string} attribute attribute to set the filter on\n   * @param {string} [operator] operator of the filter (possible values: =, >, >=, <, <=, !=)\n   * @param {number} [number] the value to be removed\n   * @return {SearchParameters} new instance\n   */\n  removeNumericRefinement: function (attribute, operator, number) {\n    var paramValue = number;\n    if (paramValue !== undefined) {\n      if (!this.isNumericRefined(attribute, operator, paramValue)) {\n        return this;\n      }\n      return this.setQueryParameters({\n        numericRefinements: this._clearNumericRefinements(function (\n          value,\n          key\n        ) {\n          return (\n            key === attribute &&\n            value.op === operator &&\n            isEqualNumericRefinement(value.val, valToNumber(paramValue))\n          );\n        }),\n      });\n    } else if (operator !== undefined) {\n      if (!this.isNumericRefined(attribute, operator)) return this;\n      return this.setQueryParameters({\n        numericRefinements: this._clearNumericRefinements(function (\n          value,\n          key\n        ) {\n          return key === attribute && value.op === operator;\n        }),\n      });\n    }\n\n    if (!this.isNumericRefined(attribute)) return this;\n    return this.setQueryParameters({\n      numericRefinements: this._clearNumericRefinements(function (value, key) {\n        return key === attribute;\n      }),\n    });\n  },\n  /**\n   * Get the list of numeric refinements for a single facet\n   * @param {string} facetName name of the attribute used for faceting\n   * @return {SearchParameters.OperatorList} list of refinements\n   */\n  getNumericRefinements: function (facetName) {\n    return this.numericRefinements[facetName] || {};\n  },\n  /**\n   * Return the current refinement for the (attribute, operator)\n   * @param {string} attribute attribute in the record\n   * @param {string} operator operator applied on the refined values\n   * @return {Array.<number|number[]>} refined values\n   */\n  getNumericRefinement: function (attribute, operator) {\n    return (\n      this.numericRefinements[attribute] &&\n      this.numericRefinements[attribute][operator]\n    );\n  },\n  /**\n   * Clear numeric filters.\n   * @method\n   * @private\n   * @param {string|SearchParameters.clearCallback} [attribute] optional string or function\n   * - If not given, means to clear all the filters.\n   * - If `string`, means to clear all refinements for the `attribute` named filter.\n   * - If `function`, means to clear all the refinements that return truthy values.\n   * @return {Object.<string, OperatorList>} new numeric refinements\n   */\n  _clearNumericRefinements: function _clearNumericRefinements(attribute) {\n    if (attribute === undefined) {\n      if (!objectHasKeys(this.numericRefinements)) {\n        return this.numericRefinements;\n      }\n      return {};\n    } else if (typeof attribute === 'string') {\n      return omit(this.numericRefinements, [attribute]);\n    } else if (typeof attribute === 'function') {\n      var hasChanged = false;\n      var numericRefinements = this.numericRefinements;\n      var newNumericRefinements = Object.keys(numericRefinements).reduce(\n        function (memo, key) {\n          var operators = numericRefinements[key];\n          var operatorList = {};\n\n          operators = operators || {};\n          Object.keys(operators).forEach(function (operator) {\n            var values = operators[operator] || [];\n            var outValues = [];\n            values.forEach(function (value) {\n              var predicateResult = attribute(\n                { val: value, op: operator },\n                key,\n                'numeric'\n              );\n              if (!predicateResult) outValues.push(value);\n            });\n            if (outValues.length !== values.length) {\n              hasChanged = true;\n            }\n            operatorList[operator] = outValues;\n          });\n\n          memo[key] = operatorList;\n\n          return memo;\n        },\n        {}\n      );\n\n      if (hasChanged) return newNumericRefinements;\n      return this.numericRefinements;\n    }\n\n    // We return nothing if the attribute is not undefined, a string or a function,\n    // as it is not a valid value for a refinement\n    return undefined;\n  },\n  /**\n   * Add a facet to the facets attribute of the helper configuration, if it\n   * isn't already present.\n   * @method\n   * @param {string} facet facet name to add\n   * @return {SearchParameters} new instance\n   */\n  addFacet: function addFacet(facet) {\n    if (this.isConjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.setQueryParameters({\n      facets: this.facets.concat([facet]),\n    });\n  },\n  /**\n   * Add a disjunctive facet to the disjunctiveFacets attribute of the helper\n   * configuration, if it isn't already present.\n   * @method\n   * @param {string} facet disjunctive facet name to add\n   * @return {SearchParameters} new instance\n   */\n  addDisjunctiveFacet: function addDisjunctiveFacet(facet) {\n    if (this.isDisjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.setQueryParameters({\n      disjunctiveFacets: this.disjunctiveFacets.concat([facet]),\n    });\n  },\n  /**\n   * Add a hierarchical facet to the hierarchicalFacets attribute of the helper\n   * configuration.\n   * @method\n   * @param {object} hierarchicalFacet hierarchical facet to add\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if a hierarchical facet with the same name was already declared\n   */\n  addHierarchicalFacet: function addHierarchicalFacet(hierarchicalFacet) {\n    if (this.isHierarchicalFacet(hierarchicalFacet.name)) {\n      throw new Error(\n        'Cannot declare two hierarchical facets with the same name: `' +\n          hierarchicalFacet.name +\n          '`'\n      );\n    }\n\n    return this.setQueryParameters({\n      hierarchicalFacets: this.hierarchicalFacets.concat([hierarchicalFacet]),\n    });\n  },\n  /**\n   * Add a refinement on a \"normal\" facet\n   * @method\n   * @param {string} facet attribute to apply the faceting on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addFacetRefinement: function addFacetRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (RefinementList.isRefined(this.facetsRefinements, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.addRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Exclude a value from a \"normal\" facet\n   * @method\n   * @param {string} facet attribute to apply the exclusion on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addExcludeRefinement: function addExcludeRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (RefinementList.isRefined(this.facetsExcludes, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.addRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Adds a refinement on a disjunctive facet.\n   * @method\n   * @param {string} facet attribute to apply the faceting on\n   * @param {string} value value of the attribute (will be converted to string)\n   * @return {SearchParameters} new instance\n   */\n  addDisjunctiveFacetRefinement: function addDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n\n    if (\n      RefinementList.isRefined(this.disjunctiveFacetsRefinements, facet, value)\n    )\n      return this;\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.addRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * addTagRefinement adds a tag to the list used to filter the results\n   * @param {string} tag tag to be added\n   * @return {SearchParameters} new instance\n   */\n  addTagRefinement: function addTagRefinement(tag) {\n    if (this.isTagRefined(tag)) return this;\n\n    var modification = {\n      tagRefinements: this.tagRefinements.concat(tag),\n    };\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Remove a facet from the facets attribute of the helper configuration, if it\n   * is present.\n   * @method\n   * @param {string} facet facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeFacet: function removeFacet(facet) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      facets: this.facets.filter(function (f) {\n        return f !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a disjunctive facet from the disjunctiveFacets attribute of the\n   * helper configuration, if it is present.\n   * @method\n   * @param {string} facet disjunctive facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeDisjunctiveFacet: function removeDisjunctiveFacet(facet) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      disjunctiveFacets: this.disjunctiveFacets.filter(function (f) {\n        return f !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a hierarchical facet from the hierarchicalFacets attribute of the\n   * helper configuration, if it is present.\n   * @method\n   * @param {string} facet hierarchical facet name to remove\n   * @return {SearchParameters} new instance\n   */\n  removeHierarchicalFacet: function removeHierarchicalFacet(facet) {\n    if (!this.isHierarchicalFacet(facet)) {\n      return this;\n    }\n\n    return this.clearRefinements(facet).setQueryParameters({\n      hierarchicalFacets: this.hierarchicalFacets.filter(function (f) {\n        return f.name !== facet;\n      }),\n    });\n  },\n  /**\n   * Remove a refinement set on facet. If a value is provided, it will clear the\n   * refinement for the given value, otherwise it will clear all the refinement\n   * values for the faceted attribute.\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} [value] value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeFacetRefinement: function removeFacetRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (!RefinementList.isRefined(this.facetsRefinements, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.removeRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a negative refinement on a facet\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} value value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeExcludeRefinement: function removeExcludeRefinement(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n    if (!RefinementList.isRefined(this.facetsExcludes, facet, value))\n      return this;\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.removeRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a refinement on a disjunctive facet\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {string} value value used to filter\n   * @return {SearchParameters} new instance\n   */\n  removeDisjunctiveFacetRefinement: function removeDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n    if (\n      !RefinementList.isRefined(this.disjunctiveFacetsRefinements, facet, value)\n    )\n      return this;\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.removeRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Remove a tag from the list of tag refinements\n   * @method\n   * @param {string} tag the tag to remove\n   * @return {SearchParameters} new instance\n   */\n  removeTagRefinement: function removeTagRefinement(tag) {\n    if (!this.isTagRefined(tag)) return this;\n\n    var modification = {\n      tagRefinements: this.tagRefinements.filter(function (t) {\n        return t !== tag;\n      }),\n    };\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Generic toggle refinement method to use with facet, disjunctive facets\n   * and hierarchical facets\n   * @param  {string} facet the facet to refine\n   * @param  {string} value the associated value\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if the facet is not declared in the settings of the helper\n   * @deprecated since version 2.19.0, see {@link SearchParameters#toggleFacetRefinement}\n   */\n  toggleRefinement: function toggleRefinement(facet, value) {\n    return this.toggleFacetRefinement(facet, value);\n  },\n  /**\n   * Generic toggle refinement method to use with facet, disjunctive facets\n   * and hierarchical facets\n   * @param  {string} facet the facet to refine\n   * @param  {string} value the associated value\n   * @return {SearchParameters} new instance\n   * @throws will throw an error if the facet is not declared in the settings of the helper\n   */\n  toggleFacetRefinement: function toggleFacetRefinement(facet, value) {\n    if (this.isHierarchicalFacet(facet)) {\n      return this.toggleHierarchicalFacetRefinement(facet, value);\n    } else if (this.isConjunctiveFacet(facet)) {\n      return this.toggleConjunctiveFacetRefinement(facet, value);\n    } else if (this.isDisjunctiveFacet(facet)) {\n      return this.toggleDisjunctiveFacetRefinement(facet, value);\n    }\n\n    throw new Error(\n      'Cannot refine the undeclared facet ' +\n        facet +\n        '; it should be added to the helper options facets, disjunctiveFacets or hierarchicalFacets'\n    );\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleConjunctiveFacetRefinement: function toggleConjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      facetsRefinements: RefinementList.toggleRefinement(\n        this.facetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleExcludeFacetRefinement: function toggleExcludeFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isConjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the facets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      facetsExcludes: RefinementList.toggleRefinement(\n        this.facetsExcludes,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleDisjunctiveFacetRefinement: function toggleDisjunctiveFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the disjunctiveFacets attribute of the helper configuration'\n      );\n    }\n\n    return this.setQueryParameters({\n      disjunctiveFacetsRefinements: RefinementList.toggleRefinement(\n        this.disjunctiveFacetsRefinements,\n        facet,\n        value\n      ),\n    });\n  },\n  /**\n   * Switch the refinement applied over a facet/value\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {SearchParameters} new instance\n   */\n  toggleHierarchicalFacetRefinement: function toggleHierarchicalFacetRefinement(\n    facet,\n    value\n  ) {\n    if (!this.isHierarchicalFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the hierarchicalFacets attribute of the helper configuration'\n      );\n    }\n\n    var separator = this._getHierarchicalFacetSeparator(\n      this.getHierarchicalFacetByName(facet)\n    );\n\n    var mod = {};\n\n    var upOneOrMultipleLevel =\n      this.hierarchicalFacetsRefinements[facet] !== undefined &&\n      this.hierarchicalFacetsRefinements[facet].length > 0 &&\n      // remove current refinement:\n      // refinement was 'beer > IPA', call is toggleRefine('beer > IPA'), refinement should be `beer`\n      (this.hierarchicalFacetsRefinements[facet][0] === value ||\n        // remove a parent refinement of the current refinement:\n        //  - refinement was 'beer > IPA > Flying dog'\n        //  - call is toggleRefine('beer > IPA')\n        //  - refinement should be `beer`\n        this.hierarchicalFacetsRefinements[facet][0].indexOf(\n          value + separator\n        ) === 0);\n\n    if (upOneOrMultipleLevel) {\n      if (value.indexOf(separator) === -1) {\n        // go back to root level\n        mod[facet] = [];\n      } else {\n        mod[facet] = [value.slice(0, value.lastIndexOf(separator))];\n      }\n    } else {\n      mod[facet] = [value];\n    }\n\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n\n  /**\n   * Adds a refinement on a hierarchical facet.\n   * @param {string} facet the facet name\n   * @param {string} path the hierarchical facet path\n   * @return {SearchParameter} the new state\n   * @throws Error if the facet is not defined or if the facet is refined\n   */\n  addHierarchicalFacetRefinement: function (facet, path) {\n    if (this.isHierarchicalFacetRefined(facet)) {\n      throw new Error(facet + ' is already refined.');\n    }\n    if (!this.isHierarchicalFacet(facet)) {\n      throw new Error(\n        facet +\n          ' is not defined in the hierarchicalFacets attribute of the helper configuration.'\n      );\n    }\n    var mod = {};\n    mod[facet] = [path];\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n\n  /**\n   * Removes the refinement set on a hierarchical facet.\n   * @param {string} facet the facet name\n   * @return {SearchParameter} the new state\n   * @throws Error if the facet is not defined or if the facet is not refined\n   */\n  removeHierarchicalFacetRefinement: function (facet) {\n    if (!this.isHierarchicalFacetRefined(facet)) {\n      return this;\n    }\n    var mod = {};\n    mod[facet] = [];\n    return this.setQueryParameters({\n      hierarchicalFacetsRefinements: defaultsPure(\n        {},\n        mod,\n        this.hierarchicalFacetsRefinements\n      ),\n    });\n  },\n  /**\n   * Switch the tag refinement\n   * @method\n   * @param {string} tag the tag to remove or add\n   * @return {SearchParameters} new instance\n   */\n  toggleTagRefinement: function toggleTagRefinement(tag) {\n    if (this.isTagRefined(tag)) {\n      return this.removeTagRefinement(tag);\n    }\n\n    return this.addTagRefinement(tag);\n  },\n  /**\n   * Test if the facet name is from one of the disjunctive facets\n   * @method\n   * @param {string} facet facet name to test\n   * @return {boolean} true if facet is a disjunctive facet\n   */\n  isDisjunctiveFacet: function (facet) {\n    return this.disjunctiveFacets.indexOf(facet) > -1;\n  },\n  /**\n   * Test if the facet name is from one of the hierarchical facets\n   * @method\n   * @param {string} facetName facet name to test\n   * @return {boolean} true if facetName is a hierarchical facet\n   */\n  isHierarchicalFacet: function (facetName) {\n    return this.getHierarchicalFacetByName(facetName) !== undefined;\n  },\n  /**\n   * Test if the facet name is from one of the conjunctive/normal facets\n   * @method\n   * @param {string} facet facet name to test\n   * @return {boolean} true if facet is a conjunctive facet\n   */\n  isConjunctiveFacet: function (facet) {\n    return this.facets.indexOf(facet) > -1;\n  },\n  /**\n   * Returns true if the facet is refined, either for a specific value or in\n   * general.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value, optional value. If passed will test that this value\n   * is filtering the given facet.\n   * @return {boolean} returns true if refined\n   */\n  isFacetRefined: function isFacetRefined(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(this.facetsRefinements, facet, value);\n  },\n  /**\n   * Returns true if the facet contains exclusions or if a specific value is\n   * excluded.\n   *\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} [value] optional value. If passed will test that this value\n   * is filtering the given facet.\n   * @return {boolean} returns true if refined\n   */\n  isExcludeRefined: function isExcludeRefined(facet, value) {\n    if (!this.isConjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(this.facetsExcludes, facet, value);\n  },\n  /**\n   * Returns true if the facet contains a refinement, or if a value passed is a\n   * refinement for the facet.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value optional, will test if the value is used for refinement\n   * if there is one, otherwise will test if the facet contains any refinement\n   * @return {boolean} true if the facet is refined\n   */\n  isDisjunctiveFacetRefined: function isDisjunctiveFacetRefined(facet, value) {\n    if (!this.isDisjunctiveFacet(facet)) {\n      return false;\n    }\n    return RefinementList.isRefined(\n      this.disjunctiveFacetsRefinements,\n      facet,\n      value\n    );\n  },\n  /**\n   * Returns true if the facet contains a refinement, or if a value passed is a\n   * refinement for the facet.\n   * @method\n   * @param {string} facet name of the attribute for used for faceting\n   * @param {string} value optional, will test if the value is used for refinement\n   * if there is one, otherwise will test if the facet contains any refinement\n   * @return {boolean} true if the facet is refined\n   */\n  isHierarchicalFacetRefined: function isHierarchicalFacetRefined(\n    facet,\n    value\n  ) {\n    if (!this.isHierarchicalFacet(facet)) {\n      return false;\n    }\n\n    var refinements = this.getHierarchicalRefinement(facet);\n\n    if (!value) {\n      return refinements.length > 0;\n    }\n\n    return refinements.indexOf(value) !== -1;\n  },\n  /**\n   * Test if the triple (attribute, operator, value) is already refined.\n   * If only the attribute and the operator are provided, it tests if the\n   * contains any refinement value.\n   * @method\n   * @param {string} attribute attribute for which the refinement is applied\n   * @param {string} [operator] operator of the refinement\n   * @param {string} [value] value of the refinement\n   * @return {boolean} true if it is refined\n   */\n  isNumericRefined: function isNumericRefined(attribute, operator, value) {\n    if (value === undefined && operator === undefined) {\n      return Boolean(this.numericRefinements[attribute]);\n    }\n\n    var isOperatorDefined =\n      this.numericRefinements[attribute] &&\n      this.numericRefinements[attribute][operator] !== undefined;\n\n    if (value === undefined || !isOperatorDefined) {\n      return isOperatorDefined;\n    }\n\n    var parsedValue = valToNumber(value);\n    var isAttributeValueDefined =\n      findArray(this.numericRefinements[attribute][operator], parsedValue) !==\n      undefined;\n\n    return isOperatorDefined && isAttributeValueDefined;\n  },\n  /**\n   * Returns true if the tag refined, false otherwise\n   * @method\n   * @param {string} tag the tag to check\n   * @return {boolean} true if tag is refined\n   */\n  isTagRefined: function isTagRefined(tag) {\n    return this.tagRefinements.indexOf(tag) !== -1;\n  },\n  /**\n   * Returns the list of all disjunctive facets refined\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {string[]} returns the list of refinements\n   */\n  getRefinedDisjunctiveFacets: function getRefinedDisjunctiveFacets() {\n    // eslint-disable-next-line consistent-this\n    var self = this;\n\n    // attributes used for numeric filter can also be disjunctive\n    var disjunctiveNumericRefinedFacets = intersection(\n      Object.keys(this.numericRefinements).filter(function (facet) {\n        return Object.keys(self.numericRefinements[facet]).length > 0;\n      }),\n      this.disjunctiveFacets\n    );\n\n    return Object.keys(this.disjunctiveFacetsRefinements)\n      .filter(function (facet) {\n        return self.disjunctiveFacetsRefinements[facet].length > 0;\n      })\n      .concat(disjunctiveNumericRefinedFacets)\n      .concat(this.getRefinedHierarchicalFacets())\n      .sort();\n  },\n  /**\n   * Returns the list of all disjunctive facets refined\n   * @method\n   * @param {string} facet name of the attribute used for faceting\n   * @param {value} value value used for filtering\n   * @return {string[]} returns the list of refinements\n   */\n  getRefinedHierarchicalFacets: function getRefinedHierarchicalFacets() {\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    return intersection(\n      // enforce the order between the two arrays,\n      // so that refinement name index === hierarchical facet index\n      this.hierarchicalFacets.map(function (facet) {\n        return facet.name;\n      }),\n      Object.keys(this.hierarchicalFacetsRefinements).filter(function (facet) {\n        return self.hierarchicalFacetsRefinements[facet].length > 0;\n      })\n    ).sort();\n  },\n  /**\n   * Returned the list of all disjunctive facets not refined\n   * @method\n   * @return {string[]} returns the list of facets that are not refined\n   */\n  getUnrefinedDisjunctiveFacets: function () {\n    var refinedFacets = this.getRefinedDisjunctiveFacets();\n\n    return this.disjunctiveFacets.filter(function (f) {\n      return refinedFacets.indexOf(f) === -1;\n    });\n  },\n\n  managedParameters: [\n    'index',\n\n    'facets',\n    'disjunctiveFacets',\n    'facetsRefinements',\n    'hierarchicalFacets',\n    'facetsExcludes',\n\n    'disjunctiveFacetsRefinements',\n    'numericRefinements',\n    'tagRefinements',\n    'hierarchicalFacetsRefinements',\n  ],\n\n  getQueryParams: function getQueryParams() {\n    var managedParameters = this.managedParameters;\n\n    var queryParams = {};\n\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    Object.keys(this).forEach(function (paramName) {\n      var paramValue = self[paramName];\n      if (\n        managedParameters.indexOf(paramName) === -1 &&\n        paramValue !== undefined\n      ) {\n        queryParams[paramName] = paramValue;\n      }\n    });\n\n    return queryParams;\n  },\n  /**\n   * Let the user set a specific value for a given parameter. Will return the\n   * same instance if the parameter is invalid or if the value is the same as the\n   * previous one.\n   * @method\n   * @param {string} parameter the parameter name\n   * @param {any} value the value to be set, must be compliant with the definition\n   * of the attribute on the object\n   * @return {SearchParameters} the updated state\n   */\n  setQueryParameter: function setParameter(parameter, value) {\n    if (this[parameter] === value) return this;\n\n    var modification = {};\n\n    modification[parameter] = value;\n\n    return this.setQueryParameters(modification);\n  },\n  /**\n   * Let the user set any of the parameters with a plain object.\n   * @method\n   * @param {object} params all the keys and the values to be updated\n   * @return {SearchParameters} a new updated instance\n   */\n  setQueryParameters: function setQueryParameters(params) {\n    if (!params) return this;\n\n    var error = SearchParameters.validate(this, params);\n\n    if (error) {\n      throw error;\n    }\n\n    // eslint-disable-next-line consistent-this\n    var self = this;\n    var nextWithNumbers = SearchParameters._parseNumbers(params);\n    var previousPlainObject = Object.keys(this).reduce(function (acc, key) {\n      acc[key] = self[key];\n      return acc;\n    }, {});\n\n    var nextPlainObject = Object.keys(nextWithNumbers).reduce(function (\n      previous,\n      key\n    ) {\n      var isPreviousValueDefined = previous[key] !== undefined;\n      var isNextValueDefined = nextWithNumbers[key] !== undefined;\n\n      if (isPreviousValueDefined && !isNextValueDefined) {\n        return omit(previous, [key]);\n      }\n\n      if (isNextValueDefined) {\n        previous[key] = nextWithNumbers[key];\n      }\n\n      return previous;\n    },\n    previousPlainObject);\n\n    return new this.constructor(nextPlainObject);\n  },\n\n  /**\n   * Returns a new instance with the page reset. Two scenarios possible:\n   * the page is omitted -> return the given instance\n   * the page is set -> return a new instance with a page of 0\n   * @return {SearchParameters} a new updated instance\n   */\n  resetPage: function () {\n    if (this.page === undefined) {\n      return this;\n    }\n\n    return this.setPage(0);\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet separator or the default one (`>`)\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.separator or `>` as default\n   */\n  _getHierarchicalFacetSortBy: function (hierarchicalFacet) {\n    return hierarchicalFacet.sortBy || ['isRefined:desc', 'name:asc'];\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet separator or the default one (`>`)\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.separator or `>` as default\n   */\n  _getHierarchicalFacetSeparator: function (hierarchicalFacet) {\n    return hierarchicalFacet.separator || ' > ';\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet prefix path or null\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.rootPath or null as default\n   */\n  _getHierarchicalRootPath: function (hierarchicalFacet) {\n    return hierarchicalFacet.rootPath || null;\n  },\n\n  /**\n   * Helper function to check if we show the parent level of the hierarchicalFacet\n   * @private\n   * @param  {object} hierarchicalFacet the hierarchicalFacet object\n   * @return {string} returns the hierarchicalFacet.showParentLevel or true as default\n   */\n  _getHierarchicalShowParentLevel: function (hierarchicalFacet) {\n    if (typeof hierarchicalFacet.showParentLevel === 'boolean') {\n      return hierarchicalFacet.showParentLevel;\n    }\n    return true;\n  },\n\n  /**\n   * Helper function to get the hierarchicalFacet by it's name\n   * @param  {string} hierarchicalFacetName the hierarchicalFacet name\n   * @return {object} a hierarchicalFacet\n   */\n  getHierarchicalFacetByName: function (hierarchicalFacetName) {\n    return find(this.hierarchicalFacets, function (f) {\n      return f.name === hierarchicalFacetName;\n    });\n  },\n\n  /**\n   * Get the current breadcrumb for a hierarchical facet, as an array\n   * @param  {string} facetName Hierarchical facet name\n   * @return {array.<string>} the path as an array of string\n   */\n  getHierarchicalFacetBreadcrumb: function (facetName) {\n    if (!this.isHierarchicalFacet(facetName)) {\n      return [];\n    }\n\n    var refinement = this.getHierarchicalRefinement(facetName)[0];\n    if (!refinement) return [];\n\n    var separator = this._getHierarchicalFacetSeparator(\n      this.getHierarchicalFacetByName(facetName)\n    );\n    var path = refinement.split(separator);\n    return path.map(function (part) {\n      return part.trim();\n    });\n  },\n\n  toString: function () {\n    return JSON.stringify(this, null, 2);\n  },\n};\n\n/**\n * Callback used for clearRefinement method\n * @callback SearchParameters.clearCallback\n * @param {OperatorList|FacetList} value the value of the filter\n * @param {string} key the current attribute name\n * @param {string} type `numeric`, `disjunctiveFacet`, `conjunctiveFacet`, `hierarchicalFacet` or `exclude`\n * depending on the type of facet\n * @return {boolean} `true` if the element should be removed. `false` otherwise.\n */\nmodule.exports = SearchParameters;\n","'use strict';\n\nmodule.exports = generateTrees;\n\nvar fv = require('../functions/escapeFacetValue');\nvar find = require('../functions/find');\nvar prepareHierarchicalFacetSortBy = require('../functions/formatSort');\nvar orderBy = require('../functions/orderBy');\nvar escapeFacetValue = fv.escapeFacetValue;\nvar unescapeFacetValue = fv.unescapeFacetValue;\n\nfunction generateTrees(state) {\n  return function generate(hierarchicalFacetResult, hierarchicalFacetIndex) {\n    var hierarchicalFacet = state.hierarchicalFacets[hierarchicalFacetIndex];\n    var hierarchicalFacetRefinement =\n      (state.hierarchicalFacetsRefinements[hierarchicalFacet.name] &&\n        state.hierarchicalFacetsRefinements[hierarchicalFacet.name][0]) ||\n      '';\n    var hierarchicalSeparator =\n      state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    var hierarchicalRootPath =\n      state._getHierarchicalRootPath(hierarchicalFacet);\n    var hierarchicalShowParentLevel =\n      state._getHierarchicalShowParentLevel(hierarchicalFacet);\n    var sortBy = prepareHierarchicalFacetSortBy(\n      state._getHierarchicalFacetSortBy(hierarchicalFacet)\n    );\n\n    var rootExhaustive = hierarchicalFacetResult.every(function (facetResult) {\n      return facetResult.exhaustive;\n    });\n\n    var generateTreeFn = generateHierarchicalTree(\n      sortBy,\n      hierarchicalSeparator,\n      hierarchicalRootPath,\n      hierarchicalShowParentLevel,\n      hierarchicalFacetRefinement\n    );\n\n    var results = hierarchicalFacetResult;\n\n    if (hierarchicalRootPath) {\n      results = hierarchicalFacetResult.slice(\n        hierarchicalRootPath.split(hierarchicalSeparator).length\n      );\n    }\n\n    return results.reduce(generateTreeFn, {\n      name: state.hierarchicalFacets[hierarchicalFacetIndex].name,\n      count: null, // root level, no count\n      isRefined: true, // root level, always refined\n      path: null, // root level, no path\n      escapedValue: null,\n      exhaustive: rootExhaustive,\n      data: null,\n    });\n  };\n}\n\nfunction generateHierarchicalTree(\n  sortBy,\n  hierarchicalSeparator,\n  hierarchicalRootPath,\n  hierarchicalShowParentLevel,\n  currentRefinement\n) {\n  return function generateTree(\n    hierarchicalTree,\n    hierarchicalFacetResult,\n    currentHierarchicalLevel\n  ) {\n    var parent = hierarchicalTree;\n\n    if (currentHierarchicalLevel > 0) {\n      var level = 0;\n\n      parent = hierarchicalTree;\n\n      while (level < currentHierarchicalLevel) {\n        /**\n         * @type {object[]]} hierarchical data\n         */\n        var data = parent && Array.isArray(parent.data) ? parent.data : [];\n        parent = find(data, function (subtree) {\n          return subtree.isRefined;\n        });\n        level++;\n      }\n    }\n\n    // we found a refined parent, let's add current level data under it\n    if (parent) {\n      // filter values in case an object has multiple categories:\n      //   {\n      //     categories: {\n      //       level0: ['beers', 'bires'],\n      //       level1: ['beers > IPA', 'bires > Belges']\n      //     }\n      //   }\n      //\n      // If parent refinement is `beers`, then we do not want to have `bires > Belges`\n      // showing up\n\n      var picked = Object.keys(hierarchicalFacetResult.data)\n        .map(function (facetValue) {\n          return [facetValue, hierarchicalFacetResult.data[facetValue]];\n        })\n        .filter(function (tuple) {\n          var facetValue = tuple[0];\n          return onlyMatchingTree(\n            facetValue,\n            parent.path || hierarchicalRootPath,\n            currentRefinement,\n            hierarchicalSeparator,\n            hierarchicalRootPath,\n            hierarchicalShowParentLevel\n          );\n        });\n\n      parent.data = orderBy(\n        picked.map(function (tuple) {\n          var facetValue = tuple[0];\n          var facetCount = tuple[1];\n\n          return format(\n            facetCount,\n            facetValue,\n            hierarchicalSeparator,\n            unescapeFacetValue(currentRefinement),\n            hierarchicalFacetResult.exhaustive\n          );\n        }),\n        sortBy[0],\n        sortBy[1]\n      );\n    }\n\n    return hierarchicalTree;\n  };\n}\n\n// eslint-disable-next-line max-params\nfunction onlyMatchingTree(\n  facetValue,\n  parentPath,\n  currentRefinement,\n  hierarchicalSeparator,\n  hierarchicalRootPath,\n  hierarchicalShowParentLevel\n) {\n  // we want the facetValue is a child of hierarchicalRootPath\n  if (\n    hierarchicalRootPath &&\n    (facetValue.indexOf(hierarchicalRootPath) !== 0 ||\n      hierarchicalRootPath === facetValue)\n  ) {\n    return false;\n  }\n\n  // we always want root levels (only when there is no prefix path)\n  return (\n    (!hierarchicalRootPath &&\n      facetValue.indexOf(hierarchicalSeparator) === -1) ||\n    // if there is a rootPath, being root level mean 1 level under rootPath\n    (hierarchicalRootPath &&\n      facetValue.split(hierarchicalSeparator).length -\n        hierarchicalRootPath.split(hierarchicalSeparator).length ===\n        1) ||\n    // if current refinement is a root level and current facetValue is a root level,\n    // keep the facetValue\n    (facetValue.indexOf(hierarchicalSeparator) === -1 &&\n      currentRefinement.indexOf(hierarchicalSeparator) === -1) ||\n    // currentRefinement is a child of the facet value\n    currentRefinement.indexOf(facetValue) === 0 ||\n    // facetValue is a child of the current parent, add it\n    (facetValue.indexOf(parentPath + hierarchicalSeparator) === 0 &&\n      (hierarchicalShowParentLevel ||\n        facetValue.indexOf(currentRefinement) === 0))\n  );\n}\n\nfunction format(\n  facetCount,\n  facetValue,\n  hierarchicalSeparator,\n  currentRefinement,\n  exhaustive\n) {\n  var parts = facetValue.split(hierarchicalSeparator);\n  return {\n    name: parts[parts.length - 1].trim(),\n    path: facetValue,\n    escapedValue: escapeFacetValue(facetValue),\n    count: facetCount,\n    isRefined:\n      currentRefinement === facetValue ||\n      currentRefinement.indexOf(facetValue + hierarchicalSeparator) === 0,\n    exhaustive: exhaustive,\n    data: null,\n  };\n}\n","'use strict';\n\nvar compact = require('../functions/compact');\nvar defaultsPure = require('../functions/defaultsPure');\nvar fv = require('../functions/escapeFacetValue');\nvar find = require('../functions/find');\nvar findIndex = require('../functions/findIndex');\nvar formatSort = require('../functions/formatSort');\nvar merge = require('../functions/merge');\nvar orderBy = require('../functions/orderBy');\nvar escapeFacetValue = fv.escapeFacetValue;\nvar unescapeFacetValue = fv.unescapeFacetValue;\n\nvar generateHierarchicalTree = require('./generate-hierarchical-tree');\n\n/**\n * @typedef SearchResults.Facet\n * @type {object}\n * @property {string} name name of the attribute in the record\n * @property {object} data the faceting data: value, number of entries\n * @property {object} stats undefined unless facet_stats is retrieved from algolia\n */\n\n/**\n * @typedef SearchResults.HierarchicalFacet\n * @type {object}\n * @property {string} name name of the current value given the hierarchical level, trimmed.\n * If root node, you get the facet name\n * @property {number} count number of objects matching this hierarchical value\n * @property {string} path the current hierarchical value full path\n * @property {boolean} isRefined `true` if the current value was refined, `false` otherwise\n * @property {HierarchicalFacet[]} data sub values for the current level\n */\n\n/**\n * @typedef SearchResults.FacetValue\n * @type {object}\n * @property {string} name the facet value itself\n * @property {number} count times this facet appears in the results\n * @property {boolean} isRefined is the facet currently selected\n * @property {boolean} isExcluded is the facet currently excluded (only for conjunctive facets)\n */\n\n/**\n * @typedef Refinement\n * @type {object}\n * @property {string} type the type of filter used:\n * `numeric`, `facet`, `exclude`, `disjunctive`, `hierarchical`\n * @property {string} attributeName name of the attribute used for filtering\n * @property {string} name the value of the filter\n * @property {number} numericValue the value as a number. Only for numeric filters.\n * @property {string} operator the operator used. Only for numeric filters.\n * @property {number} count the number of computed hits for this filter. Only on facets.\n * @property {boolean} exhaustive if the count is exhaustive\n */\n\n/**\n * Turn an array of attributes in an object of attributes with their position in the array as value\n * @param {string[]} attributes the list of attributes in the record\n * @return {object} the list of attributes indexed by attribute name\n */\nfunction getIndices(attributes) {\n  var indices = {};\n\n  attributes.forEach(function (val, idx) {\n    indices[val] = idx;\n  });\n\n  return indices;\n}\n\nfunction assignFacetStats(dest, facetStats, key) {\n  if (facetStats && facetStats[key]) {\n    dest.stats = facetStats[key];\n  }\n}\n\n/**\n * @typedef {Object} HierarchicalFacet\n * @property {string} name\n * @property {string[]} attributes\n */\n\n/**\n * @param {HierarchicalFacet[]} hierarchicalFacets All hierarchical facets\n * @param {string} hierarchicalAttributeName The name of the hierarchical attribute\n * @return {HierarchicalFacet} The hierarchical facet matching the attribute name\n */\nfunction findMatchingHierarchicalFacetFromAttributeName(\n  hierarchicalFacets,\n  hierarchicalAttributeName\n) {\n  return find(\n    hierarchicalFacets,\n    function facetKeyMatchesAttribute(hierarchicalFacet) {\n      var facetNames = hierarchicalFacet.attributes || [];\n      return facetNames.indexOf(hierarchicalAttributeName) > -1;\n    }\n  );\n}\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * Constructor for SearchResults\n * @class\n * @classdesc SearchResults contains the results of a query to Algolia using the\n * {@link AlgoliaSearchHelper}.\n * @param {SearchParameters} state state that led to the response\n * @param {array.<object>} results the results from algolia client\n * @example <caption>SearchResults of the first query in\n * <a href=\"http://demos.algolia.com/instant-search-demo\">the instant search demo</a></caption>\n{\n   \"hitsPerPage\": 10,\n   \"processingTimeMS\": 2,\n   \"facets\": [\n      {\n         \"name\": \"type\",\n         \"data\": {\n            \"HardGood\": 6627,\n            \"BlackTie\": 550,\n            \"Music\": 665,\n            \"Software\": 131,\n            \"Game\": 456,\n            \"Movie\": 1571\n         },\n         \"exhaustive\": false\n      },\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"Free shipping\": 5507\n         },\n         \"name\": \"shipping\"\n      }\n  ],\n   \"hits\": [\n      {\n         \"thumbnailImage\": \"http://img.bbystatic.com/BestBuy_US/images/products/1688/1688832_54x108_s.gif\",\n         \"_highlightResult\": {\n            \"shortDescription\": {\n               \"matchLevel\": \"none\",\n               \"value\": \"Safeguard your PC, Mac, Android and iOS devices with comprehensive Internet protection\",\n               \"matchedWords\": []\n            },\n            \"category\": {\n               \"matchLevel\": \"none\",\n               \"value\": \"Computer Security Software\",\n               \"matchedWords\": []\n            },\n            \"manufacturer\": {\n               \"matchedWords\": [],\n               \"value\": \"Webroot\",\n               \"matchLevel\": \"none\"\n            },\n            \"name\": {\n               \"value\": \"Webroot SecureAnywhere Internet Security (3-Device) (1-Year Subscription) - Mac/Windows\",\n               \"matchedWords\": [],\n               \"matchLevel\": \"none\"\n            }\n         },\n         \"image\": \"http://img.bbystatic.com/BestBuy_US/images/products/1688/1688832_105x210_sc.jpg\",\n         \"shipping\": \"Free shipping\",\n         \"bestSellingRank\": 4,\n         \"shortDescription\": \"Safeguard your PC, Mac, Android and iOS devices with comprehensive Internet protection\",\n         \"url\": \"http://www.bestbuy.com/site/webroot-secureanywhere-internet-security-3-devid=1219060687969&skuId=1688832&cmp=RMX&ky=2d3GfEmNIzjA0vkzveHdZEBgpPCyMnLTJ\",\n         \"name\": \"Webroot SecureAnywhere Internet Security (3-Device) (1-Year Subscription) - Mac/Windows\",\n         \"category\": \"Computer Security Software\",\n         \"salePrice_range\": \"1 - 50\",\n         \"objectID\": \"1688832\",\n         \"type\": \"Software\",\n         \"customerReviewCount\": 5980,\n         \"salePrice\": 49.99,\n         \"manufacturer\": \"Webroot\"\n      },\n      ....\n  ],\n   \"nbHits\": 10000,\n   \"disjunctiveFacets\": [\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"5\": 183,\n            \"12\": 112,\n            \"7\": 149,\n            ...\n         },\n         \"name\": \"customerReviewCount\",\n         \"stats\": {\n            \"max\": 7461,\n            \"avg\": 157.939,\n            \"min\": 1\n         }\n      },\n      {\n         \"data\": {\n            \"Printer Ink\": 142,\n            \"Wireless Speakers\": 60,\n            \"Point & Shoot Cameras\": 48,\n            ...\n         },\n         \"name\": \"category\",\n         \"exhaustive\": false\n      },\n      {\n         \"exhaustive\": false,\n         \"data\": {\n            \"> 5000\": 2,\n            \"1 - 50\": 6524,\n            \"501 - 2000\": 566,\n            \"201 - 500\": 1501,\n            \"101 - 200\": 1360,\n            \"2001 - 5000\": 47\n         },\n         \"name\": \"salePrice_range\"\n      },\n      {\n         \"data\": {\n            \"Dynex\": 202,\n            \"Insignia\": 230,\n            \"PNY\": 72,\n            ...\n         },\n         \"name\": \"manufacturer\",\n         \"exhaustive\": false\n      }\n  ],\n   \"query\": \"\",\n   \"nbPages\": 100,\n   \"page\": 0,\n   \"index\": \"bestbuy\"\n}\n **/\nfunction SearchResults(state, results, options) {\n  var mainSubResponse = results[0];\n\n  this._rawResults = results;\n\n  // eslint-disable-next-line consistent-this\n  var self = this;\n\n  // https://www.algolia.com/doc/api-reference/api-methods/search/#response\n  Object.keys(mainSubResponse).forEach(function (key) {\n    self[key] = mainSubResponse[key];\n  });\n\n  // Make every key of the result options reachable from the instance\n  Object.keys(options || {}).forEach(function (key) {\n    self[key] = options[key];\n  });\n\n  /**\n   * query used to generate the results\n   * @name query\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * The query as parsed by the engine given all the rules.\n   * @name parsedQuery\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * all the records that match the search parameters. Each record is\n   * augmented with a new attribute `_highlightResult`\n   * which is an object keyed by attribute and with the following properties:\n   * - `value` : the value of the facet highlighted (html)\n   * - `matchLevel`: `full`, `partial` or `none`, depending on how the query terms match\n   * @name hits\n   * @member {object[]}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * index where the results come from\n   * @name index\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * number of hits per page requested\n   * @name hitsPerPage\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * total number of hits of this query on the index\n   * @name nbHits\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * total number of pages with respect to the number of hits per page and the total number of hits\n   * @name nbPages\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * current page\n   * @name page\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * The position if the position was guessed by IP.\n   * @name aroundLatLng\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"48.8637,2.3615\",\n   */\n  /**\n   * The radius computed by Algolia.\n   * @name automaticRadius\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"126792922\",\n   */\n  /**\n   * String identifying the server used to serve this request.\n   *\n   * getRankingInfo needs to be set to `true` for this to be returned\n   *\n   * @name serverUsed\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   * @example \"c7-use-2.algolia.net\",\n   */\n  /**\n   * Boolean that indicates if the computation of the counts did time out.\n   * @deprecated\n   * @name timeoutCounts\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * Boolean that indicates if the computation of the hits did time out.\n   * @deprecated\n   * @name timeoutHits\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * True if the counts of the facets is exhaustive\n   * @name exhaustiveFacetsCount\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * True if the number of hits is exhaustive\n   * @name exhaustiveNbHits\n   * @member {boolean}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * Contains the userData if they are set by a [query rule](https://www.algolia.com/doc/guides/query-rules/query-rules-overview/).\n   * @name userData\n   * @member {object[]}\n   * @memberof SearchResults\n   * @instance\n   */\n  /**\n   * queryID is the unique identifier of the query used to generate the current search results.\n   * This value is only available if the `clickAnalytics` search parameter is set to `true`.\n   * @name queryID\n   * @member {string}\n   * @memberof SearchResults\n   * @instance\n   */\n\n  /**\n   * sum of the processing time of all the queries\n   * @name processingTimeMS\n   * @member {number}\n   * @memberof SearchResults\n   * @instance\n   */\n  this.processingTimeMS = results.reduce(function (sum, result) {\n    return result.processingTimeMS === undefined\n      ? sum\n      : sum + result.processingTimeMS;\n  }, 0);\n\n  /**\n   * disjunctive facets results\n   * @member {SearchResults.Facet[]}\n   */\n  this.disjunctiveFacets = [];\n  /**\n   * disjunctive facets results\n   * @member {SearchResults.HierarchicalFacet[]}\n   */\n  this.hierarchicalFacets = state.hierarchicalFacets.map(\n    function initFutureTree() {\n      return [];\n    }\n  );\n  /**\n   * other facets results\n   * @member {SearchResults.Facet[]}\n   */\n  this.facets = [];\n\n  var disjunctiveFacets = state.getRefinedDisjunctiveFacets();\n\n  var facetsIndices = getIndices(state.facets);\n  var disjunctiveFacetsIndices = getIndices(state.disjunctiveFacets);\n  var nextDisjunctiveResult = 1;\n\n  // Since we send request only for disjunctive facets that have been refined,\n  // we get the facets information from the first, general, response.\n\n  var mainFacets = mainSubResponse.facets || {};\n\n  Object.keys(mainFacets).forEach(function (facetKey) {\n    var facetValueObject = mainFacets[facetKey];\n\n    var hierarchicalFacet = findMatchingHierarchicalFacetFromAttributeName(\n      state.hierarchicalFacets,\n      facetKey\n    );\n\n    if (hierarchicalFacet) {\n      // Place the hierarchicalFacet data at the correct index depending on\n      // the attributes order that was defined at the helper initialization\n      var facetIndex = hierarchicalFacet.attributes.indexOf(facetKey);\n      var idxAttributeName = findIndex(state.hierarchicalFacets, function (f) {\n        return f.name === hierarchicalFacet.name;\n      });\n      self.hierarchicalFacets[idxAttributeName][facetIndex] = {\n        attribute: facetKey,\n        data: facetValueObject,\n        exhaustive: mainSubResponse.exhaustiveFacetsCount,\n      };\n    } else {\n      var isFacetDisjunctive = state.disjunctiveFacets.indexOf(facetKey) !== -1;\n      var isFacetConjunctive = state.facets.indexOf(facetKey) !== -1;\n      var position;\n\n      if (isFacetDisjunctive) {\n        position = disjunctiveFacetsIndices[facetKey];\n        self.disjunctiveFacets[position] = {\n          name: facetKey,\n          data: facetValueObject,\n          exhaustive: mainSubResponse.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.disjunctiveFacets[position],\n          mainSubResponse.facets_stats,\n          facetKey\n        );\n      }\n      if (isFacetConjunctive) {\n        position = facetsIndices[facetKey];\n        self.facets[position] = {\n          name: facetKey,\n          data: facetValueObject,\n          exhaustive: mainSubResponse.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.facets[position],\n          mainSubResponse.facets_stats,\n          facetKey\n        );\n      }\n    }\n  });\n\n  // Make sure we do not keep holes within the hierarchical facets\n  this.hierarchicalFacets = compact(this.hierarchicalFacets);\n\n  // aggregate the refined disjunctive facets\n  disjunctiveFacets.forEach(function (disjunctiveFacet) {\n    var result = results[nextDisjunctiveResult];\n    var facets = result && result.facets ? result.facets : {};\n    var hierarchicalFacet = state.getHierarchicalFacetByName(disjunctiveFacet);\n\n    // There should be only item in facets.\n    Object.keys(facets).forEach(function (dfacet) {\n      var facetResults = facets[dfacet];\n\n      var position;\n\n      if (hierarchicalFacet) {\n        position = findIndex(state.hierarchicalFacets, function (f) {\n          return f.name === hierarchicalFacet.name;\n        });\n        var attributeIndex = findIndex(\n          self.hierarchicalFacets[position],\n          function (f) {\n            return f.attribute === dfacet;\n          }\n        );\n\n        // previous refinements and no results so not able to find it\n        if (attributeIndex === -1) {\n          return;\n        }\n\n        self.hierarchicalFacets[position][attributeIndex].data = merge(\n          {},\n          self.hierarchicalFacets[position][attributeIndex].data,\n          facetResults\n        );\n      } else {\n        position = disjunctiveFacetsIndices[dfacet];\n\n        var dataFromMainRequest =\n          (mainSubResponse.facets && mainSubResponse.facets[dfacet]) || {};\n\n        self.disjunctiveFacets[position] = {\n          name: dfacet,\n          data: defaultsPure({}, facetResults, dataFromMainRequest),\n          exhaustive: result.exhaustiveFacetsCount,\n        };\n        assignFacetStats(\n          self.disjunctiveFacets[position],\n          result.facets_stats,\n          dfacet\n        );\n\n        if (state.disjunctiveFacetsRefinements[dfacet]) {\n          state.disjunctiveFacetsRefinements[dfacet].forEach(function (\n            refinementValue\n          ) {\n            // add the disjunctive refinements if it is no more retrieved\n            if (\n              !self.disjunctiveFacets[position].data[refinementValue] &&\n              state.disjunctiveFacetsRefinements[dfacet].indexOf(\n                unescapeFacetValue(refinementValue)\n              ) > -1\n            ) {\n              self.disjunctiveFacets[position].data[refinementValue] = 0;\n            }\n          });\n        }\n      }\n    });\n    nextDisjunctiveResult++;\n  });\n\n  // if we have some parent level values for hierarchical facets, merge them\n  state.getRefinedHierarchicalFacets().forEach(function (refinedFacet) {\n    var hierarchicalFacet = state.getHierarchicalFacetByName(refinedFacet);\n    var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n\n    var currentRefinement = state.getHierarchicalRefinement(refinedFacet);\n    // if we are already at a root refinement (or no refinement at all), there is no\n    // root level values request\n    if (\n      currentRefinement.length === 0 ||\n      currentRefinement[0].split(separator).length < 2\n    ) {\n      return;\n    }\n\n    results.slice(nextDisjunctiveResult).forEach(function (result) {\n      var facets = result && result.facets ? result.facets : {};\n\n      Object.keys(facets).forEach(function (dfacet) {\n        var facetResults = facets[dfacet];\n        var position = findIndex(state.hierarchicalFacets, function (f) {\n          return f.name === hierarchicalFacet.name;\n        });\n        var attributeIndex = findIndex(\n          self.hierarchicalFacets[position],\n          function (f) {\n            return f.attribute === dfacet;\n          }\n        );\n\n        // previous refinements and no results so not able to find it\n        if (attributeIndex === -1) {\n          return;\n        }\n\n        // when we always get root levels, if the hits refinement is `beers > IPA` (count: 5),\n        // then the disjunctive values will be `beers` (count: 100),\n        // but we do not want to display\n        //   | beers (100)\n        //     > IPA (5)\n        // We want\n        //   | beers (5)\n        //     > IPA (5)\n        var defaultData = {};\n\n        if (currentRefinement.length > 0) {\n          var root = currentRefinement[0].split(separator)[0];\n          defaultData[root] =\n            self.hierarchicalFacets[position][attributeIndex].data[root];\n        }\n\n        self.hierarchicalFacets[position][attributeIndex].data = defaultsPure(\n          defaultData,\n          facetResults,\n          self.hierarchicalFacets[position][attributeIndex].data\n        );\n      });\n\n      nextDisjunctiveResult++;\n    });\n  });\n\n  // add the excludes\n  Object.keys(state.facetsExcludes).forEach(function (facetName) {\n    var excludes = state.facetsExcludes[facetName];\n    var position = facetsIndices[facetName];\n\n    self.facets[position] = {\n      name: facetName,\n      data: mainFacets[facetName],\n      exhaustive: mainSubResponse.exhaustiveFacetsCount,\n    };\n    excludes.forEach(function (facetValue) {\n      self.facets[position] = self.facets[position] || { name: facetName };\n      self.facets[position].data = self.facets[position].data || {};\n      self.facets[position].data[facetValue] = 0;\n    });\n  });\n\n  /**\n   * @type {Array}\n   */\n  this.hierarchicalFacets = this.hierarchicalFacets.map(\n    generateHierarchicalTree(state)\n  );\n\n  /**\n   * @type {Array}\n   */\n  this.facets = compact(this.facets);\n  /**\n   * @type {Array}\n   */\n  this.disjunctiveFacets = compact(this.disjunctiveFacets);\n\n  this._state = state;\n}\n\n/**\n * Get a facet object with its name\n * @deprecated\n * @param {string} name name of the faceted attribute\n * @return {SearchResults.Facet} the facet object\n */\nSearchResults.prototype.getFacetByName = function (name) {\n  function predicate(facet) {\n    return facet.name === name;\n  }\n\n  return (\n    find(this.facets, predicate) ||\n    find(this.disjunctiveFacets, predicate) ||\n    find(this.hierarchicalFacets, predicate)\n  );\n};\n\n/**\n * Get the facet values of a specified attribute from a SearchResults object.\n * @private\n * @param {SearchResults} results the search results to search in\n * @param {string} attribute name of the faceted attribute to search for\n * @return {array|object} facet values. For the hierarchical facets it is an object.\n */\nfunction extractNormalizedFacetValues(results, attribute) {\n  function predicate(facet) {\n    return facet.name === attribute;\n  }\n\n  if (results._state.isConjunctiveFacet(attribute)) {\n    var facet = find(results.facets, predicate);\n    if (!facet) return [];\n\n    return Object.keys(facet.data).map(function (name) {\n      var value = escapeFacetValue(name);\n      return {\n        name: name,\n        escapedValue: value,\n        count: facet.data[name],\n        isRefined: results._state.isFacetRefined(attribute, value),\n        isExcluded: results._state.isExcludeRefined(attribute, name),\n      };\n    });\n  } else if (results._state.isDisjunctiveFacet(attribute)) {\n    var disjunctiveFacet = find(results.disjunctiveFacets, predicate);\n    if (!disjunctiveFacet) return [];\n\n    return Object.keys(disjunctiveFacet.data).map(function (name) {\n      var value = escapeFacetValue(name);\n      return {\n        name: name,\n        escapedValue: value,\n        count: disjunctiveFacet.data[name],\n        isRefined: results._state.isDisjunctiveFacetRefined(attribute, value),\n      };\n    });\n  } else if (results._state.isHierarchicalFacet(attribute)) {\n    var hierarchicalFacetValues = find(results.hierarchicalFacets, predicate);\n    if (!hierarchicalFacetValues) return hierarchicalFacetValues;\n\n    var hierarchicalFacet =\n      results._state.getHierarchicalFacetByName(attribute);\n    var separator =\n      results._state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    var currentRefinement = unescapeFacetValue(\n      results._state.getHierarchicalRefinement(attribute)[0] || ''\n    );\n\n    if (currentRefinement.indexOf(hierarchicalFacet.rootPath) === 0) {\n      currentRefinement = currentRefinement.replace(\n        hierarchicalFacet.rootPath + separator,\n        ''\n      );\n    }\n\n    var currentRefinementSplit = currentRefinement.split(separator);\n    currentRefinementSplit.unshift(attribute);\n\n    setIsRefined(hierarchicalFacetValues, currentRefinementSplit, 0);\n\n    return hierarchicalFacetValues;\n  }\n\n  return undefined;\n}\n\n/**\n * Set the isRefined of a hierarchical facet result based on the current state.\n * @param {SearchResults.HierarchicalFacet} item Hierarchical facet to fix\n * @param {string[]} currentRefinement array of parts of the current hierarchical refinement\n * @param {number} depth recursion depth in the currentRefinement\n * @return {undefined} function mutates the item\n */\nfunction setIsRefined(item, currentRefinement, depth) {\n  item.isRefined = item.name === currentRefinement[depth];\n  if (item.data) {\n    item.data.forEach(function (child) {\n      setIsRefined(child, currentRefinement, depth + 1);\n    });\n  }\n}\n\n/**\n * Sort nodes of a hierarchical or disjunctive facet results\n * @private\n * @param {function} sortFn sort function to apply\n * @param {HierarchicalFacet|Array} node node upon which we want to apply the sort\n * @param {string[]} names attribute names\n * @param {number} [level=0] current index in the names array\n * @return {HierarchicalFacet|Array} sorted node\n */\nfunction recSort(sortFn, node, names, level) {\n  level = level || 0;\n\n  if (Array.isArray(node)) {\n    return sortFn(node, names[level]);\n  }\n\n  if (!node.data || node.data.length === 0) {\n    return node;\n  }\n\n  var children = node.data.map(function (childNode) {\n    return recSort(sortFn, childNode, names, level + 1);\n  });\n  var sortedChildren = sortFn(children, names[level]);\n  var newNode = defaultsPure({ data: sortedChildren }, node);\n  return newNode;\n}\n\nSearchResults.DEFAULT_SORT = ['isRefined:desc', 'count:desc', 'name:asc'];\n\nfunction vanillaSortFn(order, data) {\n  return data.sort(order);\n}\n\n/**\n * @typedef FacetOrdering\n * @type {Object}\n * @property {string[]} [order]\n * @property {'count' | 'alpha' | 'hidden'} [sortRemainingBy]\n */\n\n/**\n * Sorts facet arrays via their facet ordering\n * @param {Array} facetValues the values\n * @param {FacetOrdering} facetOrdering the ordering\n * @returns {Array} the sorted facet values\n */\nfunction sortViaFacetOrdering(facetValues, facetOrdering) {\n  var orderedFacets = [];\n  var remainingFacets = [];\n\n  var order = facetOrdering.order || [];\n  /**\n   * an object with the keys being the values in order, the values their index:\n   * ['one', 'two'] -> { one: 0, two: 1 }\n   */\n  var reverseOrder = order.reduce(function (acc, name, i) {\n    acc[name] = i;\n    return acc;\n  }, {});\n\n  facetValues.forEach(function (item) {\n    // hierarchical facets get sorted using their raw name\n    var name = item.path || item.name;\n    if (reverseOrder[name] !== undefined) {\n      orderedFacets[reverseOrder[name]] = item;\n    } else {\n      remainingFacets.push(item);\n    }\n  });\n\n  orderedFacets = orderedFacets.filter(function (facet) {\n    return facet;\n  });\n\n  var sortRemainingBy = facetOrdering.sortRemainingBy;\n  var ordering;\n  if (sortRemainingBy === 'hidden') {\n    return orderedFacets;\n  } else if (sortRemainingBy === 'alpha') {\n    ordering = [\n      ['path', 'name'],\n      ['asc', 'asc'],\n    ];\n  } else {\n    ordering = [['count'], ['desc']];\n  }\n\n  return orderedFacets.concat(\n    orderBy(remainingFacets, ordering[0], ordering[1])\n  );\n}\n\n/**\n * @param {SearchResults} results the search results class\n * @param {string} attribute the attribute to retrieve ordering of\n * @returns {FacetOrdering | undefined} the facet ordering\n */\nfunction getFacetOrdering(results, attribute) {\n  return (\n    results.renderingContent &&\n    results.renderingContent.facetOrdering &&\n    results.renderingContent.facetOrdering.values &&\n    results.renderingContent.facetOrdering.values[attribute]\n  );\n}\n\n/**\n * Get a the list of values for a given facet attribute. Those values are sorted\n * refinement first, descending count (bigger value on top), and name ascending\n * (alphabetical order). The sort formula can overridden using either string based\n * predicates or a function.\n *\n * This method will return all the values returned by the Algolia engine plus all\n * the values already refined. This means that it can happen that the\n * `maxValuesPerFacet` [configuration](https://www.algolia.com/doc/rest-api/search#param-maxValuesPerFacet)\n * might not be respected if you have facet values that are already refined.\n * @param {string} attribute attribute name\n * @param {object} opts configuration options.\n * @param {boolean} [opts.facetOrdering]\n * Force the use of facetOrdering from the result if a sortBy is present. If\n * sortBy isn't present, facetOrdering will be used automatically.\n * @param {Array.<string> | function} opts.sortBy\n * When using strings, it consists of\n * the name of the [FacetValue](#SearchResults.FacetValue) or the\n * [HierarchicalFacet](#SearchResults.HierarchicalFacet) attributes with the\n * order (`asc` or `desc`). For example to order the value by count, the\n * argument would be `['count:asc']`.\n *\n * If only the attribute name is specified, the ordering defaults to the one\n * specified in the default value for this attribute.\n *\n * When not specified, the order is\n * ascending.  This parameter can also be a function which takes two facet\n * values and should return a number, 0 if equal, 1 if the first argument is\n * bigger or -1 otherwise.\n *\n * The default value for this attribute `['isRefined:desc', 'count:desc', 'name:asc']`\n * @return {FacetValue[]|HierarchicalFacet|undefined} depending on the type of facet of\n * the attribute requested (hierarchical, disjunctive or conjunctive)\n * @example\n * helper.on('result', function(event){\n *   //get values ordered only by name ascending using the string predicate\n *   event.results.getFacetValues('city', {sortBy: ['name:asc']});\n *   //get values  ordered only by count ascending using a function\n *   event.results.getFacetValues('city', {\n *     // this is equivalent to ['count:asc']\n *     sortBy: function(a, b) {\n *       if (a.count === b.count) return 0;\n *       if (a.count > b.count)   return 1;\n *       if (b.count > a.count)   return -1;\n *     }\n *   });\n * });\n */\nSearchResults.prototype.getFacetValues = function (attribute, opts) {\n  var facetValues = extractNormalizedFacetValues(this, attribute);\n  if (!facetValues) {\n    return undefined;\n  }\n\n  var options = defaultsPure({}, opts, {\n    sortBy: SearchResults.DEFAULT_SORT,\n    // if no sortBy is given, attempt to sort based on facetOrdering\n    // if it is given, we still allow to sort via facet ordering first\n    facetOrdering: !(opts && opts.sortBy),\n  });\n\n  // eslint-disable-next-line consistent-this\n  var results = this;\n  var attributes;\n  if (Array.isArray(facetValues)) {\n    attributes = [attribute];\n  } else {\n    var config = results._state.getHierarchicalFacetByName(facetValues.name);\n    attributes = config.attributes;\n  }\n\n  return recSort(\n    function (data, facetName) {\n      if (options.facetOrdering) {\n        var facetOrdering = getFacetOrdering(results, facetName);\n        if (facetOrdering) {\n          return sortViaFacetOrdering(data, facetOrdering);\n        }\n      }\n\n      if (Array.isArray(options.sortBy)) {\n        var order = formatSort(options.sortBy, SearchResults.DEFAULT_SORT);\n        return orderBy(data, order[0], order[1]);\n      } else if (typeof options.sortBy === 'function') {\n        return vanillaSortFn(options.sortBy, data);\n      }\n      throw new Error(\n        'options.sortBy is optional but if defined it must be ' +\n          'either an array of string (predicates) or a sorting function'\n      );\n    },\n    facetValues,\n    attributes\n  );\n};\n\n/**\n * Returns the facet stats if attribute is defined and the facet contains some.\n * Otherwise returns undefined.\n * @param {string} attribute name of the faceted attribute\n * @return {object} The stats of the facet\n */\nSearchResults.prototype.getFacetStats = function (attribute) {\n  if (this._state.isConjunctiveFacet(attribute)) {\n    return getFacetStatsIfAvailable(this.facets, attribute);\n  } else if (this._state.isDisjunctiveFacet(attribute)) {\n    return getFacetStatsIfAvailable(this.disjunctiveFacets, attribute);\n  }\n\n  return undefined;\n};\n\n/**\n * @typedef {Object} FacetListItem\n * @property {string} name\n */\n\n/**\n * @param {FacetListItem[]} facetList (has more items, but enough for here)\n * @param {string} facetName The attribute to look for\n * @return {object|undefined} The stats of the facet\n */\nfunction getFacetStatsIfAvailable(facetList, facetName) {\n  var data = find(facetList, function (facet) {\n    return facet.name === facetName;\n  });\n  return data && data.stats;\n}\n\n/**\n * Returns all refinements for all filters + tags. It also provides\n * additional information: count and exhaustiveness for each filter.\n *\n * See the [refinement type](#Refinement) for an exhaustive view of the available\n * data.\n *\n * Note that for a numeric refinement, results are grouped per operator, this\n * means that it will return responses for operators which are empty.\n *\n * @return {Array.<Refinement>} all the refinements\n */\nSearchResults.prototype.getRefinements = function () {\n  var state = this._state;\n  // eslint-disable-next-line consistent-this\n  var results = this;\n  var res = [];\n\n  Object.keys(state.facetsRefinements).forEach(function (attributeName) {\n    state.facetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(state, 'facet', attributeName, name, results.facets)\n      );\n    });\n  });\n\n  Object.keys(state.facetsExcludes).forEach(function (attributeName) {\n    state.facetsExcludes[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(state, 'exclude', attributeName, name, results.facets)\n      );\n    });\n  });\n\n  Object.keys(state.disjunctiveFacetsRefinements).forEach(function (\n    attributeName\n  ) {\n    state.disjunctiveFacetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getRefinement(\n          state,\n          'disjunctive',\n          attributeName,\n          name,\n          results.disjunctiveFacets\n        )\n      );\n    });\n  });\n\n  Object.keys(state.hierarchicalFacetsRefinements).forEach(function (\n    attributeName\n  ) {\n    state.hierarchicalFacetsRefinements[attributeName].forEach(function (name) {\n      res.push(\n        getHierarchicalRefinement(\n          state,\n          attributeName,\n          name,\n          results.hierarchicalFacets\n        )\n      );\n    });\n  });\n\n  Object.keys(state.numericRefinements).forEach(function (attributeName) {\n    var operators = state.numericRefinements[attributeName];\n    Object.keys(operators).forEach(function (operator) {\n      operators[operator].forEach(function (value) {\n        res.push({\n          type: 'numeric',\n          attributeName: attributeName,\n          name: value,\n          numericValue: value,\n          operator: operator,\n        });\n      });\n    });\n  });\n\n  state.tagRefinements.forEach(function (name) {\n    res.push({ type: 'tag', attributeName: '_tags', name: name });\n  });\n\n  return res;\n};\n\n/**\n * @typedef {Object} Facet\n * @property {string} name\n * @property {Object} data\n * @property {boolean} exhaustive\n */\n\n/**\n * @param {SearchParameters} state the current state\n * @param {string} type the type of the refinement\n * @param {string} attributeName The attribute of the facet\n * @param {*} name The name of the facet\n * @param {Facet[]} resultsFacets facets from the results\n * @return {Refinement} the refinement\n */\nfunction getRefinement(state, type, attributeName, name, resultsFacets) {\n  var facet = find(resultsFacets, function (f) {\n    return f.name === attributeName;\n  });\n  var count = facet && facet.data && facet.data[name] ? facet.data[name] : 0;\n  var exhaustive = (facet && facet.exhaustive) || false;\n\n  return {\n    type: type,\n    attributeName: attributeName,\n    name: name,\n    count: count,\n    exhaustive: exhaustive,\n  };\n}\n\n/**\n * @param {SearchParameters} state the current state\n * @param {string} attributeName the attribute of the hierarchical facet\n * @param {string} name the name of the facet\n * @param {Facet[]} resultsFacets facets from the results\n * @return {HierarchicalFacet} the hierarchical facet\n */\nfunction getHierarchicalRefinement(state, attributeName, name, resultsFacets) {\n  var facetDeclaration = state.getHierarchicalFacetByName(attributeName);\n  var separator = state._getHierarchicalFacetSeparator(facetDeclaration);\n  var split = name.split(separator);\n  var rootFacet = find(resultsFacets, function (facet) {\n    return facet.name === attributeName;\n  });\n\n  var facet = split.reduce(function (intermediateFacet, part) {\n    var newFacet =\n      intermediateFacet &&\n      find(intermediateFacet.data, function (f) {\n        return f.name === part;\n      });\n    return newFacet !== undefined ? newFacet : intermediateFacet;\n  }, rootFacet);\n\n  var count = (facet && facet.count) || 0;\n  var exhaustive = (facet && facet.exhaustive) || false;\n  var path = (facet && facet.path) || '';\n\n  return {\n    type: 'hierarchical',\n    attributeName: attributeName,\n    name: path,\n    count: count,\n    exhaustive: exhaustive,\n  };\n}\n\nmodule.exports = SearchResults;\n","'use strict';\n\nvar EventEmitter = require('@algolia/events');\n\nvar DerivedHelper = require('./DerivedHelper');\nvar escapeFacetValue = require('./functions/escapeFacetValue').escapeFacetValue;\nvar inherits = require('./functions/inherits');\nvar merge = require('./functions/merge');\nvar objectHasKeys = require('./functions/objectHasKeys');\nvar omit = require('./functions/omit');\nvar requestBuilder = require('./requestBuilder');\nvar SearchParameters = require('./SearchParameters');\nvar SearchResults = require('./SearchResults');\nvar version = require('./version');\n\n/**\n * Event triggered when a parameter is set or updated\n * @event AlgoliaSearchHelper#event:change\n * @property {object} event\n * @property {SearchParameters} event.state the current parameters with the latest changes applied\n * @property {SearchResults} event.results the previous results received from Algolia. `null` before the first request\n * @example\n * helper.on('change', function(event) {\n *   console.log('The parameters have changed');\n * });\n */\n\n/**\n * Event triggered when a main search is sent to Algolia\n * @event AlgoliaSearchHelper#event:search\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search\n * @property {SearchResults} event.results the results from the previous search. `null` if it is the first search.\n * @example\n * helper.on('search', function(event) {\n *   console.log('Search sent');\n * });\n */\n\n/**\n * Event triggered when a search using `searchForFacetValues` is sent to Algolia\n * @event AlgoliaSearchHelper#event:searchForFacetValues\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search it is the first search.\n * @property {string} event.facet the facet searched into\n * @property {string} event.query the query used to search in the facets\n * @example\n * helper.on('searchForFacetValues', function(event) {\n *   console.log('searchForFacetValues sent');\n * });\n */\n\n/**\n * Event triggered when a search using `searchOnce` is sent to Algolia\n * @event AlgoliaSearchHelper#event:searchOnce\n * @property {object} event\n * @property {SearchParameters} event.state the parameters used for this search it is the first search.\n * @example\n * helper.on('searchOnce', function(event) {\n *   console.log('searchOnce sent');\n * });\n */\n\n/**\n * Event triggered when the results are retrieved from Algolia\n * @event AlgoliaSearchHelper#event:result\n * @property {object} event\n * @property {SearchResults} event.results the results received from Algolia\n * @property {SearchParameters} event.state the parameters used to query Algolia. Those might be different from the one in the helper instance (for example if the network is unreliable).\n * @example\n * helper.on('result', function(event) {\n *   console.log('Search results received');\n * });\n */\n\n/**\n * Event triggered when Algolia sends back an error. For example, if an unknown parameter is\n * used, the error can be caught using this event.\n * @event AlgoliaSearchHelper#event:error\n * @property {object} event\n * @property {Error} event.error the error returned by the Algolia.\n * @example\n * helper.on('error', function(event) {\n *   console.log('Houston we got a problem.');\n * });\n */\n\n/**\n * Event triggered when the queue of queries have been depleted (with any result or outdated queries)\n * @event AlgoliaSearchHelper#event:searchQueueEmpty\n * @example\n * helper.on('searchQueueEmpty', function() {\n *   console.log('No more search pending');\n *   // This is received before the result event if we're not expecting new results\n * });\n *\n * helper.search();\n */\n\n/**\n * Initialize a new AlgoliaSearchHelper\n * @class\n * @classdesc The AlgoliaSearchHelper is a class that ease the management of the\n * search. It provides an event based interface for search callbacks:\n *  - change: when the internal search state is changed.\n *    This event contains a {@link SearchParameters} object and the\n *    {@link SearchResults} of the last result if any.\n *  - search: when a search is triggered using the `search()` method.\n *  - result: when the response is retrieved from Algolia and is processed.\n *    This event contains a {@link SearchResults} object and the\n *    {@link SearchParameters} corresponding to this answer.\n *  - error: when the response is an error. This event contains the error returned by the server.\n * @param  {AlgoliaSearch} client an AlgoliaSearch client\n * @param  {string} index the index name to query\n * @param  {SearchParameters | object} options an object defining the initial\n * config of the search. It doesn't have to be a {SearchParameters},\n * just an object containing the properties you need from it.\n */\nfunction AlgoliaSearchHelper(client, index, options) {\n  if (typeof client.addAlgoliaAgent === 'function') {\n    client.addAlgoliaAgent('JS Helper (' + version + ')');\n  }\n\n  this.setClient(client);\n  var opts = options || {};\n  opts.index = index;\n  this.state = SearchParameters.make(opts);\n  this.lastResults = null;\n  this._queryId = 0;\n  this._lastQueryIdReceived = -1;\n  this.derivedHelpers = [];\n  this._currentNbQueries = 0;\n}\n\ninherits(AlgoliaSearchHelper, EventEmitter);\n\n/**\n * Start the search with the parameters set in the state. When the\n * method is called, it triggers a `search` event. The results will\n * be available through the `result` event. If an error occurs, an\n * `error` will be fired instead.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires search\n * @fires result\n * @fires error\n * @chainable\n */\nAlgoliaSearchHelper.prototype.search = function () {\n  this._search({ onlyWithDerivedHelpers: false });\n  return this;\n};\n\nAlgoliaSearchHelper.prototype.searchOnlyWithDerivedHelpers = function () {\n  this._search({ onlyWithDerivedHelpers: true });\n  return this;\n};\n\n/**\n * Gets the search query parameters that would be sent to the Algolia Client\n * for the hits\n * @return {object} Query Parameters\n */\nAlgoliaSearchHelper.prototype.getQuery = function () {\n  var state = this.state;\n  return requestBuilder._getHitsSearchParams(state);\n};\n\n/**\n * Start a search using a modified version of the current state. This method does\n * not trigger the helper lifecycle and does not modify the state kept internally\n * by the helper. This second aspect means that the next search call will be the\n * same as a search call before calling searchOnce.\n * @param {object} options can contain all the parameters that can be set to SearchParameters\n * plus the index\n * @param {function} [cb] optional callback executed when the response from the\n * server is back.\n * @return {promise|undefined} if a callback is passed the method returns undefined\n * otherwise it returns a promise containing an object with two keys :\n *  - content with a SearchResults\n *  - state with the state used for the query as a SearchParameters\n * @example\n * // Changing the number of records returned per page to 1\n * // This example uses the callback API\n * var state = helper.searchOnce({hitsPerPage: 1},\n *   function(error, content, state) {\n *     // if an error occurred it will be passed in error, otherwise its value is null\n *     // content contains the results formatted as a SearchResults\n *     // state is the instance of SearchParameters used for this search\n *   });\n * @example\n * // Changing the number of records returned per page to 1\n * // This example uses the promise API\n * var state1 = helper.searchOnce({hitsPerPage: 1})\n *                 .then(promiseHandler);\n *\n * function promiseHandler(res) {\n *   // res contains\n *   // {\n *   //   content : SearchResults\n *   //   state   : SearchParameters (the one used for this specific search)\n *   // }\n * }\n */\nAlgoliaSearchHelper.prototype.searchOnce = function (options, cb) {\n  var tempState = !options\n    ? this.state\n    : this.state.setQueryParameters(options);\n  var queries = requestBuilder._getQueries(tempState.index, tempState);\n  // eslint-disable-next-line consistent-this\n  var self = this;\n\n  this._currentNbQueries++;\n\n  this.emit('searchOnce', {\n    state: tempState,\n  });\n\n  if (cb) {\n    this.client\n      .search(queries)\n      .then(function (content) {\n        self._currentNbQueries--;\n        if (self._currentNbQueries === 0) {\n          self.emit('searchQueueEmpty');\n        }\n\n        cb(null, new SearchResults(tempState, content.results), tempState);\n      })\n      .catch(function (err) {\n        self._currentNbQueries--;\n        if (self._currentNbQueries === 0) {\n          self.emit('searchQueueEmpty');\n        }\n\n        cb(err, null, tempState);\n      });\n\n    return undefined;\n  }\n\n  return this.client.search(queries).then(\n    function (content) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      return {\n        content: new SearchResults(tempState, content.results),\n        state: tempState,\n        _originalResponse: content,\n      };\n    },\n    function (e) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      throw e;\n    }\n  );\n};\n\n/**\n * Start the search for answers with the parameters set in the state.\n * This method returns a promise.\n * @param {Object} options - the options for answers API call\n * @param {string[]} options.attributesForPrediction - Attributes to use for predictions. If empty, `searchableAttributes` is used instead.\n * @param {string[]} options.queryLanguages - The languages in the query. Currently only supports ['en'].\n * @param {number} options.nbHits - Maximum number of answers to retrieve from the Answers Engine. Cannot be greater than 1000.\n *\n * @return {promise} the answer results\n * @deprecated answers is deprecated and will be replaced with new initiatives\n */\nAlgoliaSearchHelper.prototype.findAnswers = function (options) {\n  // eslint-disable-next-line no-console\n  console.warn('[algoliasearch-helper] answers is no longer supported');\n  var state = this.state;\n  var derivedHelper = this.derivedHelpers[0];\n  if (!derivedHelper) {\n    return Promise.resolve([]);\n  }\n  var derivedState = derivedHelper.getModifiedState(state);\n  var data = merge(\n    {\n      attributesForPrediction: options.attributesForPrediction,\n      nbHits: options.nbHits,\n    },\n    {\n      params: omit(requestBuilder._getHitsSearchParams(derivedState), [\n        'attributesToSnippet',\n        'hitsPerPage',\n        'restrictSearchableAttributes',\n        'snippetEllipsisText',\n      ]),\n    }\n  );\n\n  var errorMessage =\n    'search for answers was called, but this client does not have a function client.initIndex(index).findAnswers';\n  if (typeof this.client.initIndex !== 'function') {\n    throw new Error(errorMessage);\n  }\n  var index = this.client.initIndex(derivedState.index);\n  if (typeof index.findAnswers !== 'function') {\n    throw new Error(errorMessage);\n  }\n  return index.findAnswers(derivedState.query, options.queryLanguages, data);\n};\n\n/**\n * Structure of each result when using\n * [`searchForFacetValues()`](reference.html#AlgoliaSearchHelper#searchForFacetValues)\n * @typedef FacetSearchHit\n * @type {object}\n * @property {string} value the facet value\n * @property {string} highlighted the facet value highlighted with the query string\n * @property {number} count number of occurrence of this facet value\n * @property {boolean} isRefined true if the value is already refined\n */\n\n/**\n * Structure of the data resolved by the\n * [`searchForFacetValues()`](reference.html#AlgoliaSearchHelper#searchForFacetValues)\n * promise.\n * @typedef FacetSearchResult\n * @type {object}\n * @property {FacetSearchHit} facetHits the results for this search for facet values\n * @property {number} processingTimeMS time taken by the query inside the engine\n */\n\n/**\n * Search for facet values based on an query and the name of a faceted attribute. This\n * triggers a search and will return a promise. On top of using the query, it also sends\n * the parameters from the state so that the search is narrowed down to only the possible values.\n *\n * See the description of [FacetSearchResult](reference.html#FacetSearchResult)\n * @param {string} facet the name of the faceted attribute\n * @param {string} query the string query for the search\n * @param {number} [maxFacetHits] the maximum number values returned. Should be > 0 and <= 100\n * @param {object} [userState] the set of custom parameters to use on top of the current state. Setting a property to `undefined` removes\n * it in the generated query.\n * @return {promise.<FacetSearchResult>} the results of the search\n */\nAlgoliaSearchHelper.prototype.searchForFacetValues = function (\n  facet,\n  query,\n  maxFacetHits,\n  userState\n) {\n  var clientHasSFFV = typeof this.client.searchForFacetValues === 'function';\n  var clientHasInitIndex = typeof this.client.initIndex === 'function';\n  if (\n    !clientHasSFFV &&\n    !clientHasInitIndex &&\n    typeof this.client.search !== 'function'\n  ) {\n    throw new Error(\n      'search for facet values (searchable) was called, but this client does not have a function client.searchForFacetValues or client.initIndex(index).searchForFacetValues'\n    );\n  }\n\n  var state = this.state.setQueryParameters(userState || {});\n  var isDisjunctive = state.isDisjunctiveFacet(facet);\n  var algoliaQuery = requestBuilder.getSearchForFacetQuery(\n    facet,\n    query,\n    maxFacetHits,\n    state\n  );\n\n  this._currentNbQueries++;\n  // eslint-disable-next-line consistent-this\n  var self = this;\n  var searchForFacetValuesPromise;\n  // newer algoliasearch ^3.27.1 - ~4.0.0\n  if (clientHasSFFV) {\n    searchForFacetValuesPromise = this.client.searchForFacetValues([\n      { indexName: state.index, params: algoliaQuery },\n    ]);\n    // algoliasearch < 3.27.1\n  } else if (clientHasInitIndex) {\n    searchForFacetValuesPromise = this.client\n      .initIndex(state.index)\n      .searchForFacetValues(algoliaQuery);\n    // algoliasearch ~5.0.0\n  } else {\n    // @MAJOR only use client.search\n    delete algoliaQuery.facetName;\n    searchForFacetValuesPromise = this.client\n      .search([\n        {\n          type: 'facet',\n          facet: facet,\n          indexName: state.index,\n          params: algoliaQuery,\n        },\n      ])\n      .then(function processResponse(response) {\n        return response.results[0];\n      });\n  }\n\n  this.emit('searchForFacetValues', {\n    state: state,\n    facet: facet,\n    query: query,\n  });\n\n  return searchForFacetValuesPromise.then(\n    function addIsRefined(content) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n\n      content = Array.isArray(content) ? content[0] : content;\n\n      content.facetHits.forEach(function (f) {\n        f.escapedValue = escapeFacetValue(f.value);\n        f.isRefined = isDisjunctive\n          ? state.isDisjunctiveFacetRefined(facet, f.escapedValue)\n          : state.isFacetRefined(facet, f.escapedValue);\n      });\n\n      return content;\n    },\n    function (e) {\n      self._currentNbQueries--;\n      if (self._currentNbQueries === 0) self.emit('searchQueueEmpty');\n      throw e;\n    }\n  );\n};\n\n/**\n * Sets the text query used for the search.\n *\n * This method resets the current page to 0.\n * @param  {string} q the user query\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setQuery = function (q) {\n  this._change({\n    state: this.state.resetPage().setQuery(q),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Remove all the types of refinements except tags. A string can be provided to remove\n * only the refinements of a specific attribute. For more advanced use case, you can\n * provide a function instead. This function should follow the\n * [clearCallback definition](#SearchParameters.clearCallback).\n *\n * This method resets the current page to 0.\n * @param {string} [name] optional name of the facet / attribute on which we want to remove all refinements\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * // Removing all the refinements\n * helper.clearRefinements().search();\n * @example\n * // Removing all the filters on a the category attribute.\n * helper.clearRefinements('category').search();\n * @example\n * // Removing only the exclude filters on the category facet.\n * helper.clearRefinements(function(value, attribute, type) {\n *   return type === 'exclude' && attribute === 'category';\n * }).search();\n */\nAlgoliaSearchHelper.prototype.clearRefinements = function (name) {\n  this._change({\n    state: this.state.resetPage().clearRefinements(name),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Remove all the tag filters.\n *\n * This method resets the current page to 0.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.clearTags = function () {\n  this._change({\n    state: this.state.resetPage().clearTags(),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a disjunctive filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addDisjunctiveFacetRefinement = function (\n  facet,\n  value\n) {\n  this._change({\n    state: this.state.resetPage().addDisjunctiveFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addDisjunctiveFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.addDisjunctiveRefine = function () {\n  return this.addDisjunctiveFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds a refinement on a hierarchical facet. It will throw\n * an exception if the facet is not defined or if the facet\n * is already refined.\n *\n * This method resets the current page to 0.\n * @param {string} facet the facet name\n * @param {string} path the hierarchical facet path\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error if the facet is not defined or if the facet is refined\n * @chainable\n * @fires change\n */\nAlgoliaSearchHelper.prototype.addHierarchicalFacetRefinement = function (\n  facet,\n  path\n) {\n  this._change({\n    state: this.state.resetPage().addHierarchicalFacetRefinement(facet, path),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a an numeric filter to an attribute with the `operator` and `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} attribute the attribute on which the numeric filter applies\n * @param  {string} operator the operator of the filter\n * @param  {number} value the value of the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addNumericRefinement = function (\n  attribute,\n  operator,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .addNumericRefinement(attribute, operator, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds a filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().addFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.addRefine = function () {\n  return this.addFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds a an exclusion filter to a faceted attribute with the `value` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value (will be converted to string)\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().addExcludeRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#addFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.addExclude = function () {\n  return this.addFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Adds a tag filter with the `tag` provided. If the\n * filter is already set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param {string} tag the tag to add to the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.addTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().addTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes an numeric filter to an attribute with the `operator` and `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * Some parameters are optional, triggering different behavior:\n *  - if the value is not provided, then all the numeric value will be removed for the\n *  specified attribute/operator couple.\n *  - if the operator is not provided either, then all the numeric filter on this attribute\n *  will be removed.\n *\n * This method resets the current page to 0.\n * @param  {string} attribute the attribute on which the numeric filter applies\n * @param  {string} [operator] the operator of the filter\n * @param  {number} [value] the value of the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeNumericRefinement = function (\n  attribute,\n  operator,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .removeNumericRefinement(attribute, operator, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes a disjunctive filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeDisjunctiveFacetRefinement = function (\n  facet,\n  value\n) {\n  this._change({\n    state: this.state\n      .resetPage()\n      .removeDisjunctiveFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeDisjunctiveFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.removeDisjunctiveRefine = function () {\n  return this.removeDisjunctiveFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Removes the refinement set on a hierarchical facet.\n * @param {string} facet the facet name\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error if the facet is not defined or if the facet is not refined\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeHierarchicalFacetRefinement = function (\n  facet\n) {\n  this._change({\n    state: this.state.resetPage().removeHierarchicalFacetRefinement(facet),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Removes a filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().removeFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.removeRefine = function () {\n  return this.removeFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Removes an exclusion filter to a faceted attribute with the `value` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * If the value is omitted, then this method will remove all the filters for the\n * attribute.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} [value] the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().removeExcludeRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#removeFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.removeExclude = function () {\n  return this.removeFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Removes a tag filter with the `tag` provided. If the\n * filter is not set, it doesn't change the filters.\n *\n * This method resets the current page to 0.\n * @param {string} tag tag to remove from the filter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.removeTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().removeTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Adds or removes an exclusion filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleFacetExclusion = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().toggleExcludeFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#toggleFacetExclusion}\n */\nAlgoliaSearchHelper.prototype.toggleExclude = function () {\n  return this.toggleFacetExclusion.apply(this, arguments);\n};\n\n/**\n * Adds or removes a filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method can be used for conjunctive, disjunctive and hierarchical filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error will throw an error if the facet is not declared in the settings of the helper\n * @fires change\n * @chainable\n * @deprecated since version 2.19.0, see {@link AlgoliaSearchHelper#toggleFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.toggleRefinement = function (facet, value) {\n  return this.toggleFacetRefinement(facet, value);\n};\n\n/**\n * Adds or removes a filter to a faceted attribute with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method can be used for conjunctive, disjunctive and hierarchical filters.\n *\n * This method resets the current page to 0.\n * @param  {string} facet the facet to refine\n * @param  {string} value the associated value\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @throws Error will throw an error if the facet is not declared in the settings of the helper\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleFacetRefinement = function (facet, value) {\n  this._change({\n    state: this.state.resetPage().toggleFacetRefinement(facet, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since version 2.4.0, see {@link AlgoliaSearchHelper#toggleFacetRefinement}\n */\nAlgoliaSearchHelper.prototype.toggleRefine = function () {\n  return this.toggleFacetRefinement.apply(this, arguments);\n};\n\n/**\n * Adds or removes a tag filter with the `value` provided. If\n * the value is set then it removes it, otherwise it adds the filter.\n *\n * This method resets the current page to 0.\n * @param {string} tag tag to remove or add\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.toggleTag = function (tag) {\n  this._change({\n    state: this.state.resetPage().toggleTagRefinement(tag),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Increments the page number by one.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * helper.setPage(0).nextPage().getPage();\n * // returns 1\n */\nAlgoliaSearchHelper.prototype.nextPage = function () {\n  var page = this.state.page || 0;\n  return this.setPage(page + 1);\n};\n\n/**\n * Decrements the page number by one.\n * @fires change\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @chainable\n * @example\n * helper.setPage(1).previousPage().getPage();\n * // returns 0\n */\nAlgoliaSearchHelper.prototype.previousPage = function () {\n  var page = this.state.page || 0;\n  return this.setPage(page - 1);\n};\n\n/**\n * @private\n * @param {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @chainable\n * @fires change\n */\nfunction setCurrentPage(page) {\n  if (page < 0) throw new Error('Page requested below 0.');\n\n  this._change({\n    state: this.state.setPage(page),\n    isPageReset: false,\n  });\n\n  return this;\n}\n\n/**\n * Change the current page\n * @deprecated\n * @param  {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setCurrentPage = setCurrentPage;\n\n/**\n * Updates the current page.\n * @function\n * @param  {number} page The page number\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setPage = setCurrentPage;\n\n/**\n * Updates the name of the index that will be targeted by the query.\n *\n * This method resets the current page to 0.\n * @param {string} name the index name\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setIndex = function (name) {\n  this._change({\n    state: this.state.resetPage().setIndex(name),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Update a parameter of the search. This method reset the page\n *\n * The complete list of parameters is available on the\n * [Algolia website](https://www.algolia.com/doc/rest#query-an-index).\n * The most commonly used parameters have their own [shortcuts](#query-parameters-shortcuts)\n * or benefit from higher-level APIs (all the kind of filters and facets have their own API)\n *\n * This method resets the current page to 0.\n * @param {string} parameter name of the parameter to update\n * @param {any} value new value of the parameter\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n * @example\n * helper.setQueryParameter('hitsPerPage', 20).search();\n */\nAlgoliaSearchHelper.prototype.setQueryParameter = function (parameter, value) {\n  this._change({\n    state: this.state.resetPage().setQueryParameter(parameter, value),\n    isPageReset: true,\n  });\n\n  return this;\n};\n\n/**\n * Set the whole state (warning: will erase previous state)\n * @param {SearchParameters} newState the whole new state\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @fires change\n * @chainable\n */\nAlgoliaSearchHelper.prototype.setState = function (newState) {\n  this._change({\n    state: SearchParameters.make(newState),\n    isPageReset: false,\n  });\n\n  return this;\n};\n\n/**\n * Override the current state without triggering a change event.\n * Do not use this method unless you know what you are doing. (see the example\n * for a legit use case)\n * @param {SearchParameters} newState the whole new state\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n * @example\n *  helper.on('change', function(state){\n *    // In this function you might want to find a way to store the state in the url/history\n *    updateYourURL(state)\n *  })\n *  window.onpopstate = function(event){\n *    // This is naive though as you should check if the state is really defined etc.\n *    helper.overrideStateWithoutTriggeringChangeEvent(event.state).search()\n *  }\n * @chainable\n */\nAlgoliaSearchHelper.prototype.overrideStateWithoutTriggeringChangeEvent =\n  function (newState) {\n    this.state = new SearchParameters(newState);\n    return this;\n  };\n\n/**\n * Check if an attribute has any numeric, conjunctive, disjunctive or hierarchical filters.\n * @param {string} attribute the name of the attribute\n * @return {boolean} true if the attribute is filtered by at least one value\n * @example\n * // hasRefinements works with numeric, conjunctive, disjunctive and hierarchical filters\n * helper.hasRefinements('price'); // false\n * helper.addNumericRefinement('price', '>', 100);\n * helper.hasRefinements('price'); // true\n *\n * helper.hasRefinements('color'); // false\n * helper.addFacetRefinement('color', 'blue');\n * helper.hasRefinements('color'); // true\n *\n * helper.hasRefinements('material'); // false\n * helper.addDisjunctiveFacetRefinement('material', 'plastic');\n * helper.hasRefinements('material'); // true\n *\n * helper.hasRefinements('categories'); // false\n * helper.toggleFacetRefinement('categories', 'kitchen > knife');\n * helper.hasRefinements('categories'); // true\n *\n */\nAlgoliaSearchHelper.prototype.hasRefinements = function (attribute) {\n  if (objectHasKeys(this.state.getNumericRefinements(attribute))) {\n    return true;\n  } else if (this.state.isConjunctiveFacet(attribute)) {\n    return this.state.isFacetRefined(attribute);\n  } else if (this.state.isDisjunctiveFacet(attribute)) {\n    return this.state.isDisjunctiveFacetRefined(attribute);\n  } else if (this.state.isHierarchicalFacet(attribute)) {\n    return this.state.isHierarchicalFacetRefined(attribute);\n  }\n\n  // there's currently no way to know that the user did call `addNumericRefinement` at some point\n  // thus we cannot distinguish if there once was a numeric refinement that was cleared\n  // so we will return false in every other situations to be consistent\n  // while what we should do here is throw because we did not find the attribute in any type\n  // of refinement\n  return false;\n};\n\n/**\n * Check if a value is excluded for a specific faceted attribute. If the value\n * is omitted then the function checks if there is any excluding refinements.\n *\n * @param  {string}  facet name of the attribute for used for faceting\n * @param  {string}  [value] optional value. If passed will test that this value\n * is filtering the given facet.\n * @return {boolean} true if refined\n * @example\n * helper.isExcludeRefined('color'); // false\n * helper.isExcludeRefined('color', 'blue') // false\n * helper.isExcludeRefined('color', 'red') // false\n *\n * helper.addFacetExclusion('color', 'red');\n *\n * helper.isExcludeRefined('color'); // true\n * helper.isExcludeRefined('color', 'blue') // false\n * helper.isExcludeRefined('color', 'red') // true\n */\nAlgoliaSearchHelper.prototype.isExcluded = function (facet, value) {\n  return this.state.isExcludeRefined(facet, value);\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since 2.4.0, see {@link AlgoliaSearchHelper#hasRefinements}\n */\nAlgoliaSearchHelper.prototype.isDisjunctiveRefined = function (facet, value) {\n  return this.state.isDisjunctiveFacetRefined(facet, value);\n};\n\n/**\n * Check if the string is a currently filtering tag.\n * @param {string} tag tag to check\n * @return {boolean} true if the tag is currently refined\n */\nAlgoliaSearchHelper.prototype.hasTag = function (tag) {\n  return this.state.isTagRefined(tag);\n};\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @deprecated since 2.4.0, see {@link AlgoliaSearchHelper#hasTag}\n */\nAlgoliaSearchHelper.prototype.isTagRefined = function () {\n  return this.hasTagRefinements.apply(this, arguments);\n};\n\n/**\n * Get the name of the currently used index.\n * @return {string} name of the index\n * @example\n * helper.setIndex('highestPrice_products').getIndex();\n * // returns 'highestPrice_products'\n */\nAlgoliaSearchHelper.prototype.getIndex = function () {\n  return this.state.index;\n};\n\nfunction getCurrentPage() {\n  return this.state.page;\n}\n\n/**\n * Get the currently selected page\n * @deprecated\n * @return {number} the current page\n */\nAlgoliaSearchHelper.prototype.getCurrentPage = getCurrentPage;\n/**\n * Get the currently selected page\n * @function\n * @return {number} the current page\n */\nAlgoliaSearchHelper.prototype.getPage = getCurrentPage;\n\n/**\n * Get all the tags currently set to filters the results.\n *\n * @return {string[]} The list of tags currently set.\n */\nAlgoliaSearchHelper.prototype.getTags = function () {\n  return this.state.tagRefinements;\n};\n\n/**\n * Get the list of refinements for a given attribute. This method works with\n * conjunctive, disjunctive, excluding and numerical filters.\n *\n * See also SearchResults#getRefinements\n *\n * @param {string} facetName attribute name used for faceting\n * @return {Array.<FacetRefinement|NumericRefinement>} All Refinement are objects that contain a value, and\n * a type. Numeric also contains an operator.\n * @example\n * helper.addNumericRefinement('price', '>', 100);\n * helper.getRefinements('price');\n * // [\n * //   {\n * //     \"value\": [\n * //       100\n * //     ],\n * //     \"operator\": \">\",\n * //     \"type\": \"numeric\"\n * //   }\n * // ]\n * @example\n * helper.addFacetRefinement('color', 'blue');\n * helper.addFacetExclusion('color', 'red');\n * helper.getRefinements('color');\n * // [\n * //   {\n * //     \"value\": \"blue\",\n * //     \"type\": \"conjunctive\"\n * //   },\n * //   {\n * //     \"value\": \"red\",\n * //     \"type\": \"exclude\"\n * //   }\n * // ]\n * @example\n * helper.addDisjunctiveFacetRefinement('material', 'plastic');\n * // [\n * //   {\n * //     \"value\": \"plastic\",\n * //     \"type\": \"disjunctive\"\n * //   }\n * // ]\n */\nAlgoliaSearchHelper.prototype.getRefinements = function (facetName) {\n  var refinements = [];\n\n  if (this.state.isConjunctiveFacet(facetName)) {\n    var conjRefinements = this.state.getConjunctiveRefinements(facetName);\n\n    conjRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'conjunctive',\n      });\n    });\n\n    var excludeRefinements = this.state.getExcludeRefinements(facetName);\n\n    excludeRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'exclude',\n      });\n    });\n  } else if (this.state.isDisjunctiveFacet(facetName)) {\n    var disjunctiveRefinements =\n      this.state.getDisjunctiveRefinements(facetName);\n\n    disjunctiveRefinements.forEach(function (r) {\n      refinements.push({\n        value: r,\n        type: 'disjunctive',\n      });\n    });\n  }\n\n  var numericRefinements = this.state.getNumericRefinements(facetName);\n\n  Object.keys(numericRefinements).forEach(function (operator) {\n    var value = numericRefinements[operator];\n\n    refinements.push({\n      value: value,\n      operator: operator,\n      type: 'numeric',\n    });\n  });\n\n  return refinements;\n};\n\n/**\n * Return the current refinement for the (attribute, operator)\n * @param {string} attribute attribute in the record\n * @param {string} operator operator applied on the refined values\n * @return {Array.<number|number[]>} refined values\n */\nAlgoliaSearchHelper.prototype.getNumericRefinement = function (\n  attribute,\n  operator\n) {\n  return this.state.getNumericRefinement(attribute, operator);\n};\n\n/**\n * Get the current breadcrumb for a hierarchical facet, as an array\n * @param  {string} facetName Hierarchical facet name\n * @return {array.<string>} the path as an array of string\n */\nAlgoliaSearchHelper.prototype.getHierarchicalFacetBreadcrumb = function (\n  facetName\n) {\n  return this.state.getHierarchicalFacetBreadcrumb(facetName);\n};\n\n// /////////// PRIVATE\n\n/**\n * Perform the underlying queries\n * @private\n * @param {object} options options for the query\n * @param {boolean} [options.onlyWithDerivedHelpers=false] if true, only the derived helpers will be queried\n * @return {undefined} does not return anything\n * @fires search\n * @fires result\n * @fires error\n */\nAlgoliaSearchHelper.prototype._search = function (options) {\n  var state = this.state;\n  var states = [];\n  var mainQueries = [];\n\n  if (!options.onlyWithDerivedHelpers) {\n    mainQueries = requestBuilder._getQueries(state.index, state);\n\n    states.push({\n      state: state,\n      queriesCount: mainQueries.length,\n      helper: this,\n    });\n\n    this.emit('search', {\n      state: state,\n      results: this.lastResults,\n    });\n  }\n\n  var derivedQueries = this.derivedHelpers.map(function (derivedHelper) {\n    var derivedState = derivedHelper.getModifiedState(state);\n    var derivedStateQueries = derivedState.index\n      ? requestBuilder._getQueries(derivedState.index, derivedState)\n      : [];\n\n    states.push({\n      state: derivedState,\n      queriesCount: derivedStateQueries.length,\n      helper: derivedHelper,\n    });\n\n    derivedHelper.emit('search', {\n      state: derivedState,\n      results: derivedHelper.lastResults,\n    });\n\n    return derivedStateQueries;\n  });\n\n  var queries = Array.prototype.concat.apply(mainQueries, derivedQueries);\n\n  var queryId = this._queryId++;\n  this._currentNbQueries++;\n\n  if (!queries.length) {\n    return Promise.resolve({ results: [] }).then(\n      this._dispatchAlgoliaResponse.bind(this, states, queryId)\n    );\n  }\n\n  try {\n    this.client\n      .search(queries)\n      .then(this._dispatchAlgoliaResponse.bind(this, states, queryId))\n      .catch(this._dispatchAlgoliaError.bind(this, queryId));\n  } catch (error) {\n    // If we reach this part, we're in an internal error state\n    this.emit('error', {\n      error: error,\n    });\n  }\n\n  return undefined;\n};\n\n/**\n * Transform the responses as sent by the server and transform them into a user\n * usable object that merge the results of all the batch requests. It will dispatch\n * over the different helper + derived helpers (when there are some).\n * @private\n * @param {array.<{SearchParameters, AlgoliaQueries, AlgoliaSearchHelper}>} states state used to generate the request\n * @param {number} queryId id of the current request\n * @param {object} content content of the response\n * @return {undefined}\n */\nAlgoliaSearchHelper.prototype._dispatchAlgoliaResponse = function (\n  states,\n  queryId,\n  content\n) {\n  // @TODO remove the number of outdated queries discarded instead of just one\n\n  if (queryId < this._lastQueryIdReceived) {\n    // Outdated answer\n    return;\n  }\n\n  this._currentNbQueries -= queryId - this._lastQueryIdReceived;\n  this._lastQueryIdReceived = queryId;\n\n  if (this._currentNbQueries === 0) this.emit('searchQueueEmpty');\n\n  var results = content.results.slice();\n\n  states.forEach(function (s) {\n    var state = s.state;\n    var queriesCount = s.queriesCount;\n    var helper = s.helper;\n    var specificResults = results.splice(0, queriesCount);\n\n    if (!state.index) {\n      helper.emit('result', {\n        results: null,\n        state: state,\n      });\n      return;\n    }\n\n    helper.lastResults = new SearchResults(state, specificResults);\n\n    helper.emit('result', {\n      results: helper.lastResults,\n      state: state,\n    });\n  });\n};\n\nAlgoliaSearchHelper.prototype._dispatchAlgoliaError = function (\n  queryId,\n  error\n) {\n  if (queryId < this._lastQueryIdReceived) {\n    // Outdated answer\n    return;\n  }\n\n  this._currentNbQueries -= queryId - this._lastQueryIdReceived;\n  this._lastQueryIdReceived = queryId;\n\n  this.emit('error', {\n    error: error,\n  });\n\n  if (this._currentNbQueries === 0) this.emit('searchQueueEmpty');\n};\n\nAlgoliaSearchHelper.prototype.containsRefinement = function (\n  query,\n  facetFilters,\n  numericFilters,\n  tagFilters\n) {\n  return (\n    query ||\n    facetFilters.length !== 0 ||\n    numericFilters.length !== 0 ||\n    tagFilters.length !== 0\n  );\n};\n\n/**\n * Test if there are some disjunctive refinements on the facet\n * @private\n * @param {string} facet the attribute to test\n * @return {boolean} true if there are refinements on this attribute\n */\nAlgoliaSearchHelper.prototype._hasDisjunctiveRefinements = function (facet) {\n  return (\n    this.state.disjunctiveRefinements[facet] &&\n    this.state.disjunctiveRefinements[facet].length > 0\n  );\n};\n\nAlgoliaSearchHelper.prototype._change = function (event) {\n  var state = event.state;\n  var isPageReset = event.isPageReset;\n\n  if (state !== this.state) {\n    this.state = state;\n\n    this.emit('change', {\n      state: this.state,\n      results: this.lastResults,\n      isPageReset: isPageReset,\n    });\n  }\n};\n\n/**\n * Clears the cache of the underlying Algolia client.\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n */\nAlgoliaSearchHelper.prototype.clearCache = function () {\n  if (this.client.clearCache) this.client.clearCache();\n  return this;\n};\n\n/**\n * Updates the internal client instance. If the reference of the clients\n * are equal then no update is actually done.\n * @param  {AlgoliaSearch} newClient an AlgoliaSearch client\n * @return {AlgoliaSearchHelper} Method is chainable, it returns itself\n */\nAlgoliaSearchHelper.prototype.setClient = function (newClient) {\n  if (this.client === newClient) return this;\n\n  if (typeof newClient.addAlgoliaAgent === 'function') {\n    newClient.addAlgoliaAgent('JS Helper (' + version + ')');\n  }\n  this.client = newClient;\n\n  return this;\n};\n\n/**\n * Gets the instance of the currently used client.\n * @return {AlgoliaSearch} the currently used client\n */\nAlgoliaSearchHelper.prototype.getClient = function () {\n  return this.client;\n};\n\n/**\n * Creates an derived instance of the Helper. A derived helper\n * is a way to request other indices synchronised with the lifecycle\n * of the main Helper. This mechanism uses the multiqueries feature\n * of Algolia to aggregate all the requests in a single network call.\n *\n * This method takes a function that is used to create a new SearchParameter\n * that will be used to create requests to Algolia. Those new requests\n * are created just before the `search` event. The signature of the function\n * is `SearchParameters -> SearchParameters`.\n *\n * This method returns a new DerivedHelper which is an EventEmitter\n * that fires the same `search`, `result` and `error` events. Those\n * events, however, will receive data specific to this DerivedHelper\n * and the SearchParameters that is returned by the call of the\n * parameter function.\n * @param {function} fn SearchParameters -> SearchParameters\n * @return {DerivedHelper} a new DerivedHelper\n */\nAlgoliaSearchHelper.prototype.derive = function (fn) {\n  var derivedHelper = new DerivedHelper(this, fn);\n  this.derivedHelpers.push(derivedHelper);\n  return derivedHelper;\n};\n\n/**\n * This method detaches a derived Helper from the main one. Prefer using the one from the\n * derived helper itself, to remove the event listeners too.\n * @private\n * @param  {DerivedHelper} derivedHelper the derived helper to detach\n * @return {undefined} nothing is returned\n * @throws Error\n */\nAlgoliaSearchHelper.prototype.detachDerivedHelper = function (derivedHelper) {\n  var pos = this.derivedHelpers.indexOf(derivedHelper);\n  if (pos === -1) throw new Error('Derived helper already detached');\n  this.derivedHelpers.splice(pos, 1);\n};\n\n/**\n * This method returns true if there is currently at least one on-going search.\n * @return {boolean} true if there is a search pending\n */\nAlgoliaSearchHelper.prototype.hasPendingRequests = function () {\n  return this._currentNbQueries > 0;\n};\n\n/**\n * @typedef AlgoliaSearchHelper.NumericRefinement\n * @type {object}\n * @property {number[]} value the numbers that are used for filtering this attribute with\n * the operator specified.\n * @property {string} operator the faceting data: value, number of entries\n * @property {string} type will be 'numeric'\n */\n\n/**\n * @typedef AlgoliaSearchHelper.FacetRefinement\n * @type {object}\n * @property {string} value the string use to filter the attribute\n * @property {string} type the type of filter: 'conjunctive', 'disjunctive', 'exclude'\n */\n\nmodule.exports = AlgoliaSearchHelper;\n","'use strict';\n\nmodule.exports = function compact(array) {\n  if (!Array.isArray(array)) {\n    return [];\n  }\n\n  return array.filter(Boolean);\n};\n","'use strict';\n\n// NOTE: this behaves like lodash/defaults, but doesn't mutate the target\n// it also preserve keys order\nmodule.exports = function defaultsPure() {\n  var sources = Array.prototype.slice.call(arguments);\n\n  return sources.reduceRight(function (acc, source) {\n    Object.keys(Object(source)).forEach(function (key) {\n      if (source[key] === undefined) {\n        return;\n      }\n      if (acc[key] !== undefined) {\n        // remove if already added, so that we can add it in correct order\n        delete acc[key];\n      }\n      acc[key] = source[key];\n    });\n    return acc;\n  }, {});\n};\n","'use strict';\n\n/**\n * Replaces a leading - with \\-\n * @private\n * @param {any} value the facet value to replace\n * @returns {any} the escaped facet value or the value if it was not a string\n */\nfunction escapeFacetValue(value) {\n  if (typeof value !== 'string') return value;\n\n  return String(value).replace(/^-/, '\\\\-');\n}\n\n/**\n * Replaces a leading \\- with -\n * @private\n * @param {any} value the escaped facet value\n * @returns {any} the unescaped facet value or the value if it was not a string\n */\nfunction unescapeFacetValue(value) {\n  if (typeof value !== 'string') return value;\n\n  return value.replace(/^\\\\-/, '-');\n}\n\nmodule.exports = {\n  escapeFacetValue: escapeFacetValue,\n  unescapeFacetValue: unescapeFacetValue,\n};\n","'use strict';\n\n// @MAJOR can be replaced by native Array#find when we change support\nmodule.exports = function find(array, comparator) {\n  if (!Array.isArray(array)) {\n    return undefined;\n  }\n\n  for (var i = 0; i < array.length; i++) {\n    if (comparator(array[i])) {\n      return array[i];\n    }\n  }\n\n  return undefined;\n};\n","'use strict';\n\n// @MAJOR can be replaced by native Array#findIndex when we change support\nmodule.exports = function find(array, comparator) {\n  if (!Array.isArray(array)) {\n    return -1;\n  }\n\n  for (var i = 0; i < array.length; i++) {\n    if (comparator(array[i])) {\n      return i;\n    }\n  }\n  return -1;\n};\n","'use strict';\n\nvar find = require('./find');\n\n/**\n * Transform sort format from user friendly notation to lodash format\n * @param {string[]} sortBy array of predicate of the form \"attribute:order\"\n * @param {string[]} [defaults] array of predicate of the form \"attribute:order\"\n * @return {array.<string[]>} array containing 2 elements : attributes, orders\n */\nmodule.exports = function formatSort(sortBy, defaults) {\n  var defaultInstructions = (defaults || []).map(function (sort) {\n    return sort.split(':');\n  });\n\n  return sortBy.reduce(\n    function preparePredicate(out, sort) {\n      var sortInstruction = sort.split(':');\n\n      var matchingDefault = find(\n        defaultInstructions,\n        function (defaultInstruction) {\n          return defaultInstruction[0] === sortInstruction[0];\n        }\n      );\n\n      if (sortInstruction.length > 1 || !matchingDefault) {\n        out[0].push(sortInstruction[0]);\n        out[1].push(sortInstruction[1]);\n        return out;\n      }\n\n      out[0].push(matchingDefault[0]);\n      out[1].push(matchingDefault[1]);\n      return out;\n    },\n    [[], []]\n  );\n};\n","'use strict';\n\nfunction inherits(ctor, superCtor) {\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true,\n    },\n  });\n}\n\nmodule.exports = inherits;\n","'use strict';\n\nfunction intersection(arr1, arr2) {\n  return arr1.filter(function (value, index) {\n    return (\n      arr2.indexOf(value) > -1 &&\n      arr1.indexOf(value) === index /* skips duplicates */\n    );\n  });\n}\n\nmodule.exports = intersection;\n","'use strict';\n\nfunction clone(value) {\n  if (typeof value === 'object' && value !== null) {\n    return _merge(Array.isArray(value) ? [] : {}, value);\n  }\n  return value;\n}\n\nfunction isObjectOrArrayOrFunction(value) {\n  return (\n    typeof value === 'function' ||\n    Array.isArray(value) ||\n    Object.prototype.toString.call(value) === '[object Object]'\n  );\n}\n\nfunction _merge(target, source) {\n  if (target === source) {\n    return target;\n  }\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (var key in source) {\n    if (\n      !Object.prototype.hasOwnProperty.call(source, key) ||\n      key === '__proto__' ||\n      key === 'constructor'\n    ) {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    var sourceVal = source[key];\n    var targetVal = target[key];\n\n    if (typeof targetVal !== 'undefined' && typeof sourceVal === 'undefined') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (\n      isObjectOrArrayOrFunction(targetVal) &&\n      isObjectOrArrayOrFunction(sourceVal)\n    ) {\n      target[key] = _merge(targetVal, sourceVal);\n    } else {\n      target[key] = clone(sourceVal);\n    }\n  }\n  return target;\n}\n\n/**\n * This method is like Object.assign, but recursively merges own and inherited\n * enumerable keyed properties of source objects into the destination object.\n *\n * NOTE: this behaves like lodash/merge, but:\n * - does mutate functions if they are a source\n * - treats non-plain objects as plain\n * - does not work for circular objects\n * - treats sparse arrays as sparse\n * - does not convert Array-like objects (Arguments, NodeLists, etc.) to arrays\n *\n * @param {Object} target The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n */\nfunction merge(target) {\n  if (!isObjectOrArrayOrFunction(target)) {\n    target = {};\n  }\n\n  for (var i = 1, l = arguments.length; i < l; i++) {\n    var source = arguments[i];\n\n    if (isObjectOrArrayOrFunction(source)) {\n      _merge(target, source);\n    }\n  }\n  return target;\n}\n\nmodule.exports = merge;\n","'use strict';\n\nfunction objectHasKeys(obj) {\n  return obj && Object.keys(obj).length > 0;\n}\n\nmodule.exports = objectHasKeys;\n","'use strict';\n\n// https://github.com/babel/babel/blob/3aaafae053fa75febb3aa45d45b6f00646e30ba4/packages/babel-helpers/src/helpers.js#L604-L620\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source === null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key;\n  var i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    // eslint-disable-next-line no-continue\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\n","'use strict';\n\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined;\n    var valIsNull = value === null;\n\n    var othIsDefined = other !== undefined;\n    var othIsNull = other === null;\n\n    if (\n      (!othIsNull && value > other) ||\n      (valIsNull && othIsDefined) ||\n      !valIsDefined\n    ) {\n      return 1;\n    }\n    if (\n      (!valIsNull && value < other) ||\n      (othIsNull && valIsDefined) ||\n      !othIsDefined\n    ) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\n/**\n * @param {Array<object>} collection object with keys in attributes\n * @param {Array<string>} iteratees attributes\n * @param {Array<string>} orders asc | desc\n * @return {Array<object>} sorted collection\n */\nfunction orderBy(collection, iteratees, orders) {\n  if (!Array.isArray(collection)) {\n    return [];\n  }\n\n  if (!Array.isArray(orders)) {\n    orders = [];\n  }\n\n  var result = collection.map(function (value, index) {\n    return {\n      criteria: iteratees.map(function (iteratee) {\n        return value[iteratee];\n      }),\n      index: index,\n      value: value,\n    };\n  });\n\n  result.sort(function comparer(object, other) {\n    var index = -1;\n\n    while (++index < object.criteria.length) {\n      var res = compareAscending(object.criteria[index], other.criteria[index]);\n      if (res) {\n        if (index >= orders.length) {\n          return res;\n        }\n        if (orders[index] === 'desc') {\n          return -res;\n        }\n        return res;\n      }\n    }\n\n    // This ensures a stable sort in V8 and other engines.\n    // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n    return object.index - other.index;\n  });\n\n  return result.map(function (res) {\n    return res.value;\n  });\n}\n\nmodule.exports = orderBy;\n","'use strict';\n\nfunction valToNumber(v) {\n  if (typeof v === 'number') {\n    return v;\n  } else if (typeof v === 'string') {\n    return parseFloat(v);\n  } else if (Array.isArray(v)) {\n    return v.map(valToNumber);\n  }\n\n  throw new Error(\n    'The value should be a number, a parsable string or an array of those.'\n  );\n}\n\nmodule.exports = valToNumber;\n","'use strict';\n\nvar merge = require('./functions/merge');\n\nfunction sortObject(obj) {\n  return Object.keys(obj)\n    .sort()\n    .reduce(function (acc, curr) {\n      acc[curr] = obj[curr];\n      return acc;\n    }, {});\n}\n\nvar requestBuilder = {\n  /**\n   * Get all the queries to send to the client, those queries can used directly\n   * with the Algolia client.\n   * @private\n   * @param  {string} index The name of the index\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @return {object[]} The queries\n   */\n  _getQueries: function getQueries(index, state) {\n    var queries = [];\n\n    // One query for the hits\n    queries.push({\n      indexName: index,\n      params: requestBuilder._getHitsSearchParams(state),\n    });\n\n    // One for each disjunctive facets\n    state.getRefinedDisjunctiveFacets().forEach(function (refinedFacet) {\n      queries.push({\n        indexName: index,\n        params: requestBuilder._getDisjunctiveFacetSearchParams(\n          state,\n          refinedFacet\n        ),\n      });\n    });\n\n    // More to get the parent levels of the hierarchical facets when refined\n    state.getRefinedHierarchicalFacets().forEach(function (refinedFacet) {\n      var hierarchicalFacet = state.getHierarchicalFacetByName(refinedFacet);\n      var currentRefinement = state.getHierarchicalRefinement(refinedFacet);\n      var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n\n      // If we are deeper than level 0 (starting from `beer > IPA`)\n      // we want to get all parent values\n      if (\n        currentRefinement.length > 0 &&\n        currentRefinement[0].split(separator).length > 1\n      ) {\n        // We generate a map of the filters we will use for our facet values queries\n        var filtersMap = currentRefinement[0]\n          .split(separator)\n          .slice(0, -1)\n          .reduce(function createFiltersMap(map, segment, level) {\n            return map.concat({\n              attribute: hierarchicalFacet.attributes[level],\n              value:\n                level === 0\n                  ? segment\n                  : [map[map.length - 1].value, segment].join(separator),\n            });\n          }, []);\n\n        filtersMap.forEach(function (filter, level) {\n          var params = requestBuilder._getDisjunctiveFacetSearchParams(\n            state,\n            filter.attribute,\n            level === 0\n          );\n\n          // Keep facet filters unrelated to current hierarchical attributes\n          function hasHierarchicalFacetFilter(value) {\n            return hierarchicalFacet.attributes.some(function (attribute) {\n              return attribute === value.split(':')[0];\n            });\n          }\n\n          var filteredFacetFilters = (params.facetFilters || []).reduce(\n            function (acc, facetFilter) {\n              if (Array.isArray(facetFilter)) {\n                var filtered = facetFilter.filter(function (filterValue) {\n                  return !hasHierarchicalFacetFilter(filterValue);\n                });\n\n                if (filtered.length > 0) {\n                  acc.push(filtered);\n                }\n              }\n\n              if (\n                typeof facetFilter === 'string' &&\n                !hasHierarchicalFacetFilter(facetFilter)\n              ) {\n                acc.push(facetFilter);\n              }\n\n              return acc;\n            },\n            []\n          );\n\n          var parent = filtersMap[level - 1];\n          if (level > 0) {\n            params.facetFilters = filteredFacetFilters.concat(\n              parent.attribute + ':' + parent.value\n            );\n          } else {\n            params.facetFilters =\n              filteredFacetFilters.length > 0\n                ? filteredFacetFilters\n                : undefined;\n          }\n\n          queries.push({ indexName: index, params: params });\n        });\n      }\n    });\n\n    return queries;\n  },\n\n  /**\n   * Build search parameters used to fetch hits\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @return {object.<string, any>} The search parameters for hits\n   */\n  _getHitsSearchParams: function (state) {\n    var facets = state.facets\n      .concat(state.disjunctiveFacets)\n      .concat(requestBuilder._getHitsHierarchicalFacetsAttributes(state))\n      .sort();\n\n    var facetFilters = requestBuilder._getFacetFilters(state);\n    var numericFilters = requestBuilder._getNumericFilters(state);\n    var tagFilters = requestBuilder._getTagFilters(state);\n    var additionalParams = {\n      facets: facets.indexOf('*') > -1 ? ['*'] : facets,\n      tagFilters: tagFilters,\n    };\n\n    if (facetFilters.length > 0) {\n      additionalParams.facetFilters = facetFilters;\n    }\n\n    if (numericFilters.length > 0) {\n      additionalParams.numericFilters = numericFilters;\n    }\n\n    return sortObject(merge({}, state.getQueryParams(), additionalParams));\n  },\n\n  /**\n   * Build search parameters used to fetch a disjunctive facet\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @param  {string} facet the associated facet name\n   * @param  {boolean} hierarchicalRootLevel ?? FIXME\n   * @return {object} The search parameters for a disjunctive facet\n   */\n  _getDisjunctiveFacetSearchParams: function (\n    state,\n    facet,\n    hierarchicalRootLevel\n  ) {\n    var facetFilters = requestBuilder._getFacetFilters(\n      state,\n      facet,\n      hierarchicalRootLevel\n    );\n    var numericFilters = requestBuilder._getNumericFilters(state, facet);\n    var tagFilters = requestBuilder._getTagFilters(state);\n    var additionalParams = {\n      hitsPerPage: 0,\n      page: 0,\n      analytics: false,\n      clickAnalytics: false,\n    };\n\n    if (tagFilters.length > 0) {\n      additionalParams.tagFilters = tagFilters;\n    }\n\n    var hierarchicalFacet = state.getHierarchicalFacetByName(facet);\n\n    if (hierarchicalFacet) {\n      additionalParams.facets =\n        requestBuilder._getDisjunctiveHierarchicalFacetAttribute(\n          state,\n          hierarchicalFacet,\n          hierarchicalRootLevel\n        );\n    } else {\n      additionalParams.facets = facet;\n    }\n\n    if (numericFilters.length > 0) {\n      additionalParams.numericFilters = numericFilters;\n    }\n\n    if (facetFilters.length > 0) {\n      additionalParams.facetFilters = facetFilters;\n    }\n\n    return sortObject(merge({}, state.getQueryParams(), additionalParams));\n  },\n\n  /**\n   * Return the numeric filters in an algolia request fashion\n   * @private\n   * @param {SearchParameters} state the state from which to get the filters\n   * @param {string} [facetName] the name of the attribute for which the filters should be excluded\n   * @return {string[]} the numeric filters in the algolia format\n   */\n  _getNumericFilters: function (state, facetName) {\n    if (state.numericFilters) {\n      return state.numericFilters;\n    }\n\n    var numericFilters = [];\n\n    Object.keys(state.numericRefinements).forEach(function (attribute) {\n      var operators = state.numericRefinements[attribute] || {};\n      Object.keys(operators).forEach(function (operator) {\n        var values = operators[operator] || [];\n        if (facetName !== attribute) {\n          values.forEach(function (value) {\n            if (Array.isArray(value)) {\n              var vs = value.map(function (v) {\n                return attribute + operator + v;\n              });\n              numericFilters.push(vs);\n            } else {\n              numericFilters.push(attribute + operator + value);\n            }\n          });\n        }\n      });\n    });\n\n    return numericFilters;\n  },\n\n  /**\n   * Return the tags filters depending on which format is used, either tagFilters or tagRefinements\n   * @private\n   * @param {SearchParameters} state the state from which to get the filters\n   * @return {string} Tag filters in a single string\n   */\n  _getTagFilters: function (state) {\n    if (state.tagFilters) {\n      return state.tagFilters;\n    }\n\n    return state.tagRefinements.join(',');\n  },\n\n  /**\n   * Build facetFilters parameter based on current refinements. The array returned\n   * contains strings representing the facet filters in the algolia format.\n   * @private\n   * @param  {SearchParameters} state The state from which to get the queries\n   * @param  {string} [facet] if set, the current disjunctive facet\n   * @param  {boolean} [hierarchicalRootLevel] ?? FIXME\n   * @return {array.<string>} The facet filters in the algolia format\n   */\n  _getFacetFilters: function (state, facet, hierarchicalRootLevel) {\n    var facetFilters = [];\n\n    var facetsRefinements = state.facetsRefinements || {};\n    Object.keys(facetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = facetsRefinements[facetName] || [];\n        facetValues.sort().forEach(function (facetValue) {\n          facetFilters.push(facetName + ':' + facetValue);\n        });\n      });\n\n    var facetsExcludes = state.facetsExcludes || {};\n    Object.keys(facetsExcludes)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = facetsExcludes[facetName] || [];\n        facetValues.sort().forEach(function (facetValue) {\n          facetFilters.push(facetName + ':-' + facetValue);\n        });\n      });\n\n    var disjunctiveFacetsRefinements = state.disjunctiveFacetsRefinements || {};\n    Object.keys(disjunctiveFacetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = disjunctiveFacetsRefinements[facetName] || [];\n        if (facetName === facet || !facetValues || facetValues.length === 0) {\n          return;\n        }\n        var orFilters = [];\n\n        facetValues.sort().forEach(function (facetValue) {\n          orFilters.push(facetName + ':' + facetValue);\n        });\n\n        facetFilters.push(orFilters);\n      });\n\n    var hierarchicalFacetsRefinements =\n      state.hierarchicalFacetsRefinements || {};\n    Object.keys(hierarchicalFacetsRefinements)\n      .sort()\n      .forEach(function (facetName) {\n        var facetValues = hierarchicalFacetsRefinements[facetName] || [];\n        var facetValue = facetValues[0];\n\n        if (facetValue === undefined) {\n          return;\n        }\n\n        var hierarchicalFacet = state.getHierarchicalFacetByName(facetName);\n        var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n        var rootPath = state._getHierarchicalRootPath(hierarchicalFacet);\n        var attributeToRefine;\n        var attributesIndex;\n\n        // we ask for parent facet values only when the `facet` is the current hierarchical facet\n        if (facet === facetName) {\n          // if we are at the root level already, no need to ask for facet values, we get them from\n          // the hits query\n          if (\n            facetValue.indexOf(separator) === -1 ||\n            (!rootPath && hierarchicalRootLevel === true) ||\n            (rootPath &&\n              rootPath.split(separator).length ===\n                facetValue.split(separator).length)\n          ) {\n            return;\n          }\n\n          if (!rootPath) {\n            attributesIndex = facetValue.split(separator).length - 2;\n            facetValue = facetValue.slice(0, facetValue.lastIndexOf(separator));\n          } else {\n            attributesIndex = rootPath.split(separator).length - 1;\n            facetValue = rootPath;\n          }\n\n          attributeToRefine = hierarchicalFacet.attributes[attributesIndex];\n        } else {\n          attributesIndex = facetValue.split(separator).length - 1;\n\n          attributeToRefine = hierarchicalFacet.attributes[attributesIndex];\n        }\n\n        if (attributeToRefine) {\n          facetFilters.push([attributeToRefine + ':' + facetValue]);\n        }\n      });\n\n    return facetFilters;\n  },\n\n  _getHitsHierarchicalFacetsAttributes: function (state) {\n    var out = [];\n\n    return state.hierarchicalFacets.reduce(\n      // ask for as much levels as there's hierarchical refinements\n      function getHitsAttributesForHierarchicalFacet(\n        allAttributes,\n        hierarchicalFacet\n      ) {\n        var hierarchicalRefinement = state.getHierarchicalRefinement(\n          hierarchicalFacet.name\n        )[0];\n\n        // if no refinement, ask for root level\n        if (!hierarchicalRefinement) {\n          allAttributes.push(hierarchicalFacet.attributes[0]);\n          return allAttributes;\n        }\n\n        var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n        var level = hierarchicalRefinement.split(separator).length;\n        var newAttributes = hierarchicalFacet.attributes.slice(0, level + 1);\n\n        return allAttributes.concat(newAttributes);\n      },\n      out\n    );\n  },\n\n  _getDisjunctiveHierarchicalFacetAttribute: function (\n    state,\n    hierarchicalFacet,\n    rootLevel\n  ) {\n    var separator = state._getHierarchicalFacetSeparator(hierarchicalFacet);\n    if (rootLevel === true) {\n      var rootPath = state._getHierarchicalRootPath(hierarchicalFacet);\n      var attributeIndex = 0;\n\n      if (rootPath) {\n        attributeIndex = rootPath.split(separator).length;\n      }\n      return [hierarchicalFacet.attributes[attributeIndex]];\n    }\n\n    var hierarchicalRefinement =\n      state.getHierarchicalRefinement(hierarchicalFacet.name)[0] || '';\n    // if refinement is 'beers > IPA > Flying dog',\n    // then we want `facets: ['beers > IPA']` as disjunctive facet (parent level values)\n\n    var parentLevel = hierarchicalRefinement.split(separator).length - 1;\n    return hierarchicalFacet.attributes.slice(0, parentLevel + 1);\n  },\n\n  getSearchForFacetQuery: function (facetName, query, maxFacetHits, state) {\n    var stateForSearchForFacetValues = state.isDisjunctiveFacet(facetName)\n      ? state.clearRefinements(facetName)\n      : state;\n    var searchForFacetSearchParameters = {\n      facetQuery: query,\n      facetName: facetName,\n    };\n    if (typeof maxFacetHits === 'number') {\n      searchForFacetSearchParameters.maxFacetHits = maxFacetHits;\n    }\n    return sortObject(\n      merge(\n        {},\n        requestBuilder._getHitsSearchParams(stateForSearchForFacetValues),\n        searchForFacetSearchParameters\n      )\n    );\n  },\n};\n\nmodule.exports = requestBuilder;\n","'use strict';\n\nmodule.exports = function isValidUserToken(userToken) {\n  if (userToken === null) {\n    return false;\n  }\n  return /^[a-zA-Z0-9_-]{1,64}$/.test(userToken);\n};\n","'use strict';\n\nmodule.exports = '3.14.1';\n","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n"],"names":["EventEmitter","this","_events","_maxListeners","undefined","isFunction","arg","isObject","isUndefined","module","exports","prototype","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","emit","type","er","handler","len","args","i","listeners","error","length","arguments","Error","err","context","call","Array","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","on","once","fired","g","removeListener","list","position","splice","removeAllListeners","key","listenerCount","evlistener","emitter","e","t","r","Object","defineProperty","value","enumerable","configurable","writable","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","o","forEach","getOwnPropertyDescriptors","defineProperties","a","indexOf","propertyIsEnumerable","isArray","Symbol","iterator","toString","u","next","done","return","from","concat","localStorage","window","JSON","parse","getItem","setItem","stringify","timeToLive","fromEntries","entries","timestamp","Date","getTime","get","miss","Promise","resolve","then","all","set","delete","clear","removeItem","caches","shift","catch","s","serializable","c","Math","floor","random","l","f","replace","encodeURIComponent","WithinQueryParameters","WithinHeaders","h","data","timeout","headers","queryParameters","cacheable","d","Read","Write","Any","p","v","y","status","lastUpdate","now","b","protocol","url","accept","O","P","q","map","getTimeout","statelessHosts","j","method","toLowerCase","userAgent","pop","name","message","transporterStackTrace","A","S","path","connectTimeout","timeouts","connect","responseTimeout","request","response","host","triesLeft","onSuccess","content","onRetry","isTimedOut","logger","info","N","hostsCache","onFail","requester","send","reverse","w","add","segment","version","T","charAt","substr","join","x","appId","authMode","apiKey","requestsCache","responsesCache","hosts","read","mappedRequestOptions","transporter","reject","write","addAlgoliaAgent","clearCache","methods","C","E","indexName","J","params","requests","k","facetName","facetQuery","searchForFacetValues","R","I","query","queryLanguages","F","D","W","H","Q","XMLHttpRequest","open","setRequestHeader","setTimeout","abort","onreadystatechange","readyState","OPENED","clearTimeout","onerror","responseText","onload","debug","search","multipleQueries","multipleSearchForFacetValues","customRequest","initIndex","findAnswers","IndexContext","createContext","InstantSearchContext","_typeof","obj","constructor","ANONYMOUS_TOKEN_COOKIE_KEY","getInsightsAnonymousUserTokenInternal","document","cookie","prefix","cookies","split","substring","getCookie","safelyRunOnBrowser","callback","fallback","noop","ownKeys","object","enumerableOnly","symbols","sym","_objectSpread","target","source","_defineProperty","input","hint","prim","toPrimitive","res","String","Number","_toPrimitive","_toPropertyKey","_slicedToArray","arr","_arrayWithHoles","_i","_s","_e","_x","_r","_arr","_n","_d","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","_nonIterableSpread","minLen","test","arr2","ALGOLIA_INSIGHTS_VERSION","ALGOLIA_INSIGHTS_SRC","isModernInsightsClient","client","_split$map2","major","minor","createInitArgs","instantSearchInstance","parent","uiState","helper","getHelper","state","renderState","templatesConfig","createURL","scopedResults","searchMetadata","isSearchStalled","createRenderArgs","results","getResults","getScopedResults","_state","extractWidgetPayload","widgets","payload","initOptions","mainIndex","_initialUiState","widget","widgetParams","getWidgetRenderState","$$type","widgetType","$$widgetType","getWidgets","createMetadataMiddleware","_ref2$$$internal","$$internal","_ref3","payloadContainer","createElement","refNode","querySelector","onStateChange","subscribe","ua","_ua","middleware","instance","internal","appendChild","started","unsubscribe","remove","_defineProperties","props","descriptor","setWindowTitle","title","BrowserHistory","_ref","_this","windowTitle","_ref$writeDelay","writeDelay","parseURL","getLocation","start","dispose","Constructor","_classCallCheck","writeTimer","_createURL","_start","_dispose","_push","_ref2","latestAcknowledgedHistory","history","protoProps","staticProps","qsModule","location","routeState","_this2","shouldWrite","pushState","inPopState","_this3","_onPopState","_ref4","addEventListener","_this4","isDisposed","_ref5","removeEventListener","_this5","_ref6","lastPushWasByISAfterDispose","href","_excluded","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","getIndexStateWithoutConfigure","configure","isPrimitive","isEqual","first","second","_Object$keys","createRouterMiddleware","_props$router","router","_ref7","_ref7$createURL","_ref8","hostname","_location$port","port","pathname","hash","queryString","portWithPrefix","_ref7$parseURL","_ref9","arrayLimit","_ref7$writeDelay","_ref7$getLocation","_ref10","historyRouter","_props$stateMapping","stateMapping","stateToRoute","reduce","indexId","routeToState","_props$$$internal","nextState","previousUiState","getWidgetUiState","acc","route","lastRouteState","initialUiState","onUpdate","setUiState","_router$start","createDocumentationMessageGenerator","_len","_key","links","_ref$connector","connector","createDocumentationLink","Boolean","isIndexWidget","mergeHierarchicalFacets","left","right","setQueryParameters","hierarchicalFacets","facets","facet","index","array","comparator","findIndex","_","nextFacets","mergeSearchParameters","parameters","hierarchicalFacetsRefinementsMerged","hierarchicalFacetsRefinements","mergeHierarchicalFacetsRefinements","tagRefinementsMerged","tagRefinements","addTagRefinement","mergeTagRefinements","numericRefinementsMerged","numericRefinements","mergeNumericRefinements","disjunctiveFacetsRefinementsMerged","disjunctiveFacetsRefinements","mergeDisjunctiveFacetsRefinements","facetsExcludesMerged","facetsExcludes","mergeFacetsExcludes","facetRefinementsMerged","facetsRefinements","mergeFacetRefinements","disjunctiveFacetsMerged","disjunctiveFacets","addDisjunctiveFacet","mergeDisjunctiveFacets","ruleContextsMerged","ruleContexts","self","mergeRuleContexts","facetsMerged","addFacet","mergeFacets","rest","mergeWithRest","withUsage","privateHelperSetState","isPageReset","_uiState","lastResults","getLocalWidgetsUiState","widgetStateOptions","getWidgetState","getLocalWidgetsSearchParameters","widgetSearchParametersOptions","initialSearchParameters","getWidgetSearchParameters","resetPageFromWidgets","indexWidgets","widgetHelper","resetPage","resolveScopedResultsFromWidgets","current","getIndexId","_widgetParams$indexId","localWidgets","localUiState","localInstantSearchInstance","localParent","derivedHelper","lastValidSearchParameters","getIndexName","_derivedHelper","getPreviousState","widgetParent","getParent","searchParameters","addWidgets","some","init","render","getRenderState","storeRenderState","scheduleSearch","removeWidgets","_nextState","setState","_instantSearchInstanc","mainHelper","searchWithoutTriggeringOnStateChange","facetValue","maxFacetHits","userState","derive","states","resolveSearchParameters","indexInitialResults","_initialResults","scheduleStalledRender","scheduleRender","event","onInternalStateChange","hasPendingRequests","widgetsToRender","_helper","_derivedHelper2","detach","innerIndex","refreshUiState","setIndexUiState","indexUiState","nextIndexUiState","parentIndexName","component","componentName","descendantName","modifierName","descendent","modifier","getPropertyByPath","TAG_REPLACEMENT","highlightPreTag","highlightPostTag","suit","concatHighlightedParts","parts","part","isHighlighted","regexUnescapedHtml","RegExp","htmlCharacters","regexEscapedHtml","regexHasEscapedHtml","hasAlphanumeric","getHighlightFromSiblings","_parts","_parts2","isNextHighlighted","isPreviousHighlighted","character","reverseHighlightedParts","getHighlightedParts","highlightedValue","splitByPreTag","firstValue","elements","splitByPostTag","writeDataAttributes","serializedPayload","btoa","serializePayload","hoganHelpers","numberLocale","formatNumber","toLocaleString","highlight","options","attribute","_ref$highlightedTagNa","highlightedTagName","hit","_ref$cssClasses","cssClasses","_ref2$value","_highlightResult","attributeValue","className","highlighted","reverseHighlight","snippet","_snippetResult","reverseSnippet","insights","_JSON$parse","objectIDs","objectID","nextMicroTask","defer","progress","cancelled","fn","wait","cancel","setIndexHelperState","finalUiState","indexWidget","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","valueOf","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","_assertThisInitialized","_possibleConstructorReturn","ReferenceError","getPrototypeOf","defaultCreateURL","InstantSearch","_EventEmitter","subClass","superClass","create","_inherits","_super","_this$mainHelper","shouldResetStatus","_searchStalledTimer","nextUiState","_options$indexName","_options$initialUiSta","_options$routing","routing","_options$insights","searchFunction","_options$stalledSearc","stalledSearchDelay","_options$searchClient","searchClient","_options$insightsClie","insightsClient","_options$onStateChang","helpers","compileOptions","_stalledSearchDelay","_searchFunction","sendEventToInsights","routerOptions","use","insightsOptions","_insightsClient","insightsInitParams","onEvent","potentialInsightsClient","pointer","AlgoliaAnalyticsObject","queue","shouldAddScript","existingInsightsMiddlewares","creator","unuse","initialParameters","_getAppIdAndApiKey","_searchClient$transpo","APP_ID","API_KEY","applicationID","getAppIdAndApiKey","_getAppIdAndApiKey2","queuedUserToken","userTokenBeforeInit","items","predicate","find","_error","userToken","partial","errorMessage","script","async","src","body","cause","clickAnalytics","overrideStateWithoutTriggeringChangeEvent","setUserTokenToSearch","immediate","existingToken","applyToken","anonymousUserToken","insightsClientWithLocalCredentials","insightsMethod","algoliaSource","eventModifier","createInsightsMiddleware","_window$navigator","_window$navigator$use","navigator","newMiddlewareList","newMiddleware","_len2","middlewareToUnuse","_key2","includes","searchOnlyWithDerivedHelpers","fakeClient","_mainHelperSearch","mainIndexHelper","searchFunctionHelper","originalScheduleSearch","_this$mainHelper2","callOnStateChange","InstantSearchServerContext","useInstantSearchServerContext","useContext","InstantSearchSSRContext","defaultUserAgents","serverUserAgent","nextUserAgent","nextVersion","useInstantSearchApi","_next","_process$env","forceUpdate","useReducer","serverContext","serverState","initialResults","prevPropsRef","useRef","searchRef","ssrSearchRef","_schedule","cb","timer","addAlgoliaAgents","process","NEXT_RUNTIME","notifyServer","_props$stalledSearchD","_search","prevProps","setIndex","setClient","cleanupTimerRef","store","useSyncExternalStore","useCallback","_preventWidgetCleanup","userAgents","children","Provider","checkRendering","rendering","usage","defaultQueryHook","hook","renderFn","unmountFn","_refine","_clear","_ref$queryHook","queryHook","renderOptions","setQueryParameter","searchBox","setQuery","refine","has","hasOwnProperty","dequal","foo","bar","compare","ctor","createSearchResults","_state$query","_state$page","_state$hitsPerPage","page","hitsPerPage","hits","nbHits","nbPages","exhaustiveNbHits","exhaustiveFacetsCount","processingTimeMS","__isArtificial","getIndexSearchResults","scopedResult","fallbackResults","invariant","condition","useIndexContext","useInstantSearchContext","useStableValue","_useState2","useState","stableValue","setStableValue","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","_excluded2","useConnector","additionalWidgetProperties","parentIndex","stableProps","stableAdditionalWidgetProperties","shouldSetStateRef","previousRenderStateRef","previousStatusRef","useMemo","connectorState","isFirstRender","Function","createWidget","_widget$getWidgetSear","_getIndexSearchResult","_widget$getWidgetRend","shouldSsr","prevWidgetRef","shouldAddWidgetEarly","previousWidget","useWidget","useSearchBox","useInstantSearch","catchError","_useSearchState","searchIndex","getUiState","setLocalUiState","handleRender","useSearchState","_useSearchResults","searchResults","setSearchResults","useSearchResults","addMiddlewares","middlewares","refresh","onError","inputValue","setInputValue","inputRef","newQuery","___EmotionJSX","action","role","noValidate","onSubmit","preventDefault","stopPropagation","blur","onReset","ref","autoComplete","autoCorrect","autoCapitalize","placeholder","spellCheck","maxLength","onChange","currentTarget","hidden","FontAwesomeIcon","icon","faCircleXmark","Link","to","faMagnifyingGlass","textField","hCenter","focus","autoFocus","searchState","searchSetState","useSearchContext","topic_keywords","setTopicKeywords","checkboxArray","topicKeywordArray","handleCheckbox","label","tk","checkbox","checkBoxSet","id","onCheckedChange","checked","Checkbox","xmlns","width","height","viewBox","transform","htmlFor","h3","checkBox","checkMark","algoliasearch","setAlgoliaHits","useAlgoliaStrapiContext","setWithAlgoliaQuery","searchOption","hitCd","business_cd","code","organization_cd","insert_id","biz_cd_executive","biz_cd_fund_distr","SearchBoxIndex","SearchBoxSidebar","SearchBoxTopicKeyword","AlgoliaSearchHelper","SearchParameters","SearchResults","algoliasearchHelper","opts","DerivedHelper","main","inherits","detachDerivedHelper","getModifiedState","defaultsPure","objectHasKeys","omit","lib","addRefinement","refinementList","isRefined","valueAsString","facetRefinement","mod","removeRefinement","clearRefinement","toggleRefinement","refinementType","hasChanged","newRefinementList","memo","values","facetList","refinementValue","containsRefinements","refinementValueAsString","intersection","merge","valToNumber","isValidUserToken","RefinementList","isEqualNumericRefinement","every","el","newParameters","_parseNumbers","warn","paramName","isKeyKnown","PARAMETERS","isValueDefined","partialState","numbers","parsedValue","parseFloat","insideBoundingBox","geoRect","operators","operator","parsedValues","vPrime","make","rootPath","currentRefinement","getHierarchicalRefinement","clearRefinements","toggleHierarchicalFacetRefinement","validate","currentState","tagFilters","numericFilters","patch","_clearNumericRefinements","clearTags","setPage","newPage","setFacets","setDisjunctiveFacets","setHitsPerPage","setTypoTolerance","typoTolerance","addNumericRefinement","val","isNumericRefined","getConjunctiveRefinements","isConjunctiveFacet","getDisjunctiveRefinements","isDisjunctiveFacet","getExcludeRefinements","removeNumericRefinement","number","paramValue","op","getNumericRefinements","getNumericRefinement","newNumericRefinements","operatorList","outValues","addHierarchicalFacet","hierarchicalFacet","isHierarchicalFacet","addFacetRefinement","addExcludeRefinement","addDisjunctiveFacetRefinement","tag","isTagRefined","modification","removeFacet","removeDisjunctiveFacet","removeHierarchicalFacet","removeFacetRefinement","removeExcludeRefinement","removeDisjunctiveFacetRefinement","removeTagRefinement","toggleFacetRefinement","toggleConjunctiveFacetRefinement","toggleDisjunctiveFacetRefinement","toggleExcludeFacetRefinement","separator","_getHierarchicalFacetSeparator","getHierarchicalFacetByName","lastIndexOf","addHierarchicalFacetRefinement","isHierarchicalFacetRefined","removeHierarchicalFacetRefinement","toggleTagRefinement","isFacetRefined","isExcludeRefined","isDisjunctiveFacetRefined","refinements","isOperatorDefined","searchedValue","isAttributeValueDefined","currentValue","getRefinedDisjunctiveFacets","disjunctiveNumericRefinedFacets","getRefinedHierarchicalFacets","sort","getUnrefinedDisjunctiveFacets","refinedFacets","managedParameters","getQueryParams","queryParams","parameter","nextWithNumbers","previousPlainObject","nextPlainObject","previous","isPreviousValueDefined","isNextValueDefined","_getHierarchicalFacetSortBy","sortBy","_getHierarchicalRootPath","_getHierarchicalShowParentLevel","showParentLevel","hierarchicalFacetName","getHierarchicalFacetBreadcrumb","refinement","trim","hierarchicalFacetResult","hierarchicalFacetIndex","hierarchicalFacetRefinement","hierarchicalSeparator","hierarchicalRootPath","hierarchicalShowParentLevel","prepareHierarchicalFacetSortBy","rootExhaustive","facetResult","exhaustive","generateTreeFn","hierarchicalTree","currentHierarchicalLevel","level","subtree","picked","tuple","parentPath","onlyMatchingTree","orderBy","facetCount","escapedValue","escapeFacetValue","count","format","unescapeFacetValue","generateHierarchicalTree","fv","compact","formatSort","getIndices","attributes","indices","idx","assignFacetStats","dest","facetStats","stats","mainSubResponse","_rawResults","sum","facetsIndices","disjunctiveFacetsIndices","nextDisjunctiveResult","mainFacets","facetKey","hierarchicalAttributeName","facetValueObject","facetIndex","idxAttributeName","isFacetDisjunctive","isFacetConjunctive","facets_stats","disjunctiveFacet","dfacet","facetResults","attributeIndex","dataFromMainRequest","refinedFacet","defaultData","root","excludes","extractNormalizedFacetValues","isExcluded","hierarchicalFacetValues","currentRefinementSplit","unshift","setIsRefined","item","depth","child","recSort","sortFn","node","names","childNode","sortedChildren","getFacetStatsIfAvailable","getRefinement","attributeName","resultsFacets","getFacetByName","DEFAULT_SORT","getFacetValues","facetValues","facetOrdering","renderingContent","getFacetOrdering","orderedFacets","remainingFacets","reverseOrder","order","ordering","sortRemainingBy","sortViaFacetOrdering","vanillaSortFn","getFacetStats","getRefinements","facetDeclaration","rootFacet","intermediateFacet","newFacet","numericValue","requestBuilder","_queryId","_lastQueryIdReceived","derivedHelpers","_currentNbQueries","setCurrentPage","_change","getCurrentPage","onlyWithDerivedHelpers","getQuery","_getHitsSearchParams","searchOnce","tempState","queries","_getQueries","_originalResponse","derivedState","attributesForPrediction","clientHasSFFV","clientHasInitIndex","isDisjunctive","algoliaQuery","getSearchForFacetQuery","searchForFacetValuesPromise","facetHits","addDisjunctiveRefine","addRefine","addFacetExclusion","addExclude","addTag","removeDisjunctiveRefine","removeRefine","removeFacetExclusion","removeExclude","removeTag","toggleFacetExclusion","toggleExclude","toggleRefine","toggleTag","nextPage","previousPage","newState","hasRefinements","isDisjunctiveRefined","hasTag","hasTagRefinements","getIndex","getPage","getTags","mainQueries","queriesCount","derivedQueries","derivedStateQueries","queryId","_dispatchAlgoliaResponse","_dispatchAlgoliaError","specificResults","containsRefinement","facetFilters","_hasDisjunctiveRefinements","disjunctiveRefinements","newClient","getClient","pos","reduceRight","defaults","defaultInstructions","out","sortInstruction","matchingDefault","defaultInstruction","superCtor","arr1","isObjectOrArrayOrFunction","_merge","sourceVal","targetVal","compareAscending","other","valIsDefined","valIsNull","othIsDefined","othIsNull","collection","iteratees","orders","criteria","iteratee","sortObject","curr","_getDisjunctiveFacetSearchParams","filtersMap","hasHierarchicalFacetFilter","filteredFacetFilters","facetFilter","filtered","filterValue","_getHitsHierarchicalFacetsAttributes","_getFacetFilters","_getNumericFilters","_getTagFilters","additionalParams","hierarchicalRootLevel","analytics","_getDisjunctiveHierarchicalFacetAttribute","vs","orFilters","attributeToRefine","attributesIndex","allAttributes","hierarchicalRefinement","newAttributes","rootLevel","parentLevel","stateForSearchForFacetValues","searchForFacetSearchParameters","percentTwenties","Format","formatters","RFC1738","RFC3986","formats","utils","allowDots","allowPrototypes","charset","charsetSentinel","comma","decoder","decode","delimiter","ignoreQueryPrefix","interpretNumericEntities","parameterLimit","parseArrays","plainObjects","strictNullHandling","str","$0","numberStr","fromCharCode","parseInt","parseArrayValue","parseKeys","givenKey","valuesParsed","exec","chain","leaf","cleanRoot","parseObject","isRegExp","normalizeParseOptions","tempObj","cleanStr","limit","Infinity","skipIndex","bracketEqualsPos","maybeMap","encodedVal","combine","parseValues","newObj","arrayPrefixGenerators","brackets","repeat","pushToArray","valueOrArray","toISO","toISOString","defaultFormat","addQueryPrefix","encode","encoder","encodeValuesOnly","formatter","serializeDate","date","skipNulls","generateArrayPrefix","isBuffer","keyValue","valuesArray","valuesJoined","objKeys","keyPrefix","normalizeStringifyOptions","arrayFormat","joined","hexTable","toUpperCase","arrayToObject","assign","prop","refs","compacted","compactQueue","strWithoutPlus","unescape","decodeURIComponent","defaultEncoder","kind","string","escape","charCodeAt","mapped","mergeTarget","targetItem","is","useDebugValue","getSnapshot","inst"],"sourceRoot":""}